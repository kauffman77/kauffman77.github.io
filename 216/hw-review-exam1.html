<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-05-15 Thu 13:24 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CMSC216 Exam 1 Review Exercise</title>
<meta name="author" content="Chris Kauffman" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<meta name="viewport" content="width=device-width, maximum-scale=1, minimum-scale=1" />
<style type="text/css">
@media screen {
:root {
--heading-bg-color:#e21833;
--heading-fg-color:#ffd200;
}
html {
font-family: serif;
text-align: justify;
}
pre.src, pre.example {
overflow-x: scroll;
}
/* Merge subtitle area with title area */
.subtitle {
text-align: center;
margin-top: -2em;
padding-top: 1em;
padding-bottom: 0.1em;
}
.title, .subtitle {
color: var(--heading-fg-color);
background-color: var(--heading-bg-color);
}
/* Section borders, left section header style */
div.outline-2, #table-of-contents {
background-color: rgb(250,250,250);
border: 0.75em solid var(--heading-bg-color);
border-top: 0em;
padding: 0em .5em .5em .5em; /* top right bottom left */
margin: 1em 0em 1em 0em; /* top right bottom left */
}
div.outline-2 > h2, #table-of-contents > h2 {
background-color: var(--heading-bg-color);
color: var(--heading-fg-color);
font-variant: small-caps;
padding: 0em 0em 0em .5em; /* top right bottom left */
margin: 0em -.5em 0em -.75em; /* top right bottom left */
text-align: left;
}
blockquote {
font-style: italic;
}
td, th {
padding-top: 2px;
padding-bottom: 2px;
}
body {
background-color: #EEE;
}
pre {
}
#content, #preamble, #postamble {
margin-left:300px;
max-width: 100%;
}
.tag {
background-color: inherit; font-family: inherit;
padding: inherit; font-size: 80%; font-weight: inherit;
text-transform: uppercase;
}

.figure p { text-align: inherit; }
figure-number { font-style: italic; }
#table-of-contents {
text-align: left;
position: fixed;
left: 0;
margin: 0 auto;
padding: 0;
width: 300px;
top: 0;
height: 100%;
border: 0;
display: block;
}
#text-table-of-contents {
overflow-y: scroll;
height: 100%;
}
#text-table-of-contents ul {
padding-left: 1em;
margin-left: 0.5em;
}
#table-of-contents > h2 {
padding: 0.1em;
margin: 0;
}
/* adjustments for small screen, toc at top only */
@media (max-width: 800px) { /* landscape for iphone */
html {
-webkit-text-size-adjust: none;  /* prevent scaling of text on mobile */
}
body {
background-color: #EEE;
width:100%;
margin:0 auto;
}
#content, #preamble, #postamble {
margin-left:0;
}
#table-of-contents {
position: static;
left: inherit;
width:inherit;
height: auto;
border-top: 0em;
padding: 0em .5em .5em .5em; /* top right bottom left */
margin: 1em 0em 1em 0em; /* top right bottom left */
border: 0.75em solid #006633;
}
div.outline-2, #table-of-contents {
background-color: rgb(250,250,250);
border: 0.75em solid var(--heading-bg-color);
border-top: 0em;
padding: 0em .5em .5em .5em; /* top right bottom left */
margin: 1em 0em 1em 0em; /* top right bottom left */
}
div.outline-2 > h2, #table-of-contents > h2 {
background-color: var(--heading-bg-color);
color: var(--heading-fg-color);
font-variant: small-caps;
padding: 0em 0em 0em .5em; /* top right bottom left */
margin: 0em -.5em 0em -.75em; /* top right bottom left */
text-align: left;
}
#text-table-of-contents {
overflow-y: visible;
height: inherit;
}
#text-table-of-contents ul {
padding-left: 1em;
margin-left: 0.5em;
}
}
.linenr { font-size: xx-small; }
th.org-left   { text-align: left;   }
details > summary {
padding: 2px 6px;
font-family: Sans;
font-size: 0.8em;
width: fit-content;
border-radius: 5px;
background-color: #efefef;
border: 1px solid black;
cursor: pointer;
}
}

@media print {
html {
font-family: serif;
font-size: 10pt;
text-align: justify;
.linenr { font-size: xx-small; }
}
}
</style>
<style>
/* Theme: Srcery
Description: Srcery dark color scheme for highlight.js
Author: Chen Bin <chen.bin@gmail.com>
Maintainer: @redguardtoo
Website: https://srcery-colors.github.io/
Date: 2021-04-13
https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/srcery.css

Tailored by: Chris Kauffman <profk@umd.edu>
Date: Sat Nov 25 06:16:20 PM EST 2023
*/
pre code.hljs {
display: block;
overflow-x: auto;
padding: 1em
}
code.hljs {
padding: 3px 5px
}
.hljs {
background: #1C1B19;
/* Black */
color: #FFFFFF/* Bright White */

}
/* Bright White */
.hljs-subst,
.hljs-quote,
.hljs-literal {
color: #FCE8C3
}
/* Bright Blue */
.hljs-type,
.hljs-symbol {
color: #68A8E4
}
/* Red */
.hljs-keyword,
.hljs-deletion {
color: #EF2F27
}
/* Yellow */
.hljs-name,
.hljs-function,
.hljs-attribute,
.hljs-selector-attr,
.hljs-selector-id,
.hljs-selector-class,
.hljs-selector-pseudo,
.hljs-section,
.hljs-title {
color: #FBB829
}
/* Cyan */
.hljs-code,
.hljs-variable,
.hljs-property,
.hljs-template-variable,
.hljs-class {
color: #0AAEB3
}
/* Bright Green */
.hljs-string,
.hljs-regexp,
.hljs-bullet,
.hljs-addition {
color: #98BC37
}
/* Bright Magenta */
.hljs-built_in,
.hljs-params {
color: #FF5C8F
}
/* Blue */
.hljs-template-tag,
.hljs-selector-tag {
color: #2C78BF
}
/* Bright Black */
.hljs-link,
.hljs-number,
.hljs-comment,
.hljs-meta {
color: #B1B195
/* color: #918175 */
}
.hljs-emphasis {
font-style: italic
}
.hljs-strong {
font-weight: bold
}
/* @see https://github.com/srcery-colors/srcery-emacs for reference */
</style>

<link rel="stylesheet" href="./srcery-ck.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
function interactive_lang() {      // define a custom "interactive" language
return {
name: 'interactive',           // language name
keywords: {
$pattern: /[^ \t\n]+/,       // lex based on non-whitespace
keyword: [">>","(shellac)","[COMMANDO]>>","HM>","TM>","HS>","homeputer>","grace3:","grace4:","grace5:","grace6:","grace7:","grace8:","grace9:","grace10:","grace3>>","grace4>>","grace5>>","grace6>>","grace7>>","grace8>>","grace9>>","grace10>>"], // allowed interactive prompts
literal: ["[data/script.txt]>>","[data/script1.txt]>>","[data/script6.txt]>>"],
},
contains: [
// hljs.HASH_COMMENT_MODE,   // use standard hash comments, any # is a comment
// hljs.COMMENT(/#+ /, /$/),    // use custom comment of # w/ whitespace
hljs.COMMENT(/## /, /$/),     // hash-hash-ws for comment
hljs.COMMENT(/##+/, /$/),     // or a sequence of hashes
]
};
};
hljs.registerLanguage('interactive', interactive_lang);     // register custom language

// Add highlighjs CSS classes to elemens marked with relevant org classes
lang_map = new Map();              // map of org to hljs languages
lang_map.set("src-c"     , "language-c");
lang_map.set("src-python", "language-python");
lang_map.set("src-text"  , "language-plaintext");
lang_map.set("src-sh"    , "language-interactive");
function add_class(el) {           // applied to each pre.src element
for (let [org_lang, hljs_lang] of lang_map) {
if(el.classList.contains(org_lang)){
el.classList.add(hljs_lang);
}
}
}
// visit all pre.src elements and apply function to add language class
document.querySelectorAll('pre.src').forEach(add_class);
hljs.configure({cssSelector: 'pre'}); // select pre blocks only to highligh
hljs.highlightAll();                  // perform highlighting on all pre blocks
});
</script>
</head>
<body>
<div id="preamble" class="status">
<i>Last Updated: 2025-05-15 Thu 13:24</i>
</div>
<div id="content" class="content">
<h1 class="title">CMSC216 Exam 1 Review Exercise</h1>
<div id="outline-container-org498aac9" class="outline-4">
<h4 id="org498aac9">CODE DISTRIBUTION: <a href="hw-review-exam1-code.zip">hw-review-exam1-code.zip</a></h4>
<div class="outline-text-4" id="text-org498aac9">
<ul class="org-ul">
<li>Download the code distribution every HW</li>
<li>See further setup instructions below</li>
</ul>
</div>
</div>
<div id="outline-container-orgfc65530" class="outline-4">
<h4 id="orgfc65530">CHANGELOG: None</h4>
<div class="outline-text-4" id="text-orgfc65530">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgbd71594">1. Review Problem</a></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-orgbd71594" class="outline-2">
<h2 id="orgbd71594"><span class="section-number-2">1</span> Review Problem</h2>
<div class="outline-text-2" id="text-1">
<p>
Below is a simple application which uses functions to convert an array
into a linked list, print its elements, and clean it up. This
application appears to function correctly but when run under Valgrind
to check for memory problems, it is identified as having issues that
should be resolved.  Study the code and output and answer the following.
</p>

<ol class="org-ol">
<li>What kind of error is Valgrind reporting? What lines of code does
it identify as part of the problem?</li>
<li>What lines of code require alteration to resolve the memory
problem? Are these the same as those that Valgrind reports?</li>
<li>What does a completely correct version of the code look like?</li>
</ol>

<div class="org-src-container">
<pre class="src src-c">// list_practice.c: converts an array to a linked list and prints it,
// has memory problems

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

// struct for single data node in linked list
typedef struct node_struct {
  char data[128];               // string at this node
  struct node_struct *next;     // pointer to next node
} node_t;                       // type name for struct in programs: node_t nod;

// struct encapsulating entire linked list
typedef struct {
  node_t *head;                 // NULL or pointer to first node in list
  int size;                     // number of nodes in the list
} list_t;                       // type name for struct in programs: list_t lst;


list_t *list_from_array(char *arr[], int count){
  // Creates a linked list of nodes with data copied from `arr[]`.
  // Nodes are ordered as they appear in `arr[]`
  if(count &lt; 0){
    return NULL;
  }
  list_t *list = malloc(sizeof(list_t));
  list-&gt;head = NULL;
  list-&gt;size = 0;
  if(count==0){
    return list;
  }
  list-&gt;head = malloc(sizeof(node_t));
  strcpy(list-&gt;head-&gt;data, arr[0]);
  list-&gt;head-&gt;next = NULL;
  list-&gt;size++;
  node_t *tail = list-&gt;head;
  for(int i=1; i&lt;count; i++){
    tail-&gt;next = malloc(sizeof(node_t));
    tail = tail-&gt;next;
    strcpy(tail-&gt;data, arr[i]);
    tail-&gt;next = NULL;
    list-&gt;size++;
  }
  return list;
}

void list_print(list_t *list){
  // prints all elements of `list` on their own line
  printf("LIST:\n");
  node_t *ptr = list-&gt;head;
  for(int i=0; i&lt;list-&gt;size; i++){
    printf("%s\n",ptr-&gt;data);
    ptr = ptr-&gt;next;
  }
}
  
void list_free(list_t* list){
  // de-allocates memory associated with `list`
  free(list);
}

int main(){
  char *fruits[5] = {
    "Banana",
    "Grape",
    "Kiwi",
    "Orange",
    "Pear",
  };
  list_t *flist = list_from_array(fruits, 5);
  list_print(flist);
  list_free(flist);

  char *veggies[3] = {
    "Carrot",
    "Onion",
    "Potato",
  };
  list_t *vlist = list_from_array(veggies, 3);
  list_print(vlist);
  list_free(vlist);

  return 0;
}  
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; gcc -g list_practice.student.c

&gt;&gt; ./a.out
LIST:
Banana
Grape
Kiwi
Orange
Pear
LIST:
Carrot
Onion
Potato

&gt;&gt; valgrind ./a.out
==81104== Memcheck, a memory error detector
==81104== Copyright (C) 2002-2024, and GNU GPLd, by Julian Seward et al.
==81104== Using Valgrind-3.24.0 and LibVEX; rerun with -h for copyright info
==81104== Command: ./a.out
==81104== 
LIST:
Banana
Grape
Kiwi
Orange
Pear
LIST:
Carrot
Onion
Potato
==81104== 
==81104== HEAP SUMMARY:
==81104==     in use at exit: 1,088 bytes in 8 blocks
==81104==   total heap usage: 11 allocs, 3 frees, 2,144 bytes allocated
==81104== 
==81104== LEAK SUMMARY:
==81104==    definitely lost: 272 bytes in 2 blocks
==81104==    indirectly lost: 816 bytes in 6 blocks
==81104==      possibly lost: 0 bytes in 0 blocks
==81104==    still reachable: 0 bytes in 0 blocks
==81104==         suppressed: 0 bytes in 0 blocks
==81104== Rerun with --leak-check=full to see details of leaked memory
==81104== 
==81104== For lists of detected and suppressed errors, rerun with: -s
==81104== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)

# Re-run with more information lines that allocate blocks
&gt;&gt; valgrind --leak-check=full ./a.out
==81109== Memcheck, a memory error detector
==81109== Copyright (C) 2002-2024, and GNU GPLd, by Julian Seward et al.
==81109== Using Valgrind-3.24.0 and LibVEX; rerun with -h for copyright info
==81109== Command: ./a.out
==81109== 
LIST:
Banana
Grape
Kiwi
Orange
Pear
LIST:
Carrot
Onion
Potato
==81109== 
==81109== HEAP SUMMARY:
==81109==     in use at exit: 1,088 bytes in 8 blocks
==81109==   total heap usage: 11 allocs, 3 frees, 2,144 bytes allocated
==81109== 
==81109== 408 (136 direct, 272 indirect) bytes in 1 blocks are definitely lost in loss record 2 of 4
==81109==    at 0x48457A8: malloc (vg_replace_malloc.c:446)
==81109==    by 0x1091D4: list_from_array (list_practice.student.c:30)
==81109==    by 0x1093D3: main (list_practice.student.c:77)
==81109== 
==81109== 680 (136 direct, 544 indirect) bytes in 1 blocks are definitely lost in loss record 4 of 4
==81109==    at 0x48457A8: malloc (vg_replace_malloc.c:446)
==81109==    by 0x1091D4: list_from_array (list_practice.student.c:30)
==81109==    by 0x109385: main (list_practice.student.c:68)
==81109== 
==81109== LEAK SUMMARY:
==81109==    definitely lost: 272 bytes in 2 blocks
==81109==    indirectly lost: 816 bytes in 6 blocks
==81109==      possibly lost: 0 bytes in 0 blocks
==81109==    still reachable: 0 bytes in 0 blocks
==81109==         suppressed: 0 bytes in 0 blocks
==81109== 
==81109== For lists of detected and suppressed errors, rerun with: -s
==81109== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 0 from 0)
</pre>
</div>
</div>
<div id="outline-container-orgc2ec20f" class="outline-4">
<h4 id="orgc2ec20f">SOLUTION</h4>
<div class="outline-text-4" id="text-orgc2ec20f">
<details><summary>Click for Solution</summary>

<ol class="org-ol">
<li><p>
What kind of error is Valgrind reporting? What lines of code does
it identify as part of the problem? 
</p>
<blockquote>
<p>
Valgrind identifies that there is a Memory Leak: there are blocks
allocated via <code>malloc()</code> that do not have a corresponding <code>free()</code> to
de-allocate them. The second run of Valgrind uses the option
<code>--leak-check=full</code> to give more insight into where the leaked blocks
were allocated which is in the <code>list_from_array()</code> function.
</p>
</blockquote></li>

<li><p>
What lines of code require alteration to resolve the memory
problem? Are these the same as those that Valgrind reports?
</p>
<blockquote>
<p>
The memory blocks allocated during <code>list_from_array()</code> and appear to
be correct: there are no pointers lost, no uninitialized data created,
etc.  However, there blocks are not de-allocated properly in the
<code>list_free()</code> function which would require iterating over the list of
nodes calling <code>free()</code> on each of them.  This function should be
changed to fix the problem.
</p>
</blockquote></li>

<li><p>
What does a completely correct version of the code look like?
</p>
<blockquote>
<p>
The code below is a typical solution which adjusts <code>list_free()</code> to
first de-allocate all nodes then calls <code>free()</code> on the list struct
itself. 
</p>
</blockquote></li>
</ol>

<div class="org-src-container">
<pre class="src src-c">// list_practice.c: SOLUTION, correctly de-allocates all nodes in
// lists to prevent a memory leak

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

// struct for single data node in linked list
typedef struct node_struct {
  char data[128];               // string at this node
  struct node_struct *next;     // pointer to next node
} node_t;                       // type name for struct in programs: node_t nod;

// struct encapsulating entire linked list
typedef struct {
  node_t *head;                 // NULL or pointer to first node in list
  int size;                     // number of nodes in the list
} list_t;                       // type name for struct in programs: list_t lst;


list_t *list_from_array(char *arr[], int count){
  // Creates a linked list of nodes with data copied from `arr[]`.
  // Nodes are ordered as they appear in `arr[]`
  if(count &lt; 0){
    return NULL;
  }
  list_t *list = malloc(sizeof(list_t));
  list-&gt;head = NULL;
  list-&gt;size = 0;
  if(count==0){
    return list;
  }
  list-&gt;head = malloc(sizeof(node_t));
  strcpy(list-&gt;head-&gt;data, arr[0]);
  list-&gt;head-&gt;next = NULL;
  list-&gt;size++;
  node_t *tail = list-&gt;head;
  for(int i=1; i&lt;count; i++){
    tail-&gt;next = malloc(sizeof(node_t));
    tail = tail-&gt;next;
    strcpy(tail-&gt;data, arr[i]);
    tail-&gt;next = NULL;
    list-&gt;size++;
  }
  return list;
}

void list_print(list_t *list){
  // prints all elements of `list` on their own line
  printf("LIST:\n");
  node_t *ptr = list-&gt;head;
  for(int i=0; i&lt;list-&gt;size; i++){
    printf("%s\n",ptr-&gt;data);
    ptr = ptr-&gt;next;
  }
}
  
void list_free(list_t* list){   // NEEDS A FIX
  // de-allocates memory associated with `list`; must iterate through
  // all nodes to free() them, then free() the list_t
  node_t *ptr = list-&gt;head;
  while(ptr != NULL){
    node_t *freeit = ptr;
    ptr = ptr-&gt;next;
    free(freeit);
  }
  free(list);
}

int main(){
  char *fruits[5] = {
    "Banana",
    "Grape",
    "Kiwi",
    "Orange",
    "Pear",
  };
  list_t *flist = list_from_array(fruits, 5);
  list_print(flist);
  list_free(flist);

  char *veggies[3] = {
    "Carrot",
    "Onion",
    "Potato",
  };
  list_t *vlist = list_from_array(veggies, 3);
  list_print(vlist);
  list_free(vlist);

  return 0;
}  
</pre>
</div>

</details>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr/> <i> <a href="https://www.umd.edu/web-accessibility" title="UMD Web Accessibility">Web Accessibility</a> <br/> Author: Chris Kauffman (<a href="mailto:profk@umd.edu">profk@umd.edu</a>) <br/> Date: 2025-05-15 Thu 13:24 <br/> </i>
</div>
</body>
</html>
