<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-09-21 Sun 15:40 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CMSC216 Project 1: C Programming</title>
<meta name="author" content="Chris Kauffman" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<meta name="viewport" content="width=device-width, maximum-scale=1, minimum-scale=1" />
<style type="text/css">
@media screen {
:root {
--heading-bg-color:#e21833;
--heading-fg-color:#ffd200;
}
html {
font-family: serif;
text-align: justify;
}
pre.src, pre.example {
overflow-x: scroll;
}
/* Merge subtitle area with title area */
.subtitle {
text-align: center;
margin-top: -2em;
padding-top: 1em;
padding-bottom: 0.1em;
}
.title, .subtitle {
color: var(--heading-fg-color);
background-color: var(--heading-bg-color);
}
/* Section borders, left section header style */
div.outline-2, #table-of-contents {
background-color: rgb(250,250,250);
border: 0.75em solid var(--heading-bg-color);
border-top: 0em;
padding: 0em .5em .5em .5em; /* top right bottom left */
margin: 1em 0em 1em 0em; /* top right bottom left */
}
div.outline-2 > h2, #table-of-contents > h2 {
background-color: var(--heading-bg-color);
color: var(--heading-fg-color);
font-variant: small-caps;
padding: 0em 0em 0em .5em; /* top right bottom left */
margin: 0em -.5em 0em -.75em; /* top right bottom left */
text-align: left;
}
blockquote {
font-style: italic;
}
td, th {
padding-top: 2px;
padding-bottom: 2px;
}
body {
background-color: #EEE;
}
pre {
}
#content, #preamble, #postamble {
margin-left:300px;
max-width: 100%;
}
.tag {
background-color: inherit; font-family: inherit;
padding: inherit; font-size: 80%; font-weight: inherit;
text-transform: uppercase;
}

.figure p { text-align: inherit; }
figure-number { font-style: italic; }
#table-of-contents {
text-align: left;
position: fixed;
left: 0;
margin: 0 auto;
padding: 0;
width: 300px;
top: 0;
height: 100%;
border: 0;
display: block;
}
#text-table-of-contents {
overflow-y: scroll;
height: 100%;
}
#text-table-of-contents ul {
padding-left: 1em;
margin-left: 0.5em;
}
#table-of-contents > h2 {
padding: 0.1em;
margin: 0;
}
/* adjustments for small screen, toc at top only */
@media (max-width: 800px) { /* landscape for iphone */
html {
-webkit-text-size-adjust: none;  /* prevent scaling of text on mobile */
}
body {
background-color: #EEE;
width:100%;
margin:0 auto;
}
#content, #preamble, #postamble {
margin-left:0;
}
#table-of-contents {
position: static;
left: inherit;
width:inherit;
height: auto;
border-top: 0em;
padding: 0em .5em .5em .5em; /* top right bottom left */
margin: 1em 0em 1em 0em; /* top right bottom left */
border: 0.75em solid #006633;
}
div.outline-2, #table-of-contents {
background-color: rgb(250,250,250);
border: 0.75em solid var(--heading-bg-color);
border-top: 0em;
padding: 0em .5em .5em .5em; /* top right bottom left */
margin: 1em 0em 1em 0em; /* top right bottom left */
}
div.outline-2 > h2, #table-of-contents > h2 {
background-color: var(--heading-bg-color);
color: var(--heading-fg-color);
font-variant: small-caps;
padding: 0em 0em 0em .5em; /* top right bottom left */
margin: 0em -.5em 0em -.75em; /* top right bottom left */
text-align: left;
}
#text-table-of-contents {
overflow-y: visible;
height: inherit;
}
#text-table-of-contents ul {
padding-left: 1em;
margin-left: 0.5em;
}
}
.linenr { font-size: xx-small; }
th.org-left   { text-align: left;   }
details > summary {
padding: 2px 6px;
font-family: Sans;
font-size: 0.8em;
width: fit-content;
border-radius: 5px;
background-color: #efefef;
border: 1px solid black;
cursor: pointer;
}
}

@media print {
html {
font-family: serif;
font-size: 10pt;
text-align: justify;
.linenr { font-size: xx-small; }
}
}
</style>
<style>
/* Theme: Srcery
Description: Srcery dark color scheme for highlight.js
Author: Chen Bin <chen.bin@gmail.com>
Maintainer: @redguardtoo
Website: https://srcery-colors.github.io/
Date: 2021-04-13
https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/srcery.css

Tailored by: Chris Kauffman <profk@umd.edu>
Date: Sat Nov 25 06:16:20 PM EST 2023
*/
pre code.hljs {
display: block;
overflow-x: auto;
padding: 1em
}
code.hljs {
padding: 3px 5px
}
.hljs {
background: #1C1B19;
/* Black */
color: #FFFFFF/* Bright White */

}
/* Bright White */
.hljs-subst,
.hljs-quote,
.hljs-literal {
color: #FCE8C3
}
/* Bright Blue */
.hljs-type,
.hljs-symbol {
color: #68A8E4
}
/* Red */
.hljs-keyword,
.hljs-deletion {
color: #EF2F27
}
/* Yellow */
.hljs-name,
.hljs-function,
.hljs-attribute,
.hljs-selector-attr,
.hljs-selector-id,
.hljs-selector-class,
.hljs-selector-pseudo,
.hljs-section,
.hljs-title {
color: #FBB829
}
/* Cyan */
.hljs-code,
.hljs-variable,
.hljs-property,
.hljs-template-variable,
.hljs-class {
color: #0AAEB3
}
/* Bright Green */
.hljs-string,
.hljs-regexp,
.hljs-bullet,
.hljs-addition {
color: #98BC37
}
/* Bright Magenta */
.hljs-built_in,
.hljs-params {
color: #FF5C8F
}
/* Blue */
.hljs-template-tag,
.hljs-selector-tag {
color: #2C78BF
}
/* Bright Black */
.hljs-link,
.hljs-number,
.hljs-comment,
.hljs-meta {
color: #B1B195
/* color: #918175 */
}
.hljs-emphasis {
font-style: italic
}
.hljs-strong {
font-weight: bold
}
/* @see https://github.com/srcery-colors/srcery-emacs for reference */
</style>

<link rel="stylesheet" href="./srcery-ck.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
function interactive_lang() {      // define a custom "interactive" language
return {
name: 'interactive',           // language name
keywords: {
$pattern: /[^ \t\n]+/,       // lex based on non-whitespace
keyword: [">>","(shellac)","[COMMANDO]>>","HM>","TM>","HS>","homeputer>","grace3:","grace4:","grace5:","grace6:","grace7:","grace8:","grace9:","grace10:","grace3>>","grace4>>","grace5>>","grace6>>","grace7>>","grace8>>","grace9>>","grace10>>"], // allowed interactive prompts
literal: ["[data/script.txt]>>","[data/script1.txt]>>","[data/script6.txt]>>"],
},
contains: [
// hljs.HASH_COMMENT_MODE,   // use standard hash comments, any # is a comment
hljs.COMMENT(/#+ /, /$/),    // use custom comment of # w/ whitespace
// hljs.COMMENT(/## /, /$/),     // hash-hash-ws for comment
hljs.COMMENT(/##+/, /$/),     // or a sequence of hashes
]
};
};
hljs.registerLanguage('interactive', interactive_lang);     // register custom language

// Add highlighjs CSS classes to elemens marked with relevant org classes
lang_map = new Map();              // map of org to hljs languages
lang_map.set("src-c"     , "language-c");
lang_map.set("src-python", "language-python");
lang_map.set("src-text"  , "language-plaintext");
lang_map.set("src-sh"    , "language-interactive");
function add_class(el) {           // applied to each pre.src element
for (let [org_lang, hljs_lang] of lang_map) {
if(el.classList.contains(org_lang)){
el.classList.add(hljs_lang);
}
}
}
// visit all pre.src elements and apply function to add language class
document.querySelectorAll('pre.src').forEach(add_class);
hljs.configure({cssSelector: 'pre'}); // select pre blocks only to highligh
hljs.highlightAll();                  // perform highlighting on all pre blocks
});
</script>
</head>
<body>
<div id="preamble" class="status">
<i>Last Updated: 2025-09-21 Sun 15:40</i>
</div>
<div id="content" class="content">
<h1 class="title">CMSC216 Project 1: C Programming</h1>
<ul class="org-ul">
<li><b>Due: 11:59pm Mon 29-Sep-2025</b></li>
<li><i>Approximately 4.0% of total grade</i></li>
<li>Submit to <a href="https://www.gradescope.com/"><b>Gradescope</b></a> <i>Submission will open soon</i></li>
<li>Projects are <b>individual work</b>: no sharing of code between students
is allowed. Seek help from course staff if you get stuck for too
long.</li>
</ul>
<div id="outline-container-org296c0ac" class="outline-4">
<h4 id="org296c0ac">CODE DISTRIBUTION: <a href="p1-code.zip">p1-code.zip</a></h4>
</div>
<div id="outline-container-orgd784612" class="outline-4">
<h4 id="orgd784612">VIDEO OVERVIEW: <a href="https://umd.instructure.com/courses/1388320/pages/week03-videos">https://umd.instructure.com/courses/1388320/pages/week03-videos</a></h4>
</div>
<div id="outline-container-org68bf065" class="outline-4">
<h4 id="org68bf065">CHANGELOG:</h4>
<div class="outline-text-4" id="text-org68bf065">
<dl class="org-dl">
<dt>Sun Sep 21 03:38:18 PM EDT 2025</dt><dd><a href="https://piazza.com/class/meuaquvb4xy46i/post/119">Post 119</a> asked whether students
interested in the Makeup Credit should implement both the <i>O(N<sup>2</sup>)</i>
in <code>stock_set_best()</code> and the <i>O(N)</i> version in
<code>stock_set_best_linear()</code> or something else. This is indeed the
intent though the instructions were previously a bit unclear on
this. Instructions in the project spec and documentation comments
have been adjusted to make this more clear: for full credit
<b>implement both functions with their respective time complexities.</b></dd>
</dl>
</div>
</div>
<div id="outline-container-orgea51601" class="outline-4">
<h4 id="orgea51601"></h4>
<div class="outline-text-4" id="text-orgea51601">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgc33e37a">1. Introduction</a></li>
<li><a href="#org70cd996">2. Download Code and Setup</a>
<ul>
<li><a href="#org86ff932">2.1. Makefile</a></li>
<li><a href="#org279f926">2.2. Automated Tests</a></li>
</ul>
</li>
<li><a href="#org258450a">3. Outline of Code</a>
<ul>
<li><a href="#org2c03594">3.1. Getting Started</a></li>
<li><a href="#org555c9d0">3.2. The Dev Cycle</a></li>
</ul>
</li>
<li><a href="#org39cb6a5">4. <b>Problem 1</b>: Stock Plotting</a>
<ul>
<li><a href="#orgabed10b">4.1. Overview and Demo</a></li>
<li><a href="#orgbcaa382">4.2. Editing and Testing</a></li>
<li><a href="#orgd3aa327">4.3. Implementation Notes</a></li>
<li><a href="#org7c08893">4.4. Grading Criteria for Problem 1</a></li>
</ul>
</li>
<li><a href="#orgbb2ecf5">5. <b>Problem 2</b>: Complete Stock Plot Functions</a>
<ul>
<li><a href="#orge145def">5.1. Overview</a></li>
<li><a href="#orgd24ca3a">5.2. Setting Low/High Index</a></li>
<li><a href="#orgc7da84f">5.3. Best Buy/Sell Index</a></li>
<li><a href="#org0a39b9d">5.4. Stock Files</a></li>
<li><a href="#orgd937aff">5.5. Counting Lines</a></li>
<li><a href="#org232af3b">5.6. Loading Stock Files</a></li>
<li><a href="#orgd4e31f4">5.7. Plotting Stocks</a></li>
<li><a href="#orgfebc42f">5.8. Grading Criteria for Problem 2</a></li>
</ul>
</li>
<li><a href="#orge29e805">6. <b>Problem 3</b>: Main Stock Application</a>
<ul>
<li><a href="#orgdcbdc40">6.1. main() Command Line Args</a></li>
<li><a href="#org2f6b0e5">6.2. Implementation of main()</a></li>
<li><a href="#org3002d2a">6.3. Grading Criteria for Problem 3</a></li>
</ul>
</li>
<li><a href="#org5089917">7. <b>Problem 4</b>: Multi-stock Plotting</a>
<ul>
<li><a href="#org79c3ffa">7.1. Rationale</a></li>
<li><a href="#orgbc8af0b">7.2. Additional Required Service Functions</a></li>
<li><a href="#org62c785e">7.3. Additional Main Application</a></li>
<li><a href="#org1a903fd">7.4. Grading Criteria for Problem 4</a></li>
</ul>
</li>
<li><a href="#org8eb8479">8. OPTIONAL Makeup Credit</a></li>
<li><a href="#orgdfa094f">9. Project Submission</a>
<ul>
<li><a href="#org847e8c9">9.1. Submit to Gradescope</a></li>
<li><a href="#org00454f5">9.2. Late Policies</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-orgc33e37a" class="outline-2">
<h2 id="orgc33e37a"><span class="section-number-2">1</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
Basic application programming in C is an essential step downward form
higher-level environments (Java / Python / OCaml) towards the lower
levels of computing. This project explores fundamental aspects of
getting work done in C:
</p>
<ul class="org-ul">
<li>Dynamic memory management with <code>malloc()/free()</code></li>
<li>Reading data from files in text format</li>
<li>Displaying information to the screen</li>
<li>Reading commands from users in interactive programs</li>
<li>Building data structures with C <code>structs</code></li>
</ul>

<p>
The assignment is divided into several problems utilizing many of the
above techniques.
</p>
<ul class="org-ul">
<li>Problem 1 implements a few simple function surrounding a <code>struct</code>
representing stock prices.</li>
<li>Problem 2 builds on the previous routines with more complex
functionality related to the stock data.</li>
<li>Problem 3 completes the application by coding a <code>main()</code> function to
employ the stock functions to plot from the command line.</li>
<li>Problem 4 adds several new functions and a separate <code>main()</code> which
plots multiple stocks in the same space to aid with analysis.</li>
</ul>

<p>
Problems build on each other and should be done in order to complete
the project.
</p>

<p>
Each problem contributes to an application that will read stock price
data in a simple text format and display that information in a text
terminal as a primitive graph. The application is divided between a
set of service functions and two main functions which will call those
functions to achieve the overall aims of the applications.
</p>
</div>
</div>
<div id="outline-container-org70cd996" class="outline-2">
<h2 id="org70cd996"><span class="section-number-2">2</span> <a id="orgb387f20"></a> Download Code and Setup</h2>
<div class="outline-text-2" id="text-2">
<p>
Download the code pack linked at the top of the page. Unzip this which
will create a project folder. Create new files in this
folder. Ultimately you will re-zip this folder to submit it.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">File</th>
<th scope="col" class="org-left">State</th>
<th scope="col" class="org-left">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>Makefile</code></td>
<td class="org-left">Provided</td>
<td class="org-left">Build file to compile all programs</td>
</tr>

<tr>
<td class="org-left"><code>gradescope-submit</code></td>
<td class="org-left">Provided</td>
<td class="org-left">Allows submission to Gradescope from the command line</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><code>stock_funcs.c</code></td>
<td class="org-left">CREATE</td>
<td class="org-left">Problem 1/2/4 functions to write</td>
</tr>

<tr>
<td class="org-left"><code>stock_main.c</code></td>
<td class="org-left">CREATE</td>
<td class="org-left">Problem 3 main function to complete</td>
</tr>

<tr>
<td class="org-left"><code>stock_multimain.c</code></td>
<td class="org-left">CREATE</td>
<td class="org-left">Problem 4 main function to complete</td>
</tr>

<tr>
<td class="org-left"><code>stock_demo.c</code></td>
<td class="org-left">Provided</td>
<td class="org-left">Problem 1/2 demo code to show some function invocations</td>
</tr>

<tr>
<td class="org-left"><code>stock.h</code></td>
<td class="org-left">Provided</td>
<td class="org-left">Problem 1/2 header file</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">TESTING</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>testy</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Test running script</td>
</tr>

<tr>
<td class="org-left"><code>test-results/</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Directory in which temporary testing files are written</td>
</tr>

<tr>
<td class="org-left"><code>test_stock_funcs.c</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Testing file for Problems 1 &amp; 2</td>
</tr>

<tr>
<td class="org-left"><code>test_stock1.org</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Problem 1 tests</td>
</tr>

<tr>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>test_stock4.org</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Problem 4 tests</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>data/stock-ascending.txt</code></td>
<td class="org-left">Data</td>
<td class="org-left">Data files testing</td>
</tr>

<tr>
<td class="org-left"><code>data/stock-valley.txt</code></td>
<td class="org-left">Data</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>data/stock-jagged.txt</code></td>
<td class="org-left">Data</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#x2026;</td>
<td class="org-left">Data</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
<div id="outline-container-org86ff932" class="outline-3">
<h3 id="org86ff932"><span class="section-number-3">2.1</span> Makefile</h3>
<div class="outline-text-3" id="text-2-1">
<p>
A <code>Makefile</code> is provided as part of this project. Building programs in
C is a bit tedious and most folks use <b>build systems</b> of which <code>make</code>
is the oldest. The instructions and dependencies to create programs
are written in a <code>Makefile</code> which is then interpreted by the <code>make</code>
program which will run <code>gcc</code> and other commands to create programs.
</p>

<p>
Use this <code>Makefile</code> by issuing commands like <code>make prob1</code>
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; make help
Typical usage is:
  &gt; make                          # build all programs
  &gt; make clean                    # remove all compiled items
  &gt; make zip                      # create a zip file for submission
  &gt; make prob1                    # built targets associated with problem 1
  &gt; make test                     # run all tests
  &gt; make test-prob2               # run test for problem 2
  &gt; make test-prob2 testnum=5     # run problem 2 test #5 only
  &gt; make submit                   # upload submission to Gradescope

&gt;&gt; make prob2                     # build problem 2 demo program
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -c stock_funcs.c
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -c stock_demo.c
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -o stock_demo stock_demo.o stock_funcs.o

&gt;&gt; make clean                     # remove all programs/binary object files
rm -f stock_main stock_demo test_stock_funcs  *.o

&gt;&gt; make prob3                     # build problem 3 main program
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -c stock_main.c
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -c stock_funcs.c
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -o stock_main stock_main.o stock_funcs.o

&gt;&gt; make clean                     # remove all programs/binary object files
rm -f stock_main stock_demo test_stock_funcs *.o

&gt;&gt; make                           # build all programs/objects for the assignment
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -c stock_main.c
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -c stock_funcs.c
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -o stock_main stock_main.o stock_funcs.o
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -c stock_demo.c
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -o stock_demo stock_demo.o stock_funcs.o
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -o test_stock_funcs test_stock_funcs.c stock_funcs.o
</pre>
</div>

<p>
You are not required to understand all that is in the <code>Makefile</code> (yet)
but it is a very useful tool well worth your time to learn.
</p>
</div>
</div>
<div id="outline-container-org279f926" class="outline-3">
<h3 id="org279f926"><span class="section-number-3">2.2</span> <a id="orga7ae76c"></a> Automated Tests</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Automated tests are included with the code distribution. <b>These tests
are known to work on grace.umd.edu only</b> but in most cases they should
run identically in Linux environments. They <i>may</i> work on the Windows Subsystem
for Linux but no guarantees are made. They very unlikely to run on
MacOS natively as Linux-specific tools are used.
</p>

<p>
The provided <code>Makefile</code> allows automated tests to be run via calls
like <code>make test-prob1</code> to test Problem 1 and <code>make test-prob2</code> to test
Problem 2. See the transcript below.
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; make test-prob1               # run tests for problem 1, compiles required code first
gcc -Wall -Wno-comment -Werror -g  -c stock_funcs.c
gcc -Wall -Wno-comment -Werror -g  -o test_stock_funcs test_stock_funcs.c stock_funcs.o
./testy test_stock1.org 
============================================================
== test_stock1.org : Problem 1 First 3 Functions in stock_funcs.c
== Running 15 / 15 tests
1)  stock_new            : ok
2)  stock_free1          : ok
3)  stock_free2          : ok
4)  stock_free3          : ok
5)  stock_free4          : ok
6)  stock_print1         : ok
7)  stock_print2         : ok
8)  stock_print3         : ok
9)  stock_print4         : ok
10) stock_print5         : ok
11) stock_print_prices_0 : ok
12) stock_print_prices_1 : ok
13) stock_print_prices_2 : ok
14) stock_print_prices_3 : ok
15) stock_print_final    : ok
============================================================
RESULTS: 15 / 15 tests passed

&gt;&gt; make test-prob2                         # run tests for problem 2
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -c stock_funcs.c
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -o test_stock_funcs test_stock_funcs.c stock_funcs.o
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -c stock_demo.c
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -o stock_demo stock_demo.o stock_funcs.o
./testy test_stock2.org 
============================================================
== test_stock2.org : Problem 2 Remaining Functions in stock_funcs.c
== Running 20 / 20 tests
1)  stock_set_hilo1         : ok
2)  stock_set_hilo2         : ok
3)  stock_set_hilo3         : ok
4)  stock_set_best1         : ok
5)  stock_set_best2         : ok
6)  stock_set_best3         : ok
7)  stock_set_best4         : ok
8)  count_lines             : ok
9)  stock_load1             : ok
10) stock_load2             : ok
11) stock_load3             : ok
12) stock_load pathological : ok
13) stock_plot1             : ok
14) stock_plot2             : ok
15) stock_plot3             : ok
16) stock_plot4             : ok
17) stock_plot5             : ok
18) stock_plot6             : ok
19) stock_plot7             : ok
20) stock_demo              : ok
============================================================
RESULTS: 20 / 20 tests passed
 
&gt;&gt; make test                         # run tests for all problems
...
</pre>
</div>
<p>
Each problem describes specifically how tests can be run and how
credit will be assigned.
</p>

<p>
Note that one can <b>run a single test</b> with the following <code>make</code>
invocation which sets <code>testnum</code>.
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; make test-prob2 testnum=5
</pre>
</div>
<p>
This is useful when debugging to limit the output and time it takes to
check program results.
</p>
</div>
</div>
</div>
<div id="outline-container-org258450a" class="outline-2">
<h2 id="org258450a"><span class="section-number-2">3</span> Outline of Code</h2>
<div class="outline-text-2" id="text-3">
<p>
The file <code>stock_funcs.c</code> will contain most of the support functions
for the plotting program. An outline of these functions are presented
below. Note that each function has the Problem # to which it
belongs. The final <code>main()</code> function should be written in the
<code>stock_main.c</code> file.
</p>

<p>
You may add additional functions to those indicated ("helper" or
"utility" functions) but these will not graded and the design of the
project is oriented towards not needing additional functions.
</p>

<div class="org-src-container">
<pre class="src src-c">// stock_funcs.c: support functions for the stock_main program.

#include "stock.h"

stock_t *stock_new();
// PROBLEM 1: Allocate a new stock struct and initialize its fields.
// Integer fields like 'count' and 'lo_index' should be initialied to
// -1.  Pointer fields like 'prices' should be initialized to
// NULL. The stock should be heap-allocated using malloc() and
// returned.  Since this is an allocation function, no use of 'free()'
// should appear.

void stock_free(stock_t *stock);
// PROBLEM 1: Free a stock. Check the 'data_file' and 'prices' fields:
// if they are non-NULL, then free them. Then free the pointer to
// 'stock' itself.

void stock_print(stock_t *stock);
// PROBLEM 1: Prints data about a stock that is passed in via a
// pointer. Uses the syntax ptr-&gt;field to access fields of the struct
// pointed by 'stock'.  Output follows the general convention:
//
// ==STOCK DATA==
// data_file: data/stock-jagged.txt                      
// count: 15
// prices: [103.00, 250.00, 133.00, ...]
// lo_index:  8
// hi_index:  11
// best_buy:  8
// best_sell: 11
// profit:    232.00
//
// Each line prints a field of the stock_t struct. In all cases,
// floating point numbers are printed with 2 decimal digits of
// accuracy.
//
// NULLS FOR FIELDS
// The fields 'data_file' and 'prices' may be NULL in which case they
// will be printed specially as in
// 
// data_file: NULL
// prices: NULL
//
// This requires a manual if/else check for NULL values for these
// pointers.
// 
// PRICES FIELD
// When printing the 'prices' field, if the 'count' field is 0 to 3,
// print the entire array as in
//
// prices: []                        # count == 0
// prices: [70.00]                   # count == 1
// prices: [50.00, 90.00]            # count == 2
// prices: [59.00, 45.00, 103.00]    # count == 3
//
// Otherwise, print the first 3 elements with a ... at the end as in
//
// prices: [10.00, 20.00, 30.00, ...] # count &gt; 3
//
// PROFIT
// There is no 'profit' field in the struct. Instead, calculate the
// profit as the difference between the price at the 'best_sell' index
// and 'best_buy' index.  If these indices are -1 indicating the best
// buy/sell time is not known or not viable, print a proit of 0.0

void stock_set_hilo(stock_t *stock);
// PROBLEM 2: Sets the index of 'lo_index' and 'hi_index' fields of
// the stock to be the positions in 'prices' of the lowest and highest
// values present in it. Uses a simple loop over the array 'prices'
// which is 'count' elements long to examine each for high/low. If
// 'count' is zero, makes no changes to 'lo_index' and 'hi_index'.

int stock_set_best(stock_t *stock);
// PROBLEM 2: Sets the 'best_buy' and 'best_sell' fields of 'stock'.
// This corresponds to the pair which produces the best profit. On
// determining the best buy/sell indices which produce a positive
// profit, sets these fields in 'stock' and returns 0. If there is no
// buy/sell point which would result in a positive profit, sets the
// 'best_buy' and 'best_sell' indices to -1 and returns -1. Always
// calculates the earliest buy/sell pair of indices that would get the
// best profit: if 5,8 and 5,9 and 7,10 all give the same, maximal
// profit, the best buy/sell indices are set to 5,7.
// 
// ALGORITHM NOTES
// One intuitive algorithm to compute this is to try every possible
// buy index (outer loop) and every possible sell index after it
// (inner loop) looking for the maximum profit produced in it. This is
// a O(N^2) algorithm with N=count.  Using this algorithm is a good
// start.
//
// Some MAKEUP CREDIT will be awarded for implementing a more
// efficient, O(N) algorithm but THIS FUNCTION MUST IMPLEMENT THE
// O(N^2) ALGORITHM to earn credit. Implement the O(N) version
// elsewhere for Makeup Credit.

int count_lines(char *filename);
// PROBLEM 2: Opens file named 'filename' and counts how many times
// the '\n' newline character appears in it which corresponds to how
// many lines of text are in it.  Makes use of either fscanf() with
// the %c format to read single characters or alternative I/O
// functions like fgetc(). Closes the file before returning a count of
// how many lines are it it.  If for any reason the file cannot be
// opened, prints a message like
//
//   Could not open file '&lt;FILENAME&gt;', cannot count lines
//
// with &lt;FILENAME&gt; substituted for the name of the file. Returns -1 to
// indicate failure in this case.

int stock_load(stock_t *stock, char *filename);
// PROBLEM 2: Loads a stock from file 'filename' into 'stock' filling
// its 'prices' and 'count' fields in. Makes use of the count_lines()
// function to determine how many lines are in the file which will
// dictate 'count' and the length of 'prices'. Allocates space in the
// heap for the stock's 'prices' array, opens the 'filename' and
// iterates through reading prices into the array. The data format for
// prices files is
//
// time_03 133.00
// time_04 143.00
// time_05 168.00
// time_06 91.00
// 
// where each line has a time as as single string and a price which is
// floating point number. The times can be ignored which can be
// accomplished with a fscanf() call with format "%*s" to read a
// string but ignore/discard it.
// 
// Assigns the 'datafile' field to be a duplicated string of
// 'filename' for which 'strdup()' is extremely useful. This string
// must be free()'d later likely in 'stock_free()'
// 
// On successfully loading the stock, returns 0.
//
// If 'filename' cannot be opened, prints the message 
// 
//   Unable to open stock file '&lt;FILENAME&gt;', cannot load stock data
//
// with '&lt;FILENAME&gt;' substituted in for the name of the stock and
// returns -1.

void stock_plot(stock_t *stock, int max_height, int start, int stop);
// PROBLEM 2: Plots a graphical representation of stock
// information. First calculates and prints plot which is in the
// following format:
//
// ==PLOT DATA==
// start/stop:  0 15
// max_height:  14
// price range: 309.00
// plot step:   22.07
//            +--B=S----------+
//     300.93 |    H   *      |
//     278.86 | *  H   *      |
//     256.79 | *  H   *      |
//     234.71 | *  H   *      |
//     212.64 |**  H   *      |
//     190.57 |**  H * *      |
//     168.50 |**  H** *  *  *|
//     146.43 |**  H** *  ****|
//     124.36 |**  H****  ****|
//     102.29 |**  H****  ****|
//      80.21 |** *H***** ****|
//      58.14 |** *H***** ****|
//      36.07 |** *H***** ****|
//      14.00 |****H*****L****|
//            +^----^----^----+
//             0    5    10   
// 
// Here brief notes on the format with more detail in the project
// specification.
// - Parameters start, stop, and max_height are printed first along with
//   calculated information like the price_range (uses hi_index and
//   lo_index)
// - The main body of the plot is exactly max_height characters high. The
//   lowest line is the price at lo_index; the highest is hi_index minus
//   plot_step
// - The vertical axis prices can be printed with the format specifier
//   %10.2f to give the correct leading whitespace with 2 digits of
//   accuracy
// - If the hi and lo prices appear in the range, their bar is printed
//   with an H or an L while all other stocks are printed with a *
// - The top axis may include a B and an S at the positions of the
//   best_buy and best_sell index with a = between these to show the
//   period of ownership.
// - The bottom axis shows tic marks as ^ and below them index labels at
//   values divisible by 5. For the numeric index labels, it is easiest
//   to print spaces to a value divisible by 5 then use the format
//   specifier %-5d to print integers: this aligns left and prints
//   whitespace padding on the right to width 5. In a loop, one can
//   advance by +5 each time a label is printed.

int main(int argc, char *argv[]);
// PROBLEM 3: main() in stock_main.c
//
// The program must support three command line forms.
// 1. ./stock_main &lt;stockfile&gt; &lt;max_height&gt;
// 2. ./stock_main &lt;stockfile&gt; &lt;max_height&gt; &lt;start&gt; 
// 3. ./stock_main &lt;stockfile&gt; &lt;max_height&gt; &lt;start&gt; &lt;stop&gt;
//
// All forms have a the stock file as the first command line argument
// and the maximum plotting height as the 2nd argument. Forms 2 and 3
// optionally specify a starting time index (inclusive) and stopping
// time index (exclusive) to plot a time range for the stock prices. 
//
// NOTES
// - It is a good idea to check that the number of command line
//   arguments is either 3 (Form 1) or 4 (Form 2) or 5 (form 3) if
//   not, bail out from the program. There may or may not be an
//   automated test that checks that no action is taken when an
//   incorrect number of command line arguments appear but there will
//   definitely be tests for each of the forms indicated so a logical
//   and clean structure that attends to them is a good idea.
// - All command line arguments come into C programs as strings
//   (char*).  That means the numbers on the command line like
//   `max_height` will also be a string of characters and need to be
//   converted to an int to be used in the program.  The atoi()
//   function is useful for this: search for documentation on it and
//   use it for the conversion.
// - Make sure to check that loading stock data from a file
//   succeeds. If not, print the following error message:
//
//     Failed to load stock file, exiting
//
//   This message is in addition to the error message that is printed
//   by the stock_load() function. Return 1 from main() to indicate
//   that the program was not successful.
// - If stock data is successfully loaded, perform the requested
//   plotting using appropriate functions. Don't forget to free
//   heap-allocated memory before ending the program.
//
// NOTE: a second main() function is required for Problem 4 in a
// different file.

stock_t **stock_load_all(char *filenames[], int stock_count);
// PROBLEM 4: Loads all files named in `filenames[]` as stocks and
// returns an array of pointers to those stocks. The length of the
// `filenames[]` array is given in `stock_count`. Uses `stock_new() /
// stock_load()` to create and load individual stocks. If any stock
// fails to load, prints an error message
//
// Failed to load stock file &lt;I&gt;
//
// with &lt;I&gt; substituted for the index of the problematic file, then
// de-allocates all memory that has so far been allocated and returns
// NULL to indicate failures.

// max stocks supported for mult-stock printing in Problem 4
#define STOCKS_MAX_COUNT 26 

// characters to use for plotting stocks
char stock_chars[STOCKS_MAX_COUNT+1] ="abcdefghijklmnopqrstuvwxyz";

void stock_multiplot(stock_t **stocks, int stocks_count, int max_height);
//
//
// PROBLEM 4: Plot all of the stocks in the `stocks` array which is
// `stocks_count` elements long. 
//
// EXAMPLE PLOT:
//
// ==MULTIPLOT DATA==
// max_height:  10
// stop_count:  15
// min price:   38.00
// max price:   270.00
// price range: 232.00
// plot step:   23.20
// ==LEGEND==
// a : data/stock-valley.txt
// b : data/stock-jagged.txt
//
//            +------------------------------+
//     246.80 |   b                 b B      |
//     223.60 |   b         b       b B      |
//     200.40 |   b         b       b B      |
//     177.20 |   b         b       b B      |
//     154.00 |   b     b   b       b B      |
//     130.80 |   b b b b   b       b B      |
//     107.60 |   b b b b   b       b B      |
//      84.40 |abab b b b b b    a abAB     b|
//      61.20 |abababab b b ba a a abAB   b b|
//      38.00 |abababababAbababaBababAB b b b|
//            +^---------^---------^---------+
//             0         5         10        
//
// DETAILS
//
// Plots start with the ==MULTIPLOT DATA== shown above which shows
// basic plotting parameters. The stop index, minimum price, and
// maximum price are set by finding the maximum count and min/max
// price among all stocks in the array.
//
// The ==LEGEND== shows the character which will be printed associated
// with each stock file. These are drawn from the provided
// `stock_chars[]` array with the 0th stock printed using the 0th
// character, 1th stock the 1th character, and so on. For each stock,
// the columns of the low and high prices for the stock are printed as
// upper case characters using the library `toupper()` conversion
// function to make it easier to identify the extrema for stocks.
//
// When plotting, each stock is printed in its own column. If there
// are 2 stocks, then each "time" index will have two columns as shown
// above. If there are 8 stocks, then each time index will have 8
// columns. The plotting area will be stocks_count*stop_count
// characters wide. If a stock has a lower count (shorter prices
// array) than stop_count, then blanks are printed in the columns
// beyond its count (true for the `a` stock above in the last few
// columns).
//
// If `stocks_count` is larger than `STOCKS_MAX_COUNT`, prints message
//   ERROR: stocks array length &lt;COUNT&gt; exceeds max &lt;MAX&gt;\n
// with &lt;COUNT&gt; and &lt;MAX&gt; substituted and immediately returns.
//
// NOTES
// - The `stocks` variable is an array of pointers; that means the
//   syntax `stocks[i]-&gt;field` accesses some field for the ith
//   stock. Adapt this syntax to the various cases of accessing data
//   for an individual stock.
// - Unlike the single plotting, plot parameters like the stop_count and
//   min/max price must be determined by analyzing all stocks. Use a
//   loop to iterate through to find the extreme values among stocks.
// - The plotting procedure itself will be similar to `stock_plot()`
//   except for an additional layer of looping: for time index &lt;i&gt;,
//   loop through all stocks and print their characters. Copying in
//   code from `stock_plot()` is a good idea and then making
//   adjustments is likely to yield good results.
// - Multiplots always start at time index 0 and go to the time index
//   of the stock with the largest prices[] count.
// - When plotting a stock, check that it has a count that is above
//   the current time index so that it will have data in its prices[]
//   array. Not all stocks in a multiplot will have the same count of
//   prices so it is possible to go out of bounds in arrays if one is
//   not careful.
// - The axis are wider: stop_count*stock_count characters wide. Use
//   this in some loops to print boundaries.
// - The axis label ticks are tricky. TRY USING PRINTF() by printing
//   the numeric label in a field of 5 characters wide, then print
//   additional 5-wide characters based stock_count to line up the
//   next location that needs a numeric label.
// - The function assumes that the high and low price indices have
//   been set for all stocks prior to them being passed in. A main()
//   is a good spot to do this. Since the best buy/sell points do not
//   show in this function, these fields can remain uninitialized not
//   affect the function's behavior.

int main(int argc, char *argv[]);
// PROBLEM 4: main() function in stock_multimain.c: Load multiple
// stock files and plot them together.
//
// The program must support an arbitrary number of command line
// arguments according to the pattern:
// 1. ./stock_multimain &lt;max_height&gt; &lt;stockfile1&gt;
// 2. ./stock_multimain &lt;max_height&gt; &lt;stockfile1&gt; &lt;stockfile2&gt;
// 3. ./stock_multimain &lt;max_height&gt; &lt;stockfile1&gt; &lt;stockfile2&gt; &lt;stockfile3&gt;
// 4. etc.
// The first parameter is the maximum height to plot which remaining
// arguments as filenames containing the stock data to use in the
// multiplot.
//
// `stock_load_all()` is used to load the stock files. If something goes
// wrong, prints the error message:
//   Problems loading all stock files, exiting
// and exit with return code 1.
//
// The high/low prices are set for each stock using an appropriate
// service function and the stocks are plotted using
// `stock_multiplot()`
//
// SAMPLE OUTPUT OF STOCK_MULTIMAIN
// &gt;&gt; ./stock_multimain 10 data/s01.txt data/s02.txt data/s03.txt
// ==MULTIPLOT DATA==
// max_height:  10
// stop_count:  10
// min price:   1.00
// max price:   99.00
// price range: 98.00
// plot step:   9.80
// ==LEGEND==
// a : data/s01.txt
// b : data/s02.txt
// c : data/s03.txt
//
//            +------------------------------+
//      89.20 |    B                         |
//      79.40 |    B  bC               Abc  c|
//      69.60 |    B  bC               Abc  c|
//      59.80 |  c B  bC   a c         Abc bc|
//      50.00 |  c B  bC   a c       b Abc bc|
//      40.20 |a c B  bCa ca c       b Abc bc|
//      30.40 |a caB abCabca c       b Abc bc|
//      20.60 |a caB abCabcabca   b  b Abc bc|
//      10.80 |abcaB abCabcabcaBc b ab Abc bc|
//       1.00 |abcaBcabCabcabcaBcAbCabcAbcabc|
//            +^--------------^--------------+
//             0              5              
//
// NOTES
// - If fewer than 1 stock file is provided, print a usage
//   message. This case won't be tested but is instructive.
// - It is handy to use pointer arithmetic to locate where in argv[]
//   the names of stock files begin so that this portion of the array
//   can be passed directly to `stock_load_all()` and spare one the
//   need of copying strings.
// - Typically the function will load all stock files required, then
//   loop through and initialize their high/low price indices with an
//   appropriate function and then call the multi-plot function to
//   show them.  There is no need to set the best buy/sell indices in
//   this application.
// - The normal `stock_set_best()` function MUST be present with
//   Quadratic complexity (or worse)
// - The linear time version must also be present 
// - The linear time version MUST be used in `main()` and pass test cases
//   associated with running the whole program.
int stock_set_best_linear(stock_t *stock);
//
// OPTIONAL MAKEUP CREDIT: Identical to stock_set_best() except uses a
// linear time algorithm to determine the best buy/sell times

</pre>
</div>
</div>
<div id="outline-container-org2c03594" class="outline-3">
<h3 id="org2c03594"><span class="section-number-3">3.1</span> Getting Started</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Create the file <code>stock_funcs.c</code>. Copy the code outline above into
the C file to serve as a starting point for the project. Filling in
dummy bodies (e.g. <code>return 0</code> or <code>return NULL</code> etc.) will allow the
Automated Tests to run after which one can begin filling in
definitions for the functions according to the provided specification.
</p>

<p>
For the most part, try to solve functions in the order that they
appear in the code outline as later functions will use earlier
functions. If you do get stuck on a function, don't be afraid to move
on momentarily to keep your momentum up.
</p>
</div>
</div>
<div id="outline-container-org555c9d0" class="outline-3">
<h3 id="org555c9d0"><span class="section-number-3">3.2</span> The Dev Cycle</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-orgb835119" class="outline-4">
<h4 id="orgb835119">To complete the project</h4>
<div class="outline-text-4" id="text-orgb835119">
<ul class="org-ul">
<li>Read documentation on a required function</li>
<li>Write part of the implementation</li>
<li>Run test cases associated with function</li>
<li>Analyze the results</li>
<li>Consult docs on the function for clarification</li>
<li>Add <code>printf()</code> statements to show debug information</li>
<li>Repeat the above until all tests for the function pass</li>
<li>Consult the MANUAL INSPECTION criteria to ensure your style and
functionality meet their requirements</li>
<li>Repeat for the next function</li>
</ul>
</div>
</div>
<div id="outline-container-orga871f19" class="outline-4">
<h4 id="orga871f19">When stuck on a bug for an Extended period (1+ hour)</h4>
<div class="outline-text-4" id="text-orga871f19">
<ul class="org-ul">
<li>Search for related examples from Labs / HWs / Lectures</li>
<li>Ask for help on Piazza or visit office hours</li>
<li>Take a break and come back after recovering some mental energy</li>
<li><i>Stay Determined!</i></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org39cb6a5" class="outline-2">
<h2 id="org39cb6a5"><span class="section-number-2">4</span> <b>Problem 1</b>: Stock Plotting</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-orgabed10b" class="outline-3">
<h3 id="orgabed10b"><span class="section-number-3">4.1</span> <a id="orga4111a4"></a> Overview and Demo</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Problems 1 and 2 create a small plotting application that is focused
on stock prices. In stock trading, the idea is to buy a stock when it
is priced low and sell it at a later time point when the price is high
which will net the profit of the difference between each. Of course,
this must be done by predicting when prices are at their highest and
lowest points and some insight can be garnered from examining
historical data for stock prices. The application you will build
allows for easy analysis of a simple data file containing times/prices
for stocks and display of their information in simple text plots. At
the end of problems 1 and 2, you will have an application which
produces the following kind of output.
</p>

<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; make stock_main                            # compile the stock_main program (after completing problems 1&amp;2)
gcc -Wall -Wno-comment -Werror -g  -c stock_main.c
gcc -Wall -Wno-comment -Werror -g  -c stock_funcs.c
gcc -Wall -Wno-comment -Werror -g  -o stock_main stock_main.o stock_funcs.o

&gt;&gt; ./stock_main data/stock-ascending.txt 10   # plot the data in a stock-ascending data file
==STOCK DATA==
data_file: data/stock-ascending.txt
count: 10
prices: [10.00, 20.00, 30.00, ...]            # shows the first few stock prices
lo_index:  0                                  # calculates index of low/high price
hi_index:  9
best_buy:  0                                  # calculates optimal buy/sell time
best_sell: 9
profit:    90.00
==PLOT DATA==
start/stop:  0 10
max_height:  10                               # 10 specifed on command line for bar height
price range: 90.00                            # highest_price - lowest_price
plot step:   9.00                             # range / max_height
           +B========S+                       # top axis shows Buy/Sell range
     91.00 |         H|                       # main plot body shows bars for stock price
     82.00 |        *H|                       # at each time step
     73.00 |       **H|                       
     64.00 |      ***H|                       # normal prices plotted with a *
     55.00 |     ****H|                       # Lowest and Highest prices plotted with
     46.00 |    *****H|                       # an L and H respectively
     37.00 |   ******H|
     28.00 |  *******H|                       # bars are between 1 and max_height chars
     19.00 | ********H|                       # tall
     10.00 |L********H|
           +^----^----+                       # bottom axis has tick marks and labels
            0    5                            # at time indexes divisible by 5


&gt;&gt; ./stock_main data/stock-ascending.txt 5 3 10
==STOCK DATA==                                # same file but make bars at most 5 high
data_file: data/stock-ascending.txt           # and limit output to time index 3 to 9
count: 10
prices: [10.00, 20.00, 30.00, ...]            # same info on stock file
lo_index:  0
hi_index:  9
best_buy:  0
best_sell: 9
profit:    90.00
==PLOT DATA==
start/stop:  3 10                             # plot data has adjusted start/stop index
max_height:  5                                # different max_height
price range: 90.00
plot step:   18.00                            # plot step as seen on left axis labels is
           +======S+                          # different due to the different max_height
     82.00 |     *H|
     64.00 |   ***H|
     46.00 | *****H|
     28.00 |******H|
     10.00 |******H|
           +--^----+                          # bottom axis indicates starting time of 3
              5                               # rather than 0, tics and labels adjusted

&gt;&gt; ./stock_main data/stock-valley.txt 12      # plot a "valley" shaped stock pricing
==STOCK DATA==
data_file: data/stock-valley.txt
count: 12
prices: [100.00, 90.00, 80.00, ...]
lo_index:  5
hi_index:  11
best_buy:  5                                  # best to buy in the middle at lowest point
best_sell: 11                                 # and sell at the end at highest price
profit:    55.00
==PLOT DATA==
start/stop:  0 12
max_height:  12
price range: 55.00
plot step:   4.58
           +-----B=====S+                     # top axis shows - when stock is not
    100.42 |           H|                     # purchased, B at the best_buy index
     95.83 |*          H|                     # and S at the best_sell index with
     91.25 |*         *H|                     # = symbols between B and S
     86.67 |**        *H|
     82.08 |**       **H|
     77.50 |***      **H|
     72.92 |***     ***H|
     68.33 |****    ***H|
     63.75 |****   ****H|
     59.17 |*****  ****H|
     54.58 |***** *****H|
     50.00 |*****L*****H|
           +^----^----^-+
            0    5    10   

&gt;&gt; ./stock_main data/stock-jagged.txt 15      # plot a jagged stock price file
==STOCK DATA==                                # where prices bound around a lot
data_file: data/stock-jagged.txt
count: 15
prices: [103.00, 250.00, 133.00, ...]
lo_index:  8
hi_index:  11
best_buy:  8
best_sell: 11
profit:    232.00
==PLOT DATA==
start/stop:  0 15
max_height:  15
price range: 232.00
plot step:   15.47
           +--------B==S---+                  # Buy to Sell range is shorter in 
    254.53 |           H   |                  # this case and does not align with 
    239.07 | *        *H   |                  # either the first or last time index
    223.60 | *    *   *H   |
    208.13 | *    *   *H   |
    192.67 | *    *   *H   |
    177.20 | *    *   *H   |
    161.73 | *  * *   *H   |
    146.27 | *  * *   *H   |
    130.80 | **** *   *H   |
    115.33 | **** *   *H   |
     99.87 |***** *   *H  *|
     84.40 |*******   *H  *|
     68.93 |*******   *H **|
     53.47 |********  *H***|
     38.00 |********L**H***|
           +^----^----^----+
            0    5    10   


&gt;&gt; ./stock_main data/stock-min-after-max.txt 10
==STOCK DATA==                                 # file with buy/sell different than
data_file: data/stock-min-after-max.txt        # hi/lo index
count: 15
prices: [223.00, 292.00, 27.00, ...]
lo_index:  10                                  # minimum price appear after  
hi_index:  4                                   # the maximum price           
best_buy:  2                                   # finding the optimal buy/sell                              
best_sell: 4                                   # point is harder in this case                              
profit:    296.00                              
==PLOT DATA==                                  
start/stop:  0 15                              
max_height:  10                                
price range: 309.00
plot step:   30.90
           +--B=S----------+                   # best_buy index is not at the
    292.10 |    H   *      |                   # low price because the high
    261.20 | *  H   *      |                   # price occurs before the low
    230.30 | *  H   *      |                   # price
    199.40 |**  H * *      |
    168.50 |**  H** *  *  *|
    137.60 |**  H****  ****|
    106.70 |**  H****  ****|
     75.80 |** *H***** ****|
     44.90 |** *H***** ****|
     14.00 |****H*****L****|
           +^----^----^----+
            0    5    10   

&gt;&gt; ./stock_main data/stock-descending.txt 9    # prices descend
No viable buy/sell point                       # printed when trying to find a 
==STOCK DATA==                                 # buy/sell point
data_file: data/stock-descending.txt
count: 10
prices: [100.00, 90.00, 80.00, ...]
lo_index:  9
hi_index:  0
best_buy:  -1                                  # left as -1 to indicate no
best_sell: -1                                  # good time to buy/sell was found
profit:    0.00
==PLOT DATA==
start/stop:  0 10
max_height:  9
price range: 90.00
plot step:   10.00
           +----------+
     90.00 |H*        |                        # prices descend over the 
     80.00 |H**       |                        # entire period meaning NOT
     70.00 |H***      |                        # investing is the best option
     60.00 |H****     |
     50.00 |H*****    |
     40.00 |H******   |
     30.00 |H*******  |
     20.00 |H******** |
     10.00 |H********L|
           +^----^----+
            0    5    

&gt;&gt; ./stock_main data/stock-FB-08-02-216.txt 15 87 142
==STOCK DATA==                                 # plot values for Facebook's stock
data_file: data/stock-FB-08-02-216.txt        # on a day when prices were gradually
count: 543                                     # falling. Shows a slice of time from
prices: [358.94, 358.50, 358.50, ...]          # this large file which includes the
lo_index:  470                                 # best Buy/Sell time indices
hi_index:  15
best_buy:  109
best_sell: 129
profit:    2.38
==PLOT DATA==
start/stop:  87 142
max_height:  15
price range: 8.00
plot step:   0.53
           +----------------------B===================S------------+
    358.46 |                                                       |
    357.92 |**                                                     |
    357.39 |****                                                   |
    356.86 |******                                                 |
    356.32 |******* *** *                                          |
    355.79 |*************                                          |
    355.25 |*****************                                      |
    354.72 |******************                       ******   **   |
    354.19 |****************** *     *  *****      *************** |
    353.65 |********************    ************ ******************|
    353.12 |********************** ********************************|
    352.59 |*******************************************************|
    352.05 |*******************************************************|
    351.52 |*******************************************************|
    350.99 |*******************************************************|
           +---^----^----^----^----^----^----^----^----^----^----^-+
               90   95   100  105  110  115  120  125  130  135  140  
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbcaa382" class="outline-3">
<h3 id="orgbcaa382"><span class="section-number-3">4.2</span> Editing and Testing</h3>
<div class="outline-text-3" id="text-4-2">
<p>
The project code contains a skeleton version of <code>stock_funcs.c</code> which
you should fill in with definitions. With this skeleton version, you
can immediately <b>start testing your code</b> by typing <code>make test-prob1</code>.
Without changes, you will get failures for all tests as in
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; make test-prob1
gcc -Wall -Wno-comment -Werror -g  -o test_stock_funcs test_stock_funcs.c stock_funcs.o
./testy test_stock1.org 
============================================================
== test_stock1.org : Problem 1 First 3 Functions in stock_funcs.c
== Running 15 / 15 tests
1)  stock_new            : FAIL -&gt; results in file 'test-results/prob1-01-result.tmp'
2)  stock_free1          : FAIL -&gt; results in file 'test-results/prob1-02-result.tmp'
3)  stock_free2          : FAIL -&gt; results in file 'test-results/prob1-03-result.tmp'
...
============================================================
RESULTS: 0 / 15 tests passed
</pre>
</div>

<p>
However, the ability to run tests on your code an see progress is
extremely important. <b>Your first goal when starting a new project
should be to see some results or running the program</b> which is much
easier if some benevolent dictator has provided a bunch of tests.
</p>

<p>
You can also use the invocation
</p>
<pre class="example">
&gt; make test-prob1 testnum=5
</pre>

<p>
to run a single test and see its results in the
terminal. 
</p>

<p>
Failed tests generate results files which can be viewed in any text
editor or in the terminal. The <code>cat</code> command can show such results in
the terminal via <code>cat test-results/some-file.txt</code>. 
</p>

<p>
Below the results for the first test are shown and from the comparison
and Valgrind report, it appears that there is some sort of Memory
problem with the <code>stock_new()</code> function.
</p>

<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; cat test-results/prob1-01-result.tmp 

* (TEST 1) stock_new
COMMENTS:
** program: ./test_stock_funcs stock_new

** --- Failure messages --- 
- FAILURE(139) due to SIGSEGV (segmentation fault) from OS
- FAILURE: Output Mismatch at lines marked

** --- Side by Side Differences ---
- Expect output in: test-results/raw/prob1-01-expect.tmp
- Actual output in: test-results/raw/prob1-01-actual.tmp
- Differing lines have a character like '|' '&gt;' or '&lt;' in the middle
#+BEGIN_SRC sbs-diff
==== EXPECT ====                                                      ==== ACTUAL ====                                                   
{                                                                     {
    // Tests stock_new() function and whether it initializes fields       // Tests stock_new() function and whether it initializes fields
    // correctly before returning a stock.                                // correctly before returning a stock.

    stock_t *stock = stock_new(); // call function to allocate/init       stock_t *stock = stock_new(); // call function to allocate/init

    printf("stock-&gt;data_file: %p\n" , stock-&gt;data_file);                  printf("stock-&gt;data_file: %p\n" , stock-&gt;data_file);
    printf("stock-&gt;count:     %d\n" , stock-&gt;count);                      printf("stock-&gt;count:     %d\n" , stock-&gt;count);
    printf("stock-&gt;prices:    %p\n" , stock-&gt;prices);                     printf("stock-&gt;prices:    %p\n" , stock-&gt;prices);
    printf("stock-&gt;lo_index:  %d\n" , stock-&gt;lo_index);                   printf("stock-&gt;lo_index:  %d\n" , stock-&gt;lo_index);
    printf("stock-&gt;hi_index:  %d\n" , stock-&gt;hi_index);                   printf("stock-&gt;hi_index:  %d\n" , stock-&gt;hi_index);
    printf("stock-&gt;best_buy:  %d\n" , stock-&gt;best_buy);                   printf("stock-&gt;best_buy:  %d\n" , stock-&gt;best_buy);
    printf("stock-&gt;best_sell: %d\n" , stock-&gt;best_sell);                  printf("stock-&gt;best_sell: %d\n" , stock-&gt;best_sell);

    free(stock);                // de-allocate manually                   free(stock);                // de-allocate manually
}                                                                     }
stock-&gt;data_file: (nil)                                             | Segmentation Fault
stock-&gt;count:     -1                                                &lt;
stock-&gt;prices:    (nil)                                             &lt;
stock-&gt;lo_index:  -1                                                &lt;
stock-&gt;hi_index:  -1                                                &lt;
stock-&gt;best_buy:  -1                                                &lt;
stock-&gt;best_sell: -1                                                &lt;
#+END_SRC

** --- Line Differences ---
EXPECT:  17) stock-&gt;data_file: (nil)
EXPECT:  18) stock-&gt;count:     -1
EXPECT:  19) stock-&gt;prices:    (nil)
EXPECT:  20) stock-&gt;lo_index:  -1
EXPECT:  21) stock-&gt;hi_index:  -1
EXPECT:  22) stock-&gt;best_buy:  -1
EXPECT:  23) stock-&gt;best_sell: -1
ACTUAL:  17) Segmentation Fault

--- Valgrind Log from: test-results/raw/prob1-01-valgrd.tmp ---
==150464== Memcheck, a memory error detector
==150464== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==150464== Using Valgrind-3.17.0 and LibVEX; rerun with -h for copyright info
==150464== Command: ./test_stock_funcs stock_new
==150464== Parent PID: 150463
==150464== 
==150464== Invalid read of size 8
==150464==    at 0x109354: main (test_stock_funcs.c:33)
==150464==  Address 0x0 is not stack'd, malloc'd or (recently) free'd
==150464== 
==150464== 
==150464== Process terminating with default action of signal 11 (SIGSEGV): dumping core
==150464==  Access not within mapped region at address 0x0
==150464==    at 0x109354: main (test_stock_funcs.c:33)
==150464==  If you believe this happened as a result of a stack
==150464==  overflow in your program's main thread (unlikely but
==150464==  possible), you can try to increase the size of the
==150464==  main thread stack using the --main-stacksize= flag.
==150464==  The main thread stack size used in this run was 10022912.
==150464== 
==150464== HEAP SUMMARY:
==150464==     in use at exit: 0 bytes in 0 blocks
==150464==   total heap usage: 0 allocs, 0 frees, 0 bytes allocated
==150464== 
==150464== All heap blocks were freed -- no leaks are possible
==150464== 
==150464== For lists of detected and suppressed errors, rerun with: -s
==150464== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd3aa327" class="outline-3">
<h3 id="orgd3aa327"><span class="section-number-3">4.3</span> Implementation Notes</h3>
<div class="outline-text-3" id="text-4-3">
</div>
<div id="outline-container-org5aa72e0" class="outline-4">
<h4 id="org5aa72e0">Use the Arrow</h4>
<div class="outline-text-4" id="text-org5aa72e0">
<p>
The first 3 functions to implement in <code>stock_funcs.c</code> are utility
functions for stocks to allocate, de-allocate and print them. As will
be covered in lecture, C often deals with pointers to a <code>struct</code> and
that is the case in these functions. For this, the <code>sp-&gt;fld</code> syntax is
used to first dereference the <code>struct</code> pointer and access a field of
the <code>struct</code>.  For example, in <code>stock_print()</code> one could use the
following code to print the <code>count</code> field of the parameter <code>struct</code>:
</p>
<div class="org-src-container">
<pre class="src src-c">void print_stock(stock_t *stock){
  // ...
  printf("count: %d\n",  stock-&gt;count);
  //                     ^^^^^^^^^^^^
</pre>
</div>
<p>
Throughout most of this problem and the next, the Arrow syntax will be
used in most functions.
</p>
</div>
</div>
<div id="outline-container-orgf97305b" class="outline-4">
<h4 id="orgf97305b">Allocating Stocks in Heap Memory</h4>
<div class="outline-text-4" id="text-orgf97305b">
<p>
In order to get dynamically allocated memory in the Heap, the
<code>malloc()</code> function should be used. This function takes a number of
bytes and returns a <code>void *</code> pointer for that number of bytes if
available.  As will be discussed in lecture, C provides the <code>sizeof()</code>
operator to calculate the size of various intrinsic and user-defined
types. To allocate enough space for a <code>stock_t</code>, use
<code>malloc(sizeof(stock_t))</code>.  
</p>

<p>
Though <code>malloc()</code> returns a <code>void *</code>, it is typical to simply assign
it to a pointer of some other kind. For example, the following is a
typical way to allocate space for a single <code>stock_t</code> <code>struct</code> and save
the reference for later use.
</p>
<div class="org-src-container">
<pre class="src src-c">stock_t *stock = malloc(sizeof(stock_t));
</pre>
</div>

<p>
Once allocated, the Arrow syntax mentioned above, <code>stock-&gt;lo_index</code>
can be used to adjust fields.
</p>

<p>
To understand which fields are present in the <code>stock_t</code> struct, open
up the header file <code>stock.h</code> which declares the struct. There will be
a list of fields like <code>prices</code> and <code>hi_index</code>: these will all need to
receive initial values like <code>-1</code> or <code>NULL</code>. Don't alter anything in
the header as this may break tests that you'll run later.
</p>
</div>
</div>
<div id="outline-container-orge168949" class="outline-4">
<h4 id="orge168949">Avoid Freeing NULL</h4>
<div class="outline-text-4" id="text-orge168949">
<p>
While the <code>free()</code> function is used to de-allocate memory that has
been obtained via <code>malloc()</code>, it should never be called with a <code>NULL</code>
pointer.  In the <code>stock_free()</code> function, one should check the
<code>data_file</code> and <code>prices</code> fields and free them only if they are not
<code>NULL</code>. The following code demonstrates how this can be done for one
of those fields.
</p>
<div class="org-src-container">
<pre class="src src-c">void stock_free(stock_t *stock){
  // ...
  if(stock-&gt;data_file != NULL){
    free(stock-&gt;data_file);
  }
  // ...
</pre>
</div>
</div>
</div>
<div id="outline-container-orgab0e423" class="outline-4">
<h4 id="orgab0e423">Printing Prices Array</h4>
<div class="outline-text-4" id="text-orgab0e423">
<p>
During <code>stock_print()</code>, some special code will be needed to print the
<code>prices[]</code> array if it has 3 or fewer elements. As per the function
documentation, the line associated with prices will like one of the
following depending on the value for <code>count</code>:
</p>
<div class="org-src-container">
<pre class="src src-text">prices: []                         # count == 0
prices: [70.00]                    # count == 1
prices: [50.00, 90.00]             # count == 2
prices: [59.00, 45.00, 103.00]     # count == 3
prices: [10.00, 20.00, 30.00, ...] # count &gt; 3
</pre>
</div>
<p>
There are a couple tricks for producing this type of output and it may
take some care to get the output formatted correctly for all
situations.  You might try either of the following:
</p>
<ol class="org-ol">
<li>Brute force: establish 5 cases for each of the formats above with
separate <code>printf()</code> call for each.  Since the number of cases is
relatively small, this should not be unmanageable.</li>
<li>Use the <code>count==0</code> as a special case and then write a carefully
crafted loop with conditionals to handle the remaining cases.  This
can get tricky but is more flexible if for later one wants to see
the first 5 numbers instead.</li>
</ol>
<p>
Either approach is acceptable in this case.
</p>

<p>
Keep in mind that though <code>prices</code> is declared as a <code>double *prices</code>
(pointer to <code>double</code> data), it is fine to use array syntax like square
brace indexing with it. Syntax like <code>stock-&gt;prices[2]</code> will follow a
pointer to a <code>stock_t struct</code> then find the <code>prices</code> field and index
into it as an array.
</p>
</div>
</div>
</div>
<div id="outline-container-org7c08893" class="outline-3 grading 25">
<h3 id="org7c08893"><span class="section-number-3">4.4</span> Grading Criteria for Problem 1&#xa0;&#xa0;&#xa0;<span class="tag"><span class="grading">grading</span>&#xa0;<span class="25">25</span></span></h3>
<div class="outline-text-3" id="text-4-4">
<p>
The following criteria will be checked.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Weight</th>
<th scope="col" class="org-left">Criteria</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">AUTOMATED TESTS via <code>make test-prob1</code></td>
</tr>

<tr>
<td class="org-right">15</td>
<td class="org-left">Runs tests in <code>test_stock1.org</code> on the first 3 functions in <code>stock_funcs.c</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Runs all code under Valgrind to ensure that no memory errors are present.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">1 point per test passed</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">MANUAL INSPECTION</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left"><a href="https://docs.google.com/document/d/1V6W1GBcL2cgOoiIeaz5V83U3BUbfK7wqYia71i0AeXQ/">Code Style</a>: Functions adhere to <a href="https://docs.google.com/document/d/1V6W1GBcL2cgOoiIeaz5V83U3BUbfK7wqYia71i0AeXQ/">CMSC 216 C Coding Style Guide</a> which dictates</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">reasonable indentation, commenting, consistency of curly usage, etc.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><code>stock_new()</code> and <code>stock_free()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Appropriate use of <code>malloc()</code> and <code>sizeof()</code> to get heap memory</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Correct initialization of all fields to -1 or <code>NULL</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Appropriate use of the Arrow syntax for field access</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Checks for <code>data_file</code> and <code>prices</code> fields to avoid calling <code>free()</code> on a <code>NULL</code> pointer</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Appropriate use of the Arrow syntax for field access</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left"><code>stock_print()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Appropriate use of the Arrow syntax for field access</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear logic which deals with printing <code>prices[]</code> array with 3 or fewer elements specially</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear section to calculate Profit from <code>best_buy/best_sell</code> or print 0.0 if these are -1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="outline-container-orgbb2ecf5" class="outline-2">
<h2 id="orgbb2ecf5"><span class="section-number-2">5</span> <b>Problem 2</b>: Complete Stock Plot Functions</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orge145def" class="outline-3">
<h3 id="orge145def"><span class="section-number-3">5.1</span> Overview</h3>
<div class="outline-text-3" id="text-5-1">
<p>
This problem implements further functions required by the Stock
Plotting application. These functions are somewhat more complex and
utilize functions and techniques that are part of Problem 1. When this
problem is complete, all functions in <code>stock_funcs.c</code> will be working
which will allow the provided <code>stock_demo.c</code> program to be compiled
and run on the command line. These functions will then be used in the
next problem to complete <code>stock_main.c</code>.
</p>

<p>
The remainder of this section gives some notes and implementation
hints on how to handle the various functions.
</p>
</div>
</div>
<div id="outline-container-orgd24ca3a" class="outline-3">
<h3 id="orgd24ca3a"><span class="section-number-3">5.2</span> Setting Low/High Index</h3>
<div class="outline-text-3" id="text-5-2">
<div class="org-src-container">
<pre class="src src-c">void stock_set_hilo(stock_t *stock)
</pre>
</div>
<p>
This function should be implemented as a simple "scan" across the
<code>prices[]</code> array. Each step will check an element of <code>prices[]</code> and
adjust a running min/max.  Make use of similar syntax here as you used
in <code>stock_print()</code> in order to access the elements of <code>prices</code> and
subsequently set the <code>lo_index</code> and <code>hi_index</code> fields.
</p>
</div>
</div>
<div id="outline-container-orgc7da84f" class="outline-3">
<h3 id="orgc7da84f"><span class="section-number-3">5.3</span> Best Buy/Sell Index</h3>
<div class="outline-text-3" id="text-5-3">
<div class="org-src-container">
<pre class="src src-c">int stock_set_best(stock_t *stock);
</pre>
</div>

<p>
In many cases it is best to buy at a minimum price and sell at a
maximum price. This approach fails if the maximum price occurs
<b>before</b> the minimum price. The job of <code>stock_set_best()</code> is to run an
algorithm to locate the best possible buy/sell pair and set the
<code>best_buy / best_sell</code> fields of a stock. As the documentation for the
function indicates, one can use a simple "brute force" approach to
this by simply trying every buy index paired with every sell index
(which must occur later in the array than the buy index). This
approach leads to the following pattern of iteration through the
<code>prices</code> array which uses a doubly nested pair of loops.
</p>
<div class="org-src-container">
<pre class="src src-text">set best_buy and best_sell to -1
set best_profit to 0.0
for every buy index I in prices
  for every sell index J later than I in prices
    if prices[J] - prices[I] &gt; best_profit
      set best_buy,best_sell, to I,J
      set best_profit to prices[J] - prices[I]
  done
done
</pre>
</div>
<p>
Start by adapting this approach in the function and make sure it
works. Then move on to solve other problems here.
</p>

<p>
For those that want a bit more fun, revisit this function later to
implement a more efficient version of it as described in the <a href="#org05a4b03">Optional
MAKEUP CREDIT Section</a>.
</p>
</div>
</div>
<div id="outline-container-org0a39b9d" class="outline-3">
<h3 id="org0a39b9d"><span class="section-number-3">5.4</span> Stock Files</h3>
<div class="outline-text-3" id="text-5-4">
<p>
Data on stock prices over time are stored in several example files in
the <code>data/</code> directory such as <code>data/stock-ascending.txt</code> and
<code>data/stock-jagged.txt</code>. 
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; ls data/stock-*     # list all the sample stock data
data/stock-1only.txt       data/stock-empty.txt            data/stock-TSLA-08-02-216.txt
data/stock-2only.txt       data/stock-FB-08-02-216.txt    data/stock-TSLA-08-12-216.txt
data/stock-3only.txt       data/stock-GOOG-08-02-216.txt  data/stock-valley.txt
data/stock-ascending.txt   data/stock-jagged.txt
data/stock-descending.txt  data/stock-min-after-max.txt
</pre>
</div>

<p>
Each of has a simple data format which looks like the following.
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; cat data/stock-jagged.txt 
time_01 103.00
time_02 250.00
time_03 133.00
time_04 143.00
time_05 168.00
time_06 91.00
time_07 234.00
time_08 59.00
time_09 38.00
time_10 45.00
time_11 254.00
time_12 270.00
time_13 59.00
time_14 72.00
time_15 107.00
</pre>
</div>
<ul class="org-ul">
<li>Each time/price pair appears on its own line so that the number of
lines in the file is the number of time/price pairs</li>
<li>The first item on each line is a time at which a price appears: this
will be ignored.</li>
<li>The second item that appears on each line is a floating point number
which is the stock price at that time.</li>
</ul>
</div>
</div>
<div id="outline-container-orgd937aff" class="outline-3">
<h3 id="orgd937aff"><span class="section-number-3">5.5</span> Counting Lines</h3>
<div class="outline-text-3" id="text-5-5">
<p>
Since the number of lines in stock files corresponded to the number of
prices, it is useful to have a utility function to count lines in a
file which is required.
</p>
<div class="org-src-container">
<pre class="src src-c">int count_lines(char *filename)
</pre>
</div>
<p>
As the documentation for the function indicates, this function will
open the named file and count the lines in it.  This can be done most
easily via treating the file as a long array of characters and looking
for the special <code>\n</code> newline character which designates a line break.
Character comparisons are done in C like other equality comparisons
via syntax like
</p>
<div class="org-src-container">
<pre class="src src-c">if(somevar == '\n'){ ... }

if(somevar == 'X'){ ... }
</pre>
</div>

<p>
To read a single character from a file, a common approach is to use
the <code>fscanf()</code> function with the <code>%c</code> format specifier as in
</p>
<div class="org-src-container">
<pre class="src src-c">char c;
int ret = fscanf(fin, "%c", &amp;c);
</pre>
</div>

<p>
Keep in mind that the <code>fscanf()</code> function will fail to read a
character when it reaches the end of a file.  In these cases it will
return the special return value <code>EOF</code> which should be checked. A
common structure is
</p>
<div class="org-src-container">
<pre class="src src-c">int ret = fscanf(fin, ..., ...);
if(ret == EOF){
  // take action for end of file, like breaking out of a loop
  // or returning
}
else{
  // fscanf() completed normally so variables should contain 
  // new values
}
</pre>
</div>
<p>
Experiment with these elements to complete the <code>count_lines()</code>
function.
</p>

<p>
Keep in mind that <code>count_lines()</code> should fail gracefully if a file
cannot be opened. In such cases, the <code>fopen()</code> function returns
<code>NULL</code>. Make sure to check for this, print an error message as
indicated in the function documentation, and return -1 from the
function to indicate a failure has occurred.
</p>
</div>
</div>
<div id="outline-container-org232af3b" class="outline-3">
<h3 id="org232af3b"><span class="section-number-3">5.6</span> Loading Stock Files</h3>
<div class="outline-text-3" id="text-5-6">
<div class="org-src-container">
<pre class="src src-c">int stock_load(stock_t *stock, char *filename)
</pre>
</div>
<p>
This function takes an existing <code>stock</code> and fills in its <code>price</code> and
<code>count</code> fields based on the contents of the given file. An example:
</p>
<div class="org-src-container">
<pre class="src src-c">stock_t *stock = new_stock();
// all fields of stock have default values like -1 and NULL

int ret = stock_load(stock, "data/stock-ascending.txt");
// Specified data file as 10 lines so
// stock-&gt;count is now 10 
// stock-&gt;prices is an array of 10 values read from the file
// If the load failed, -1 would be returned
</pre>
</div>

<p>
Make use of the <code>count_lines()</code> function to determine how many lines
are in the stock file. This will allow you to immediately allocate
enough space for a <code>double</code> array for all of the prices in the file.
</p>

<p>
You will need to skip the first string on each line in prices files:
</p>
<div class="org-src-container">
<pre class="src src-text">time_03 133.00
time_04 143.00
|       |
|       +---&gt; Read these into prices
+---&gt; Skip these times
</pre>
</div>
<p>
An easy way to accomplish this is to use the C format modifier <code>*</code>
which reads a field but does not place it in memory anywhere. For
example:
</p>
<div class="org-src-container">
<pre class="src src-c">fscanf(fin, "%*s");
</pre>
</div>
<p>
would read a string but ignore it thus one does not have to provide a
memory address to store the string.
</p>

<p>
One requirement of <code>stock_load()</code> is to set the <code>data_file</code> field to
be a <b>copy</b> of the <code>filename</code> parameter. While this can be done
manually with <code>malloc()</code> and a loop, the <code>strdup()</code> function makes
this easy and is encouraged here. Look up documentation for it either
in the Unix man pages (type <code>man strdup</code> in a terminal) or via an
internet search.
</p>

<p>
Ensure that at the end of <code>stock_load()</code> the <code>data_file</code>, <code>prices</code>,
and <code>count</code> fields have been set according to the data from the
file. Do not modify any other fields in the stock.
</p>
</div>
</div>
<div id="outline-container-orgd4e31f4" class="outline-3">
<h3 id="orgd4e31f4"><span class="section-number-3">5.7</span> Plotting Stocks</h3>
<div class="outline-text-3" id="text-5-7">
<p>
By far the trickiest function is the stock plot function which
presents a dense set of information in a compact region. Its output
will follow the below pattern which shows output for
<code>stock-min-after-max.txt</code>.
</p>
<div class="org-src-container">
<pre class="src src-text">==PLOT DATA==                                  
start/stop:  0 15                              
max_height:  10                                
price range: 309.00
plot step:   30.90
           +--B=S----------+
    292.10 |    H   *      |
    261.20 | *  H   *      |
    230.30 | *  H   *      |
    199.40 |**  H * *      |
    168.50 |**  H** *  *  *|
    137.60 |**  H****  ****|
    106.70 |**  H****  ****|
     75.80 |** *H***** ****|
     44.90 |** *H***** ****|
     14.00 |****H*****L****|
           +^----^----^----+
            0    5    10   
</pre>
</div>
<p>
This section outlines some techniques to make implementing this
function more tractable.
</p>
</div>
<div id="outline-container-org2e9a16e" class="outline-4">
<h4 id="org2e9a16e">Plot Data</h4>
<div class="outline-text-4" id="text-org2e9a16e">
<p>
Initially, some plot data should be printed to verify that correct
values are being used for the remainder of the plotting routine.
</p>
<div class="org-src-container">
<pre class="src src-text">==PLOT DATA==                                  
start/stop:  0 15                              
max_height:  10                                
price range: 309.00
plot step:   30.90
</pre>
</div>
<p>
The first 3 numbers are parameters to <code>stock_plot()</code>. The <code>price range</code>
can be computed from looking at the stock's <code>price</code> array at
<code>hi_index</code> and <code>lo_index</code> and the <code>plot step</code> by dividing the price
range by <code>max_height</code>.
</p>
</div>
</div>
<div id="outline-container-org8f2061f" class="outline-4">
<h4 id="org8f2061f">Vertical Printing</h4>
<div class="outline-text-4" id="text-org8f2061f">
<p>
Character terminals tend to print things well horizontally so printing
the vertical bars that appear in the main body of the plot will take
some planning and effort. The general approach is encoded in the
following pseudocode.
</p>

<div class="org-src-container">
<pre class="src src-text">for h=max_height-1 down to 0 do
  thresh = h*plot_step + min_price    # make sure to use a double for thresh
  for i=start index to stop index     # note start/stop are parameters to stock_plot()
    if stock price i &gt;= thresh
      print "*"
    else
      print " "
  done
  print "\n"
done
</pre>
</div>

<p>
This approach gives the general idea, that one iterates top down and
prints a symbol for stocks with a price larger than a threshold and a
blank space for those less than. After printing a "row" of such
symbols, advance to the next line down and repeat the process with a
lower threshold.
</p>

<p>
Follow this pseudocode approach closely but note that it misses
several details.
</p>
<ol class="org-ol">
<li>The syntax needs to be converted to C code.</li>
<li>It does not print any of the left axis number labels or left axis
bar.</li>
<li>It does not print the Highest priced stock or Lowest priced stock
(at stock index <code>hi_index</code> and <code>lo_index</code> with the special symbols
<code>H</code> and <code>L</code> that should be used.</li>
</ol>
<p>
After getting the basic body of the algorithm working you can add
these elements in.
</p>

<p>
<b>NOTE:</b> Floating point computations are a bit fragile so make sure
that you follow the above code well and <b>use a <code>double</code> for
thresholds</b>. Past students who have worked on projects like this one
have sometimes failed tests if they use a <code>float</code> instead due to
imprecision and rounding errors.
</p>
</div>
</div>
<div id="outline-container-org3c7d91c" class="outline-4">
<h4 id="org3c7d91c">Left-side Axis Values and Left/Right Bars</h4>
<div class="outline-text-4" id="text-org3c7d91c">
<p>
The left side axis labels look something like
</p>
<div class="org-src-container">
<pre class="src src-text">    292.10 |
    261.20 |
    230.30 |
    199.40 |
.......... 10-char wide numeric field
</pre>
</div>
<p>
Note that the whitespace leading each of the numeric label values on
the left axis.  It is painful to try to manually print such numbers
with appropriate spacing and unnecessary as the <code>printf()</code> function
already has such facilities built in. Use an invocation like the
following
</p>
<div class="org-src-container">
<pre class="src src-c">  printf("%10.2f |", ...)
</pre>
</div>
<p>
which will print a field that is 10 characters wide and place a
floating point value aligned to right in it. The number will be
printed with 2 decimal places and be trailed by the string constant
<code>" |"</code> to set up the left axis bar.
</p>

<p>
The value to be printed is the <code>thresh</code> value described in the
previous section, the price at which a symbol is printed on the row
for prices at or above that level. After printing the left axis bar,
print out the main plot line at that threshold.
</p>

<p>
At the end of each line in the main plot body, print a <code>"|\n"</code> to get
the right axis bar and carry down to the next line.
</p>
</div>
</div>
<div id="outline-container-orgedd986f" class="outline-4">
<h4 id="orgedd986f">Top Axis Buy/Sell Markings</h4>
<div class="outline-text-4" id="text-orgedd986f">
<p>
The top axis will look like one of the following:
</p>
<div class="org-src-container">
<pre class="src src-text">...........11 spaces
           +--B====S------+  Best Buy/Sell is being plotted

           +----------B===+  Best Buy part of plot range but Sell is not in range

           +----------B===+  Best Buy part of plot range but Sell is not in range

           +====S---------+  Best Sell is being plotted but Buy is out of range

           +--------------+  Best Buy/Sell is not in range or not set
</pre>
</div>
<p>
This can be done with a loop that traverses from the <code>start</code> to <code>stop</code>
index and checks if the index is at the <code>best_buy</code> or <code>best_sell</code>
index, in between these two, or outside the range. In each case,
prints an appropriate character, one of <code>B S = -</code>. 
</p>

<p>
Note also the leading whitespace which is 10 spaces plus 1 space and a
<code>+</code> symbol.  This can be easily printed with a <code>printf()</code> invocation
like
</p>
<div class="org-src-container">
<pre class="src src-c">printf("%10s +","");
</pre>
</div>
<p>
which prints a string in a space 10 characters wide but substitutes an
empty string in that space. The 10 spaces matches the width of the
left side numeric labels.
</p>
</div>
</div>
<div id="outline-container-org61a1390" class="outline-4">
<h4 id="org61a1390">Bottom Axis Tic Marks and Numeric Indices</h4>
<div class="outline-text-4" id="text-org61a1390">
<p>
The bottom axis and axis labels will look something like one of the
following.
</p>
<div class="org-src-container">
<pre class="src src-text">...........11 spaces
           +^----^----^----^--+   Starting at 0, axis marks at indices divisible by 5
            0    5    10   15     Axis labels aligned with each tic

           +---^----^----^----+   Starting at 2, axis marks at indices divisible by 5
               5    10   15       Axis labels aligned with each tic
</pre>
</div>
<p>
The axis tic marks can be printed easily by starting the line with
spaces and a <code>+</code>, then iterating from the <code>start</code> to <code>stop</code> parameters
and printing a <code>-</code> except when the index is divisible by 5 in which
case a <code>^</code> is printed.
</p>

<p>
The numeric labels are a bit trickier. The following approach is
suggested.
</p>
<ol class="org-ol">
<li>Print 11 spaces to line up with the first bottom axis mark.</li>
<li>Create a loop variable outside of any loop as this loop variable
will be used in 2 consecutive loops.</li>
<li>Start a loop with your loop variable initialized to <code>start</code> and
increment the variable each iteration.  Terminate this loop when
the variable is evenly divisible by five (e.g. <code>var % 5 ==
   0</code>). Each iteration print a space.  This loop will "line up"
further printing at a positions divisible by 5.</li>
<li><p>
Start a second loop based on the current value of your loop
variable. Each iteration increase the variable by 5 and terminate
it after surpassing <code>stop</code>. Suggested syntax is
</p>
<div class="org-src-container">
<pre class="src src-c">   for(; var &lt; stop; var += 5){ ... }
</pre>
</div>
<p>
with the first <code>;</code> indicating there is no loop initialization so
the previous value of <code>var</code> will be used as the staring point.
</p>

<p>
Each iteration print out a numeric index using a 5-char width but
left aligned. This can be done with <code>printf("%-5d",...)</code> with the
negative sign yielding left-alignment.
</p></li>
</ol>

<p>
It may take a bit of work to get the formatting correct but this will
be good practice to acquaint you with formatted output. 
</p>

<p>
Don't forget you can <b>run <code>stockplot_main</code> to observe its output</b>
while working to get the right format: many forget this while
attempting to only use the test cases.
</p>
</div>
</div>
</div>
<div id="outline-container-orgfebc42f" class="outline-3 grading 35">
<h3 id="orgfebc42f"><span class="section-number-3">5.8</span> Grading Criteria for Problem 2&#xa0;&#xa0;&#xa0;<span class="tag"><span class="grading">grading</span>&#xa0;<span class="35">35</span></span></h3>
<div class="outline-text-3" id="text-5-8">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Weight</th>
<th scope="col" class="org-left">Criteria</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">AUTOMATED TESTS via <code>make test-prob2</code></td>
</tr>

<tr>
<td class="org-right">20</td>
<td class="org-left">Runs the tests provided in <code>test_stock2.org</code> for last functions in <code>stock_funcs.c, stock_demo.c</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Runs all code under Valgrind to ensure that no memory errors are present.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">1 point per test passed</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">MANUAL INSPECTION</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left"><a href="https://docs.google.com/document/d/1V6W1GBcL2cgOoiIeaz5V83U3BUbfK7wqYia71i0AeXQ/">Code Style</a>: Functions adhere to <a href="https://docs.google.com/document/d/1V6W1GBcL2cgOoiIeaz5V83U3BUbfK7wqYia71i0AeXQ/">CMSC 216 C Coding Style Guide</a> which dictates</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">reasonable indentation, commenting, consistency of curly usage, etc.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><code>stock_set_hilo()</code> and <code>stock_set_best()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear loop to scan through the <code>prices</code> array to find the low/high and best buy/sell</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Proper changes to the fields <code>lo_index / hi_index / best_buy / best_sell</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left"><code>stock_load()</code> and <code>count_lines()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of <code>fopen()</code> and <code>fscanf()</code> to read in data from the file</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Code to gracefully handle failure to open a file and print appropriate messages.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Proper use of <code>count_lines()</code> to determine the number of lines in the data file</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of <code>malloc()</code> to allocate memory for the prices array</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of the <code>"%*s"</code> format specifier to skip leading "time" string in files</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Duplication of the filename to the <code>data_file</code> field likely using the <code>strdup()</code> function</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left"><code>stock_plot()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear section that calculates the "plot step" with appropriate variables like range</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Code to print out the initial plot information and loop to print the upper axis "bar"</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear loop that prints out bars with height proportional to the price of the stock</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Section of conditional code which prints if stock is low/high and best buy/sell</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear section dealing with lower axis ticks and labels.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="outline-container-orge29e805" class="outline-2">
<h2 id="orge29e805"><span class="section-number-2">6</span> <b>Problem 3</b>: Main Stock Application</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-orgdcbdc40" class="outline-3">
<h3 id="orgdcbdc40"><span class="section-number-3">6.1</span> main() Command Line Args</h3>
<div class="outline-text-3" id="text-6-1">
<p>
The final steps to complete the application are to create a <code>main()</code>
function that combines the previously completed functions to load
stock data and plot it. There are examples of how this main
application should run that appear earlier in the <a href="#orga4111a4">Overview Section</a>
which are worth inspecting. Briefly, the syntax to run the main
function is as follows which features 2, 3, or 4 command line
arguments. 
</p>
<div class="org-src-container">
<pre class="src src-sh"># 2 required command line arguments, otherwise print a usage message
&gt;&gt; ./stock_main
usage: ./stock_main &lt;stockfile&gt; &lt;max_height&gt; [start] [stop]

# arg1: stock file,  arg2: maxiumum height
&gt;&gt; ./stock_main data/stock-jagged.txt 20
...

# arg3 preset: start index to print (inclusive) 
# arg4 missing: no stop index given 
# print from prices[6] to the end of the array
&gt;&gt; ./stock_main data/stock-jagged.txt 20 6
...

# arg3 preset: start index to print (inclusive) 
# arg4 present: stop index (exclusive)
# print from prices[3] to prices[7]
&gt;&gt; ./stock_main data/stock-jagged.txt 20 3 8
...
</pre>
</div>

<p>
Most C program <code>main()</code> functions have the following prototype
(return value and argument types):
</p>
<div class="org-src-container">
<pre class="src src-c">int main(int argc, char *argv[])
</pre>
</div>
<ul class="org-ul">
<li><code>argc</code> is the number of items that appear on a command line</li>
<li><code>argv[]</code> is an array of strings which are those command line
arguments</li>
</ul>

<p>
Using a condition and/or loop like the following, you can print out
all command line arguments
</p>
<div class="org-src-container">
<pre class="src src-c">int main(int argc, char *argv[]){
  if(argc &gt; 2){
    printf("passed at least 2 arguments\n");
  }
  for(int i=0; i&lt;argc; i++){
    printf("argv[%d]: %s\n",argv[i]);
  }
  ...
</pre>
</div>
<p>
Running a program with that loop at the top would print something like
the following:
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; ./a.out
argv[0]: a.out

&gt;&gt; ./a.out stuff.txt
argv[0]: a.out
argv[1]: stuff.txt

&gt;&gt; ./a.out one 2 three
passed at least 2 arguments
argv[0]: a.out
argv[1]: one
argv[2]: 2
argv[3]: three
</pre>
</div>

<p>
Note that all of the arguments are strings so if you want binary
number versions of them, you'll need to use a conversion function.
</p>
</div>
</div>
<div id="outline-container-org2f6b0e5" class="outline-3">
<h3 id="org2f6b0e5"><span class="section-number-3">6.2</span> Implementation of main()</h3>
<div class="outline-text-3" id="text-6-2">
<p>
Create the file <code>stock_main.c</code> and write your <code>main()</code> function in
it. <b>Do not write a <code>main()</code> in <code>stock_funcs.c</code> as this will cause
testing files to fail to compile.</b> C programs can have only one
<code>main()</code> function and the testing setup already has a <code>main()</code> that is
used to interrogate the service functions. It is customary to have a
<code>main()</code> in a separate file so that multiple programs can use the same
set of service functions.
</p>

<p>
Here are few notes on how to complete <code>main()</code> function in
<code>stock_main.c</code>.
</p>
<ul class="org-ul">
<li><b>Use the functions you have completed previously</b> for most of the
functionality that <code>main()</code> should perform.</li>
<li>Examine how to convert a string to a binary integer using the
<code>atoi()</code> function. There is an example of this given in a PROVIDED
section of <code>main()</code>.</li>
<li>It may be helpful to review a <code>main()</code> function that is similar to
what you wish to accomplish. Good options are the <code>main()</code> provided
in <code>stock_demo.c</code> OR the <code>main()</code> in a recent lab like the "treasure
maps" exercise.</li>
<li><b>Avoid repeating common code in conditionals.</b> Load the stock file
in only one line of code, not in multiple conditional cases. While
it can be easy to handle the cases of 3, 4, 5, etc. command line
arguments in an if/else if and copy paste code between them, this
runs against the "DRY" principle ("Don't Repeat Yourself") that
should guide most programming.  Make your code compact with the
smallest amount of copy/pasted lines you can muster.</li>
</ul>

<p>
Below is a quick demo of how the behavior of <code>main()</code> should work on
the command line.
</p>
<div class="org-src-container">
<pre class="src src-sh"># omit command line arguements to show usage
&gt;&gt; ./stock_main
usage: ./stock_main &lt;stockfile&gt; &lt;max_height&gt; [start] [stop]

# plot all prices at height 10
&gt;&gt; ./stock_main data/stock-jagged.txt 10
==STOCK DATA==
data_file: data/stock-jagged.txt
count: 15
prices: [103.00, 250.00, 133.00, ...]
lo_index:  8
hi_index:  11
best_buy:  8
best_sell: 11
profit:    232.00
==PLOT DATA==
start/stop:  0 15
max_height:  10
price range: 232.00
plot step:   23.20
           +--------B==S---+
    246.80 | *        *H   |
    223.60 | *    *   *H   |
    200.40 | *    *   *H   |
    177.20 | *    *   *H   |
    154.00 | *  * *   *H   |
    130.80 | **** *   *H   |
    107.60 | **** *   *H   |
     84.40 |*******   *H  *|
     61.20 |*******   *H **|
     38.00 |********L**H***|
           +^----^----^----+
            0    5    10   

# plot all prices at height 5
&gt;&gt; ./stock_main data/stock-jagged.txt 5
==STOCK DATA==
data_file: data/stock-jagged.txt
count: 15
prices: [103.00, 250.00, 133.00, ...]
lo_index:  8
hi_index:  11
best_buy:  8
best_sell: 11
profit:    232.00
==PLOT DATA==
start/stop:  0 15
max_height:  5
price range: 232.00
plot step:   46.40
           +--------B==S---+
    223.60 | *    *   *H   |
    177.20 | *    *   *H   |
    130.80 | **** *   *H   |
     84.40 |*******   *H  *|
     38.00 |********L**H***|
           +^----^----^----+
            0    5    10   

# plot a specific range of prices, times 20 to 50
&gt;&gt; ./stock_main data/stock-GOOG-08-02-2021.txt 10 20 50
==STOCK DATA==
data_file: data/stock-GOOG-08-02-2021.txt
count: 345
prices: [2715.00, 2715.00, 2711.00, ...]
lo_index:  24
hi_index:  337
best_buy:  24
best_sell: 337
profit:    25.75
==PLOT DATA==
start/stop:  20 50
max_height:  10
price range: 25.75
plot step:   2.58
           +----B=========================+
   2717.22 |                              |
   2714.64 |                              |
   2712.07 |                              |
   2709.49 |                              |
   2706.91 |                            **|
   2704.34 |                           ***|
   2701.76 |                *      *******|
   2699.19 |       *     ******   ********|
   2696.61 |****   ************ **********|
   2694.04 |****L*************************|
           +^----^----^----^----^----^----+
            20   25   30   35   40   45   

# plot from a large index to the end of the stock prices
&gt;&gt; ./stock_main data/stock-GOOG-08-02-2021.txt 10 290
==STOCK DATA==
data_file: data/stock-GOOG-08-02-2021.txt
count: 345
prices: [2715.00, 2715.00, 2711.00, ...]
lo_index:  24
hi_index:  337
best_buy:  24
best_sell: 337
profit:    25.75
==PLOT DATA==
start/stop:  290 345
max_height:  10
price range: 25.75
plot step:   2.58
           +===============================================S-------+
   2717.22 |                                             **H*******|
   2714.64 |                                           ****H*******|
   2712.07 |** ********                  *      * *   *****H*******|
   2709.49 |***************************************** *****H*******|
   2706.91 |***********************************************H*******|
   2704.34 |***********************************************H*******|
   2701.76 |***********************************************H*******|
   2699.19 |***********************************************H*******|
   2696.61 |***********************************************H*******|
   2694.04 |***********************************************H*******|
           +^----^----^----^----^----^----^----^----^----^----^----+
            290  295  300  305  310  315  320  325  330  335  340  

# show tricky case where the low/high stock points are not the best
# buy/sell times
&gt;&gt; ./stock_main data/stock-min-after-max.txt 10
==STOCK DATA==
data_file: data/stock-min-after-max.txt
count: 15
prices: [223.00, 292.00, 27.00, ...]
lo_index:  10
hi_index:  4
best_buy:  2
best_sell: 4
profit:    296.00
==PLOT DATA==
start/stop:  0 15
max_height:  10
price range: 309.00
plot step:   30.90
           +--B=S----------+
    292.10 |    H   *      |
    261.20 | *  H   *      |
    230.30 | *  H   *      |
    199.40 |**  H * *      |
    168.50 |**  H** *  *  *|
    137.60 |**  H****  ****|
    106.70 |**  H****  ****|
     75.80 |** *H***** ****|
     44.90 |** *H***** ****|
     14.00 |****H*****L****|
           +^----^----^----+
            0    5    10   

# attempt to load a missing file
&gt;&gt; ./stock_main data/stock-no-such-file.txt 15
Could not open file 'data/stock-no-such-file.txt', cannot count lines
Unable to open stock file 'data/stock-no-such-file.txt', cannot load stock data
Failed to load stock file, exiting

# too few command line args
&gt;&gt; ./stock_main data/stock-jagged.txt 
usage: ./stock_main &lt;stockfile&gt; &lt;max_height&gt; [start] [stop]

# too many command line args
&gt;&gt; ./stock_main data/stock-jagged.txt 15 100 200 500 900
usage: ./stock_main &lt;stockfile&gt; &lt;max_height&gt; [start] [stop]

</pre>
</div>



<p>
Once you have completed the main function, you can test it via <code>make test-prob3</code>.
</p>

<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; make
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -c stock_main.c
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -c stock_funcs.c
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -o stock_main stock_main.o stock_funcs.o
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -c stock_demo.c
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -o stock_demo stock_demo.o stock_funcs.o
gcc -Wall -Wno-comment -Werror -g -Wno-unused-variable -o test_stock_funcs test_stock_funcs.c stock_funcs.o
&gt;&gt; make test-prob3
./testy test_stock3.org 
============================================================
== test_stock3.org : Problem 3 stock_main
== Running 10 / 10 tests
1)  stock_main data/stock-ascending.txt all      : ok
2)  stock_main fail to open                      : ok
3)  stock_main data/stock-ascending.txt 5 to 10  : ok
4)  stock_main data/stock-ascending.txt 5 to End : ok
5)  stock_main data/stock-min-after-max.txt      : ok
6)  stock_main Facebook Stock 5 to 43            : ok
7)  stock_main Facebook Stock 100 to 140         : ok
8)  stock_main Facebook Stock 152 to 203         : ok
9)  stock_main Facebook Stock 500 to End         : ok
10) stock_main Google Stock                      : ok
============================================================
RESULTS: 10 / 10 tests passed
</pre>
</div>
</div>
</div>
<div id="outline-container-org3002d2a" class="outline-3 grading 20">
<h3 id="org3002d2a"><span class="section-number-3">6.3</span> Grading Criteria for Problem 3&#xa0;&#xa0;&#xa0;<span class="tag"><span class="grading">grading</span>&#xa0;<span class="20">20</span></span></h3>
<div class="outline-text-3" id="text-6-3">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Weight</th>
<th scope="col" class="org-left">Criteria</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">AUTOMATED TESTS via <code>make test-prob3</code></td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-left">Runs the tests provided in <code>test_stock3.org</code> for <code>stock_main.c</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Runs all code under Valgrind to ensure that no memory errors are present.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">1 point per test passed</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">MANUAL INSPECTION</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left"><a href="https://docs.google.com/document/d/1V6W1GBcL2cgOoiIeaz5V83U3BUbfK7wqYia71i0AeXQ/">Code Style</a>: Functions adhere to <a href="https://docs.google.com/document/d/1V6W1GBcL2cgOoiIeaz5V83U3BUbfK7wqYia71i0AeXQ/">CMSC 216 C Coding Style Guide</a> which dictates</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">reasonable indentation, commenting, consistency of curly usage, etc.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">Correct use of a previously written functions for memory allocation, loading, setting stock properties, and plotting</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">Logically handles command line arguments including appropriate behavior for different invocations</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Avoids too much duplicate code while handling command line arguments</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Avoids repeated code for common actions like loading the stock file; loads only appear in one spot, not several conditions</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Uses of an appropriate library function to convert from strings to integers for numeric arguments</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="outline-container-org5089917" class="outline-2">
<h2 id="org5089917"><span class="section-number-2">7</span> <b>Problem 4</b>: Multi-stock Plotting</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org79c3ffa" class="outline-3">
<h3 id="org79c3ffa"><span class="section-number-3">7.1</span> Rationale</h3>
<div class="outline-text-3" id="text-7-1">
<p>
It is useful when analyzing data (including stocks) to plot relevant
data together in the same chart for purpose of comparison. This
problem extends the plot application to enable this. It develops
several additional service functions that enable loading of multiple
stock files and an alternate <code>main()</code> application that plots multiple
stocks. 
</p>

<p>
<b>NOTE</b>: Unlike with previous problems, there are no "unit tests" for
the individual functions. Only tests for the resulting <code>main()</code>
function are present. This means implementers will need to build most
of the functionality together and check the overall results of tests
OR alternatively develop their own tests.  While debugging, it will be
essential to practice isolating bugs to individual functions through
inspection of results and possibly use of a debugger.
</p>

<p>
Below is example output for how the multi-plotting application looks.
</p>

<div class="org-src-container">
<pre class="src src-text">&gt;&gt; stock_multimain 20 data/stock-daily12-googl_us_d.txt data/stock-daily8-aapl_us_d.txt data/stock-daily10-nvda_us_d.txt data/stock-daily4-adbe_us_d.txt data/stock-daily10-tsla_us_d.txt 

==MULTIPLOT DATA==
max_height:  20
stop_count:  12
min price:   174.98
max price:   354.85
price range: 179.87
plot step:   8.99
==LEGEND==
a : data/stock-daily12-googl_us_d.txt
b : data/stock-daily8-aapl_us_d.txt
c : data/stock-daily10-nvda_us_d.txt
d : data/stock-daily4-adbe_us_d.txt
e : data/stock-daily10-tsla_us_d.txt

           +------------------------------------------------------------+
    345.86 |        d    d    D                              E          |
    336.86 |   De   de   d    D                         e    E          |
    327.87 |   De   de   de   De    e    e              e    E          |
    318.88 |   De   de   de   De    e    e    e    E    e    E          |
    309.88 |   De   de   de   De    e    e    e    E    e    E          |
    300.89 |   De   de   de   De    e    e    e    E    e    E          |
    291.90 |   De   de   de   De    e    e    e    E    e    E          |
    282.90 |   De   de   de   De    e    e    e    E    e    E          |
    273.91 |   De   de   de   De    e    e    e    E    e    E          |
    264.91 |   De   de   de   De    e    e    e    E    e    E          |
    255.92 |   De   de   de   De    e    e    e    E    e    E          |
    246.93 |   De   de   de   De    e    e    e    E    e    E          |
    237.93 |   De   de   de   De    e    e    e    E    e    E          |
    228.94 | b De B de b de b De b  e b  e    e    E    e    E          |
    219.95 | b De B de b de b De b  e b  e b  e B  E    e    E          |
    210.95 | b De B de b de b De b  e b  e b  e B  E    e    E          |
    201.96 |ab De B deab deab Deab  e b  e b  e B  Ea   eA   Ea    a    |
    192.97 |ab DeaB deab deab Deab  eab  eAb  eaB  Ea   eA   Ea    a    |
    183.97 |ab DeaB deab deab Deab  eab  eAb  eaB  Ea   eA   Ea    a    |
    174.98 |abCDeaBcdeabcdeabcDeabc eabc eAbc eaBC Ea c eA c Ea    a    |
           +^------------------------^------------------------^---------+
            0                        5                        10                       

</pre>
</div>
</div>
</div>
<div id="outline-container-orgbc8af0b" class="outline-3">
<h3 id="orgbc8af0b"><span class="section-number-3">7.2</span> Additional Required Service Functions</h3>
<div class="outline-text-3" id="text-7-2">
<p>
There are two additional functions the are required to support
plotting multiple stocks. These are described in the preceding outline
of all required functions and are repeated briefly here.
</p>
<div class="org-src-container">
<pre class="src src-c">stock_t **stock_load_all(char *filenames[], int stock_count)
// PROBLEM 4: Loads all files named in `filenames[]` as stocks and
// returns an array of pointers to those stocks.

void stock_multiplot(stock_t **stocks, int stocks_count, int max_height);
// PROBLEM 4: Plot all of the stocks in the `stocks` array which is
// `stocks_count` elements long. 
</pre>
</div>

<p>
Both these functions deal with the C data type <code>stock **</code>. This is a
double indirection (two-layered pointers) of stocks but is best
thought of as "an array of stock pointers". Syntax like <code>stocks[i]</code>
will peel off one layer of pointers giving a single pointer <code>stock_t
*</code> to a stock. The syntax <code>stocks[i]-&gt;count</code> accesses one field of the
stocks referenced in this function. The array of stock pointers must
be allocated in <code>stock_load_all()</code> along with the stocks pointed at by
constituent pointers. <code>stock_multiplot()</code> uses this array of stocks in
its plotting. Later in a <code>main()</code> function the array of stocks must be
de-allocated.
</p>

<p>
<code>stock_load_all()</code> should make use of previously written functions
allocate and load stock data from files. This should lead to a short
function (around 20 lines of code).
</p>

<p>
It is recommended that implementations of <code>stock_multiplot()</code> start
by copying the implementation of <code>stock_plot()</code> and then make
adjustments to adapt to the multiple stock setting.
</p>

<p>
Examples of how <code>stock_multiplot()</code> shows its output are below.
</p>
</div>
</div>
<div id="outline-container-org62c785e" class="outline-3">
<h3 id="org62c785e"><span class="section-number-3">7.3</span> Additional Main Application</h3>
<div class="outline-text-3" id="text-7-3">
<p>
The file <code>stock_multimain.c</code> will contain another <code>main()</code> function
that prints multiple stocks from the command line. The command line
formats supported are different form <code>stock_main.c</code> and support an
arbitrary number of stock files that may be displayed but no
start/stop indices. Some Examples are below.
</p>

<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; ./stock_multimain
usage: ./stock_multimain &lt;max_height&gt; &lt;stockfile1&gt; [stockfile2] [...]

&gt;&gt; ./stock_multimain 10 data/stock-jagged.txt 
==MULTIPLOT DATA==
max_height:  10
stop_count:  15
min price:   38.00
max price:   270.00
price range: 232.00
plot step:   23.20
==LEGEND==
a : data/stock-jagged.txt

           +---------------+
    246.80 | a        aA   |
    223.60 | a    a   aA   |
    200.40 | a    a   aA   |
    177.20 | a    a   aA   |
    154.00 | a  a a   aA   |
    130.80 | aaaa a   aA   |
    107.60 | aaaa a   aA   |
     84.40 |aaaaaaa   aA  a|
     61.20 |aaaaaaa   aA aa|
     38.00 |aaaaaaaaAaaAaaa|
           +^----^----^----+
            0    5    10   

&gt;&gt; ./stock_multimain 10 data/stock-jagged.txt data/stock-valley.txt 
==MULTIPLOT DATA==
max_height:  10
stop_count:  15
min price:   38.00
max price:   270.00
price range: 232.00
plot step:   23.20
==LEGEND==
a : data/stock-jagged.txt
b : data/stock-valley.txt

           +------------------------------+
    246.80 |  a                 a A       |
    223.60 |  a         a       a A       |
    200.40 |  a         a       a A       |
    177.20 |  a         a       a A       |
    154.00 |  a     a   a       a A       |
    130.80 |  a a a a   a       a A       |
    107.60 |  a a a a   a       a A       |
     84.40 |ababa a a a a      babAB    a |
     61.20 |ababababa a a  b b babAB  a a |
     38.00 |abababababaBababAbababABa a a |
           +^---------^---------^---------+
            0         5         10        

&gt;&gt; ./stock_multimain 5 data/stock-3only.txt data/stock-2only.txt 
==MULTIPLOT DATA==
max_height:  5
stop_count:  3
min price:   45.26
max price:   103.07
price range: 57.81
plot step:   11.56
==LEGEND==
a : data/stock-3only.txt
b : data/stock-2only.txt

           +------+
     91.51 |A     |
     79.95 |A  B  |
     68.38 |A  B  |
     56.82 |A  Ba |
     45.26 |ABABa |
           +^-----+
            0         

&gt;&gt; ./stock_multimain 10 data/stock-jagged.txt data/stock-valley.txt data/stock-min-after-max.txt 
==MULTIPLOT DATA==
max_height:  10
stop_count:  15
min price:   14.00
max price:   323.00
price range: 309.00
plot step:   30.90
==LEGEND==
a : data/stock-jagged.txt
b : data/stock-valley.txt
c : data/stock-min-after-max.txt

           +---------------------------------------------+
    292.10 |              C           c                  |
    261.20 |     c        C           c      A           |
    230.30 |   a c        C   a       c   a  A           |
    199.40 |  ca c        C   a c     c   a  A           |
    168.50 |  ca c        C  ca c     c   a  A c        c|
    137.60 |  ca c   a  a C  ca c  c  c   a  A c  c  c  c|
    106.70 |  ca ca  a  a C  ca c  c  c   a  A c  c  ca c|
     75.80 |abcabcab a ca Ca ca c  c  c bcab ABc  c  ca c|
     44.90 |abcabcab abcabCaBcabcabc bcabcab ABca ca ca c|
     14.00 |abcabcabcabcabCaBcabcabcAbcabcabCABca ca ca c|
           +^--------------^--------------^--------------+
            0              5              10             

&gt;&gt; ./stock_multimain 20 data/stock-daily12-aapl_us_d.txt data/stock-daily10-nvda_us_d.txt data/stock-daily6-tsla_us_d.txt data/stock-daily8-googl_us_d.txt 
==MULTIPLOT DATA==
max_height:  20
stop_count:  12
min price:   174.98
max price:   340.84
price range: 165.86
plot step:   8.29
==LEGEND==
a : data/stock-daily12-aapl_us_d.txt
b : data/stock-daily10-nvda_us_d.txt
c : data/stock-daily6-tsla_us_d.txt
d : data/stock-daily8-googl_us_d.txt

           +------------------------------------------------+
    332.55 |  C   c   c       c                             |
    324.25 |  C   c   c   c   c   C                         |
    315.96 |  C   c   c   c   c   C                         |
    307.67 |  C   c   c   c   c   C                         |
    299.38 |  C   c   c   c   c   C                         |
    291.08 |  C   c   c   c   c   C                         |
    282.79 |  C   c   c   c   c   C                         |
    274.50 |  C   c   c   c   c   C                         |
    266.20 |  C   c   c   c   c   C                         |
    257.91 |  C   c   c   c   c   C                         |
    249.62 |  C   c   c   c   c   C                         |
    241.32 |  C   c   c   c   c   C                         |
    233.03 |  C A c   c   c   c   C                         |
    224.74 |a C A c a c a c a c a C a   A   a   a   a   a   |
    216.44 |a C A c a c a c a c a C a   A   a   a   a   a   |
    208.15 |a C A c a c a c a c a C a   A   a   a   a   a   |
    199.86 |a CdA cda cda cDa cda Cda   A   a   a   a   a   |
    191.57 |a CdA cda cda cDa cda Cda  DA  da   a   a   a   |
    183.27 |a CdA cda cda cDa cda Cda  DA  da   a   a   a   |
    174.98 |aBCdAbcdabcdabcDabcdabCdab DAB dab  ab  a   a   |
           +^-------------------^-------------------^-------+
            0                   5                   10                  
</pre>
</div>
</div>
</div>
<div id="outline-container-org1a903fd" class="outline-3 grading 20">
<h3 id="org1a903fd"><span class="section-number-3">7.4</span> Grading Criteria for Problem 4&#xa0;&#xa0;&#xa0;<span class="tag"><span class="grading">grading</span>&#xa0;<span class="20">20</span></span></h3>
<div class="outline-text-3" id="text-7-4">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Weight</th>
<th scope="col" class="org-left">Criteria</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">AUTOMATED TESTS via <code>make test-prob4</code></td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-left">Runs the tests provided in <code>test_stock4.org</code> for <code>stock_multimain.c</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Runs all code under Valgrind to ensure that no memory errors are present.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">1 point per test passed</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">MANUAL INSPECTION</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left"><a href="https://docs.google.com/document/d/1V6W1GBcL2cgOoiIeaz5V83U3BUbfK7wqYia71i0AeXQ/">Code Style</a>: Functions adhere to <a href="https://docs.google.com/document/d/1V6W1GBcL2cgOoiIeaz5V83U3BUbfK7wqYia71i0AeXQ/">CMSC 216 C Coding Style Guide</a> which dictates</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">reasonable indentation, commenting, consistency of curly usage, etc.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><code>stock_load_all()</code> in <code>stock_funcs.c</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Correct memory allocation for an array of pointers to stocks</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of previously defined functions to create and load data for stock files</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear error checking so that if any load fails, all memory is de-allocated before returning.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left"><code>stock_multiplot()</code> in <code>stock_funcs.c</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Code structure similar to the previous <code>stock_plot()</code> function</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear loops ahead near the beginning to determine data ranges for prices</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left"><b>COMMENTS indicating the intent of loops and conditions</b> amid this complex function</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Concise code for printing axis marks and labels</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left"><code>main()</code> in <code>stock_multimain.c</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of previously defined functions for loading stocks, finding their price ranges, and plotting</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear memory de-allocation of data allocated in other functions and passed to <code>main()</code></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="outline-container-org8eb8479" class="outline-2">
<h2 id="org8eb8479"><span class="section-number-2">8</span> <a id="org05a4b03"></a> OPTIONAL Makeup Credit</h2>
<div class="outline-text-2" id="text-8">
<p>
The "brute force" approach initially suggested to find <code>best_buy /
best_sell</code> indices compares all possible buy/sell pairs to determine
the best profit possible. This is a Quadratic algorithm with
complexity <code>O(N^2)</code> with <code>N</code> being the length of the <code>prices[]</code> array.
</p>

<p>
One can improve upon this algorithm to get an <code>O(N)</code> linear
algorithm. This takes some cleverness or some research. For example,
the problem is directly related to the Maximum Subarray Problem and
its various solutions among which the Linear time algorithm is
sometimes referred to as Kadane's approach. Some possible references
are here:
</p>
<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/Maximum_subarray_problem">https://en.wikipedia.org/wiki/Maximum_subarray_problem</a></li>
<li><a href="https://cs.gmu.edu/~kauffman/cs310/01-intro.pdf">https://cs.gmu.edu/~kauffman/cs310/01-intro.pdf</a></li>
<li><a href="https://www.techiedelight.com/maximum-subarray-problem-kadanes-algorithm/">https://www.techiedelight.com/maximum-subarray-problem-kadanes-algorithm/</a></li>
</ul>

<p>
Note that adapting these approaches to the current setting will
require some care: the Maximum Subarray problem assumes elements in
the array are added together whereas in our Stock setting, it is the
difference between elements that matter. However, by absorbing the
tricks used the Linear time Maximum Subarray algorithm, one can get
the same effect for the Stocks, an <code>O(N)</code> algorithm to set <code>best_buy /
best_sell</code>.
</p>

<p>
For up to 10 points of PROJECT MAKEUP CREDIT implement the following
alternate function.
</p>
<div class="org-src-container">
<pre class="src src-c">int stock_set_best_linear(stock_t *stock);
// OPTIONAL MAKEUP CREDIT: Identical to stock_set_best() except uses a
// linear time algorithm to determine the best buy/sell times
</pre>
</div>
<ul class="org-ul">
<li>The normal <code>stock_set_best()</code> function MUST be present with
Quadratic complexity (or worse)</li>
<li>The linear time version must also be present</li>
<li>The linear time version MUST be used in <code>main()</code> and pass test cases
associated with running the whole program.</li>
</ul>

<p>
MAKEUP CREDIT will go into the general pool of points earned for
projects to make up for points missed on projects elsewhere. If a
student scores 110/100 on Project 1 and 90 / 100 on Project 2, the 10
points from Project 1 will make up for the credit lost on Project 2.
Your total score on All Projects cannot exceed 100% so any points
beyond the overall total will simply be dropped.
</p>
</div>
<div id="outline-container-orgb90017a" class="outline-4 grading 10">
<h4 id="orgb90017a">Grading Criteria for MAKEUP CREDIT&#xa0;&#xa0;&#xa0;<span class="tag"><span class="grading">grading</span>&#xa0;<span class="10">10</span></span></h4>
<div class="outline-text-4" id="text-orgb90017a">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Weight</th>
<th scope="col" class="org-left">Criteria</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">10</td>
<td class="org-left">TOTAL OPTIONAL MAKEUP CREDIT</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Implements the normal <code>stock_set_best()</code> which uses a quadratic or slower algorithm</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">ALSO Implements a <code>stock_set_best_linear()</code> which uses a linear time algorithm.</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left">Manual verification by graders that the linear algorithm looks correct runs in linear time on the size of the stock prices.</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left">Uses <code>stock_set_best_linear()</code> in <code>stock_main()</code> and passes all associated the main function test cases.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="outline-container-orgdfa094f" class="outline-2">
<h2 id="orgdfa094f"><span class="section-number-2">9</span> Project Submission</h2>
<div class="outline-text-2" id="text-9">
</div>
<div id="outline-container-org847e8c9" class="outline-3">
<h3 id="org847e8c9"><span class="section-number-3">9.1</span> <a id="orge5358cc"></a> Submit to Gradescope</h3>
<div class="outline-text-3" id="text-9-1">
<p>
Submission is identical to lab work. There are two options to submit
to Gradescope.
</p>

<ol class="org-ol">
<li><p>
In a terminal, run the command
</p>
<div class="org-src-container">
<pre class="src src-sh">   &gt;&gt; make submit
</pre>
</div>
<p>
and punch in your email/password on Gradescope to use the provided
<code>gradescope-submit</code> script to upload your work. This is more
convenient so is recommended.
</p></li>
<li>Run the command <code>make zip</code> to create <code>p1-complete.zip</code>, download
this file and upload it to Gradescope through a web browser. This
is a good fallback if you are having trouble with command line
submission.</li>
</ol>

<p>
Refer to <a href="lab01.html#submission">Lab01 Submission Instructions</a> if you need a refresher on
submitting. 
</p>
</div>
</div>
<div id="outline-container-org00454f5" class="outline-3">
<h3 id="org00454f5"><span class="section-number-3">9.2</span> Late Policies</h3>
<div class="outline-text-3" id="text-9-2">
<p>
You may wish to review the policy on late project submission which
will cost 1 Engagement Point per day late. <b>No projects will be
accepted more than 48 hours after the deadline.</b>
</p>

<p>
<a href="https://kauffman77.github.io/216/syllabus.html">https://kauffman77.github.io/216/syllabus.html</a>
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr/> <i> <a href="https://www.umd.edu/web-accessibility" title="UMD Web Accessibility">Web Accessibility</a> <br/> Author: Chris Kauffman (<a href="mailto:profk@umd.edu">profk@umd.edu</a>) <br/> Date: 2025-09-21 Sun 15:40 <br/> </i>
</div>
</body>
</html>
