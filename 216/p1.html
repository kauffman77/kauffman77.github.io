<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2024-09-11 Wed 14:37 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CMSC216 Project 1: C Programming</title>
<meta name="author" content="Chris Kauffman" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<meta name="viewport" content="width=device-width, maximum-scale=1, minimum-scale=1" />
<style type="text/css">
@media screen {
:root {
--heading-bg-color:#e21833;
--heading-fg-color:#ffd200;
}
html {
font-family: serif;
text-align: justify;
}
pre.src, pre.example {
overflow-x: scroll;
}
/* Merge subtitle area with title area */
.subtitle {
text-align: center;
margin-top: -2em;
padding-top: 1em;
padding-bottom: 0.1em;
}
.title, .subtitle {
color: var(--heading-fg-color);
background-color: var(--heading-bg-color);
}
/* Section borders, left section header style */
div.outline-2, #table-of-contents {
background-color: rgb(250,250,250);
border: 0.75em solid var(--heading-bg-color);
border-top: 0em;
padding: 0em .5em .5em .5em; /* top right bottom left */
margin: 1em 0em 1em 0em; /* top right bottom left */
}
div.outline-2 > h2, #table-of-contents > h2 {
background-color: var(--heading-bg-color);
color: var(--heading-fg-color);
font-variant: small-caps;
padding: 0em 0em 0em .5em; /* top right bottom left */
margin: 0em -.5em 0em -.75em; /* top right bottom left */
text-align: left;
}
blockquote {
font-style: italic;
}
td, th {
padding-top: 2px;
padding-bottom: 2px;
}
body {
background-color: #EEE;
}
pre {
}
#content, #preamble, #postamble {
margin-left:300px;
max-width: 100%;
}
.tag {
background-color: inherit; font-family: inherit;
padding: inherit; font-size: 80%; font-weight: inherit;
text-transform: uppercase;
}

.figure p { text-align: inherit; }
figure-number { font-style: italic; }
#table-of-contents {
text-align: left;
position: fixed;
left: 0;
margin: 0 auto;
padding: 0;
width: 300px;
top: 0;
height: 100%;
border: 0;
display: block;
}
#text-table-of-contents {
overflow-y: scroll;
height: 100%;
}
#text-table-of-contents ul {
padding-left: 1em;
margin-left: 0.5em;
}
#table-of-contents > h2 {
padding: 0.1em;
margin: 0;
}
/* adjustments for small screen, toc at top only */
@media (max-width: 800px) { /* landscape for iphone */
html {
-webkit-text-size-adjust: none;  /* prevent scaling of text on mobile */
}
body {
background-color: #EEE;
width:100%;
margin:0 auto;
}
#content, #preamble, #postamble {
margin-left:0;
}
#table-of-contents {
position: static;
left: inherit;
width:inherit;
height: auto;
border-top: 0em;
padding: 0em .5em .5em .5em; /* top right bottom left */
margin: 1em 0em 1em 0em; /* top right bottom left */
border: 0.75em solid #006633;
}
div.outline-2, #table-of-contents {
background-color: rgb(250,250,250);
border: 0.75em solid var(--heading-bg-color);
border-top: 0em;
padding: 0em .5em .5em .5em; /* top right bottom left */
margin: 1em 0em 1em 0em; /* top right bottom left */
}
div.outline-2 > h2, #table-of-contents > h2 {
background-color: var(--heading-bg-color);
color: var(--heading-fg-color);
font-variant: small-caps;
padding: 0em 0em 0em .5em; /* top right bottom left */
margin: 0em -.5em 0em -.75em; /* top right bottom left */
text-align: left;
}
#text-table-of-contents {
overflow-y: visible;
height: inherit;
}
#text-table-of-contents ul {
padding-left: 1em;
margin-left: 0.5em;
}
}
.linenr { font-size: xx-small; }
}

@media print {
html {
font-family: serif;
font-size: 10pt;
text-align: justify;
.linenr { font-size: xx-small; }
}
}
</style>
<style>
/* Theme: Srcery
Description: Srcery dark color scheme for highlight.js
Author: Chen Bin <chen.bin@gmail.com>
Maintainer: @redguardtoo
Website: https://srcery-colors.github.io/
Date: 2021-04-13
https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/srcery.css

Tailored by: Chris Kauffman <profk@umd.edu>
Date: Sat Nov 25 06:16:20 PM EST 2023
*/
pre code.hljs {
display: block;
overflow-x: auto;
padding: 1em
}
code.hljs {
padding: 3px 5px
}
.hljs {
background: #1C1B19;
/* Black */
color: #FFFFFF/* Bright White */

}
/* Bright White */
.hljs-subst,
.hljs-quote,
.hljs-literal {
color: #FCE8C3
}
/* Bright Blue */
.hljs-type,
.hljs-symbol {
color: #68A8E4
}
/* Red */
.hljs-keyword,
.hljs-deletion {
color: #EF2F27
}
/* Yellow */
.hljs-name,
.hljs-function,
.hljs-attribute,
.hljs-selector-attr,
.hljs-selector-id,
.hljs-selector-class,
.hljs-selector-pseudo,
.hljs-section,
.hljs-title {
color: #FBB829
}
/* Cyan */
.hljs-code,
.hljs-variable,
.hljs-property,
.hljs-template-variable,
.hljs-class {
color: #0AAEB3
}
/* Bright Green */
.hljs-string,
.hljs-regexp,
.hljs-bullet,
.hljs-addition {
color: #98BC37
}
/* Bright Magenta */
.hljs-built_in,
.hljs-params {
color: #FF5C8F
}
/* Blue */
.hljs-template-tag,
.hljs-selector-tag {
color: #2C78BF
}
/* Bright Black */
.hljs-link,
.hljs-number,
.hljs-comment,
.hljs-meta {
color: #B1B195
/* color: #918175 */
}
.hljs-emphasis {
font-style: italic
}
.hljs-strong {
font-weight: bold
}
/* @see https://github.com/srcery-colors/srcery-emacs for reference */
</style>

<link rel="stylesheet" href="./srcery-ck.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
function interactive_lang() {      // define a custom "interactive" language
return {
name: 'interactive',           // language name
keywords: {
$pattern: /[^ \t\n]+/,       // lex based on non-whitespace
keyword: [">>","(shellac)","HM>","homeputer>","grace3:","grace4:","grace5:","grace6:","grace7:","grace8:","grace9:","grace10:"], // allowed interactive prompts
},
contains: [
// hljs.HASH_COMMENT_MODE,   // use standard hash comments, any # is a comment
hljs.COMMENT(/#+ /, /$/),    // use custom comment of # w/ whitespace
]
};
};
hljs.registerLanguage('interactive', interactive_lang);     // register custom language

// Add highlighjs CSS classes to elemens marked with relevant org classes
lang_map = new Map();              // map of org to hljs languages
lang_map.set("src-c"    , "language-c");
lang_map.set("src-text" , "language-plaintext");
lang_map.set("src-sh"   , "language-interactive");
function add_class(el) {           // applied to each pre.src element
for (let [org_lang, hljs_lang] of lang_map) {
if(el.classList.contains(org_lang)){
el.classList.add(hljs_lang);
}
}
}
// visit all pre.src elements and apply function to add language class
document.querySelectorAll('pre.src').forEach(add_class);
hljs.configure({cssSelector: 'pre'}); // select pre blocks only to highligh
hljs.highlightAll();                  // perform highlighting on all pre blocks
});
</script>
<style type="text/css">
th.org-left   { text-align: left;   }
</style>
</head>
<body>
<div id="preamble" class="status">
<i>Last Updated: 2024-09-11 Wed 14:37</i>
</div>
<div id="content" class="content">
<h1 class="title">CMSC216 Project 1: C Programming</h1>
<ul class="org-ul">
<li><b>Due: 11:59pm Mon 23-Sep-2024</b></li>
<li><i>Approximately 4.0% of total grade</i></li>
<li>Submit to <a href="https://www.gradescope.com/"><b>Gradescope</b></a></li>
<li>Projects are <b>individual work</b>: no collaboration with other students
is allowed. Seek help from course staff if you get stuck for too long.</li>
</ul>

<div id="outline-container-orgaa5c2a7" class="outline-4">
<h4 id="orgaa5c2a7">CODE DISTRIBUTION: <a href="p1-code.zip">p1-code.zip</a></h4>
</div>
<div id="outline-container-org52a6e8b" class="outline-4">
<h4 id="org52a6e8b">VIDEO OVERVIEW: <a href="https://youtu.be/Hq0-QsamO1M">https://youtu.be/Hq0-QsamO1M</a></h4>
</div>
<div id="outline-container-org89a5205" class="outline-4">
<h4 id="org89a5205">CHANGELOG:</h4>
<div class="outline-text-4" id="text-org89a5205">
<dl class="org-dl">
<dt>Wed Sep 11 02:25:02 PM EDT 2024</dt><dd><p>
A video overview of Project 1 has
been uploaded here: <a href="https://youtu.be/Hq0-QsamO1M">https://youtu.be/Hq0-QsamO1M</a>.  The audio quality
for the first few minutes of the video is a bit distorted but
stabilizes about 3 minutes in. Apologies for that technical mishap.
</p>

<p>
Several typos in the project spec and diagrams that came up in the
video have been corrected.
</p></dd>

<dt>Wed Sep 11 12:19:21 PM EDT 2024</dt><dd>Hyperlink to P1 added to the
course schedule. Minor typo in the Documentation Comments for
<code>vote_next_candidate()</code> corrected: return value for the first
example was incorrect as reported in <a href="https://piazza.com/class/lzzvmm0hu9v228/post/112">Post 112</a>.</dd>
</dl>
</div>
</div>

<div id="outline-container-orgd238af3" class="outline-4">
<h4 id="orgd238af3"></h4>
<div class="outline-text-4" id="text-orgd238af3">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org2eb4d0d">1. Introduction</a>
<ul>
<li><a href="#org02ee1a9">1.1. Simplified Rules for Ranked Choice Voting</a></li>
<li><a href="#org1e06335">1.2. An Example Election</a></li>
</ul>
</li>
<li><a href="#orge5b9c64">2. Download Code and Setup</a>
<ul>
<li><a href="#org9a48056">2.1. Makefile</a></li>
<li><a href="#org13c2ab1">2.2. Automated Tests</a></li>
</ul>
</li>
<li><a href="#org9d79307">3. Outline of Code</a>
<ul>
<li><a href="#org2d7931e">3.1. Getting Started</a></li>
<li><a href="#orgeb6e844">3.2. The Dev Cycle</a></li>
</ul>
</li>
<li><a href="#org00a7f35">4. Problem 1: Votes and Tallies</a>
<ul>
<li><a href="#orgaa0acaf">4.1. Project Data Types</a></li>
<li><a href="#orgcc51664">4.2. Diagram of Data Layout</a></li>
<li><a href="#org1b6af39">4.3. Printing and Advancing a Vote</a></li>
<li><a href="#org49c10dc">4.4. Tally Result Tables</a></li>
<li><a href="#orgb9413fa">4.5. Minvote Candidates</a></li>
<li><a href="#org70a2658">4.6. Ending Conditions for Elections</a></li>
<li><a href="#orge1ff1cb">4.7. Grading Criteria for Problem 1</a></li>
</ul>
</li>
<li><a href="#org7c7a68d">5. Problem 2: Tally Mutation</a>
<ul>
<li><a href="#org8b465e3">5.1. Creating Voters and Freeing Tallies</a></li>
<li><a href="#org265b4b6">5.2. Adding Votes to Tallies</a></li>
<li><a href="#org64ff4dd">5.3. Printing Tally Votes</a></li>
<li><a href="#orgdb64c7b">5.4. Dropping Candidates and Transferring Votes</a></li>
<li><a href="#org961b65b">5.5. Running an Election</a></li>
<li><a href="#org969de3e">5.6. Grading Criteria for Problem 2</a></li>
</ul>
</li>
<li><a href="#org98a5ce5">6. Problem 3: Data Files and Main</a>
<ul>
<li><a href="#org2103f0d">6.1. Vote Data Files</a></li>
<li><a href="#orgf493c62">6.2. Loading Vote Data</a></li>
<li><a href="#org80cc8a8">6.3. The Main Function</a></li>
<li><a href="#orge524f2c">6.4. Grading Criteria for Problem 3</a></li>
</ul>
</li>
<li><a href="#orgf49689b">7. Optional MAKEUP Credit</a></li>
<li><a href="#orgaf90b13">8. Project Submission</a>
<ul>
<li><a href="#orgb432ad6">8.1. Submit to Gradescope</a></li>
<li><a href="#org3f6c681">8.2. Late Project Submission Policies</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-org2eb4d0d" class="outline-2">
<h2 id="org2eb4d0d"><span class="section-number-2">1</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
<a href="https://en.wikipedia.org/wiki/Instant-runoff_voting">Ranked Choice Voting (RCV) (also called Instant Runoff Voting (IRV))</a>
is an election system in which each voter ranks candidates for a
position according to preference rather than selecting only their
first choice. This is the source of the "ranked choice" name.
Election results are calculated in <b>rounds</b> in which candidates with
the lowest vote count are dropped.  If a voter's first-choice is
dropped, their vote moves to their next highest choice. This is the
source of the "instant runoff" name: a runoff election is when
low-vote candidates are eliminated and voters choices are
restricted. With RCV run-offs can be done "instantly" based on the
rankings of candidates by voters.
</p>

<p>
RCV is generally considered advantageous over other voting schemes and
have started to see use in some <a href="https://en.wikipedia.org/wiki/Ranked-choice_voting_in_the_United_States">local and state-wide election across
the USA</a> <a href="https://en.wikipedia.org/wiki/Takoma_Park,_Maryland#Voting">municipal elections in Takoma Park in Montgomery County, MD.</a>
It means that voters are free to cast votes for unpopular candidates
who strongly align with their views knowing that if their favorite is
eliminated, their vote will not be lost but transfer to their next
best choice.
</p>

<p>
A couple videos explaining Ranked Choice Voting:
</p>
<ul class="org-ul">
<li><a href="https://www.youtube.com/watch?v=53z9feUiqdg">City of Minneapolis description if Ranked Choice Voting (Youtube, 2:00min)</a></li>
<li><a href="https://www.youtube.com/watch?v=oHRPMJmzBBw">MPR Overview of Instant Runoff Voting (Youtube, 1:10min)</a></li>
</ul>

<p>
This project will center on calculating the results of elections which
use RCV.  
</p>
<ul class="org-ul">
<li>The RCV algorithm is iterative in nature with several termination
criteria so looping and conditionals will be essential.</li>
<li>Votes and Intermediate results must be encoded using C <code>structs</code> and
data structures (linked lists) in order to efficiently calculate
vote re-distribution</li>
<li>Voting information will be loaded from files necessitating some file
I/O to be used</li>
</ul>
</div>

<div id="outline-container-org02ee1a9" class="outline-3">
<h3 id="org02ee1a9"><span class="section-number-3">1.1</span> Simplified Rules for Ranked Choice Voting</h3>
<div class="outline-text-3" id="text-1-1">
<ol class="org-ol">
<li><b>Active Candidates</b>: Each candidate in the election starts out
Active but may be dropped (eliminated) during a round due to having
the fewest votes.</li>
<li><b>Minimum Vote Candidates</b>: Each round, the candidates with the
minimum number of votes is noted as such and is subject to being
dropped at the beginning of the next round.</li>
<li><b>Dropped Candidates</b>: Barring other conditions, candidates with the
minimum number of votes are dropped from the election and their
votes are re-assigned to Active candidates.</li>
<li><b>Winning</b>: If at any time, only a single candidate is Active, they
are the winner. This may be due to all other candidates being
Dropped or having Minimum votes. The single Active candidate is the
Winner and the election ends.</li>
<li><b>Multi-way Ties</b>: If at any time, all Active candidates are
identified as having the Minimum votes, a tie has occurred. This
may be a 2-way, 3-way, 4-way, etc. tie and will be referred to as a
"Multi-way Tie". If this occurs, the election ends with a Tie
Result. (If this occurs in real elections, there must be some
law/policy on how to proceed with either breaking the tie or
sharing power between the tied candidates).</li>
</ol>
</div>
</div>

<div id="outline-container-org1e06335" class="outline-3">
<h3 id="org1e06335"><span class="section-number-3">1.2</span> An Example Election</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Below is a sample of how an RCV election is tabulated. 
</p>
</div>

<div id="outline-container-orgca0701b" class="outline-4">
<h4 id="orgca0701b">Candidates and Votes</h4>
<div class="outline-text-4" id="text-orgca0701b">
<p>
4 candidates
</p>
<ul class="org-ul">
<li>0:Francis</li>
<li>1:Claire</li>
<li>2:Heather</li>
<li>3:Viktor</li>
</ul>

<p>
12 Votes (Ballots)
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">Candidate</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>

<tr>
<th scope="col" class="org-left">Ballot#</th>
<th scope="col" class="org-left">Order</th>
<th scope="col" class="org-left">1st Choice</th>
<th scope="col" class="org-left">2nd Choice</th>
<th scope="col" class="org-left">3rd Choice</th>
<th scope="col" class="org-left">4th Choice</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">#0001</td>
<td class="org-left">0 3 2 1</td>
<td class="org-left">0:Francis</td>
<td class="org-left">3:Viktor</td>
<td class="org-left">2:Heather</td>
<td class="org-left">1:Claire</td>
</tr>

<tr>
<td class="org-left">#0002</td>
<td class="org-left">1 0 2 3</td>
<td class="org-left">1:Claire</td>
<td class="org-left">0:Francis</td>
<td class="org-left">2:Heather</td>
<td class="org-left">3:Viktor</td>
</tr>

<tr>
<td class="org-left">#0003</td>
<td class="org-left">2 1 0 3</td>
<td class="org-left">2:Heather</td>
<td class="org-left">1:Claire</td>
<td class="org-left">0:Francis</td>
<td class="org-left">3:Viktor</td>
</tr>

<tr>
<td class="org-left">#0004</td>
<td class="org-left">2 1 0 3</td>
<td class="org-left">2:Heather</td>
<td class="org-left">1:Claire</td>
<td class="org-left">0:Francis</td>
<td class="org-left">3:Viktor</td>
</tr>

<tr>
<td class="org-left">#0005</td>
<td class="org-left">1 0 2 3</td>
<td class="org-left">1:Claire</td>
<td class="org-left">0:Francis</td>
<td class="org-left">2:Heather</td>
<td class="org-left">3:Viktor</td>
</tr>

<tr>
<td class="org-left">#0006</td>
<td class="org-left">0 2 1 3</td>
<td class="org-left">0:Francis</td>
<td class="org-left">2:Heather</td>
<td class="org-left">1:Claire</td>
<td class="org-left">3:Viktor</td>
</tr>

<tr>
<td class="org-left">#0007</td>
<td class="org-left">0 1 2 3</td>
<td class="org-left">0:Francis</td>
<td class="org-left">1:Claire</td>
<td class="org-left">2:Heather</td>
<td class="org-left">3:Viktor</td>
</tr>

<tr>
<td class="org-left">#0008</td>
<td class="org-left">2 1 0 3</td>
<td class="org-left">2:Heather</td>
<td class="org-left">1:Claire</td>
<td class="org-left">0:Francis</td>
<td class="org-left">3:Viktor</td>
</tr>

<tr>
<td class="org-left">#0009</td>
<td class="org-left">2 0 1 3</td>
<td class="org-left">2:Heather</td>
<td class="org-left">0:Francis</td>
<td class="org-left">1:Claire</td>
<td class="org-left">3:Viktor</td>
</tr>

<tr>
<td class="org-left">#0010</td>
<td class="org-left">3 0 2 1</td>
<td class="org-left">3:Viktor</td>
<td class="org-left">0:Francis</td>
<td class="org-left">2:Heather</td>
<td class="org-left">1:Claire</td>
</tr>

<tr>
<td class="org-left">#0011</td>
<td class="org-left">0 1 2 3</td>
<td class="org-left">0:Francis</td>
<td class="org-left">1:Claire</td>
<td class="org-left">2:Heather</td>
<td class="org-left">3:Viktor</td>
</tr>

<tr>
<td class="org-left">#0012</td>
<td class="org-left">2 0 1 3</td>
<td class="org-left">2:Heather</td>
<td class="org-left">0:Francis</td>
<td class="org-left">1:Claire</td>
<td class="org-left">3:Viktor</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgf9f050f" class="outline-4">
<h4 id="orgf9f050f">Round 1 Tally</h4>
<div class="outline-text-4" id="text-orgf9f050f">
<p>
No candidates dropped to start the first round.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">NUM</th>
<th scope="col" class="org-right">COUNT</th>
<th scope="col" class="org-right">PERC</th>
<th scope="col" class="org-left">NAME</th>
<th scope="col" class="org-left">STATUS</th>
<th scope="col" class="org-left">VOTES</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">4</td>
<td class="org-right">33.3</td>
<td class="org-left">Francis</td>
<td class="org-left">Active</td>
<td class="org-left">#0011:&lt;0&gt; 1  2  3 #0007:&lt;0&gt; 1  2  3 #0006:&lt;0&gt; 2  1  3 #0001:&lt;0&gt; 3  2  1</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">16.7</td>
<td class="org-left">Claire</td>
<td class="org-left">Active</td>
<td class="org-left">#0005:&lt;1&gt; 0  2  3 #0002:&lt;1&gt; 0  2  3</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">5</td>
<td class="org-right">41.7</td>
<td class="org-left">Heather</td>
<td class="org-left">Active</td>
<td class="org-left">#0012:&lt;2&gt; 0  1  3 #0009:&lt;2&gt; 0  1  3 #0008:&lt;2&gt; 1  0  3 #0004:&lt;2&gt; 1  0  3 #0003:&lt;2&gt; 1  0  3</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-right">8.3</td>
<td class="org-left">Viktor</td>
<td class="org-left">MinVotes</td>
<td class="org-left">#0010:&lt;3&gt; 0  2  1</td>
</tr>
</tbody>
</table>

<p>
NOTE: The votes are listed next to each candidate with the currently
selected candidate indicated by a token like <code>&lt;2&gt;</code>. Votes are
initially assigned to all voters' first choice but as candidates are
Dropped, votes are transferred to the next choice on the ballot.
</p>

<p>
Heather starts in 1st place with Francis and Claire trailing.  Viktor
is the candidate with the Minimum votes so will be dropped in the next
round with Ballot #0010 moving to its next candidate.
</p>
</div>
</div>

<div id="outline-container-org0fa38ad" class="outline-4">
<h4 id="org0fa38ad">Round 2 Tally</h4>
<div class="outline-text-4" id="text-org0fa38ad">
<p>
Viktor had the minimum votes so Ballot #0010 is transferred to Francis
and Viktor is dropped from the election. This leaves the following new
Tally.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">NUM</th>
<th scope="col" class="org-right">COUNT</th>
<th scope="col" class="org-right">PERC</th>
<th scope="col" class="org-left">NAME</th>
<th scope="col" class="org-left">STATUS</th>
<th scope="col" class="org-left">VOTES</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">5</td>
<td class="org-right">41.7</td>
<td class="org-left">Francis</td>
<td class="org-left">Active</td>
<td class="org-left">#0010: 3 &lt;0&gt; 2  1 #0011:&lt;0&gt; 1  2  3 #0007:&lt;0&gt; 1  2  3 #0006:&lt;0&gt; 2  1  3 #0001:&lt;0&gt; 3  2  1</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">16.7</td>
<td class="org-left">Claire</td>
<td class="org-left">MinVotes</td>
<td class="org-left">#0005:&lt;1&gt; 0  2  3 #0002:&lt;1&gt; 0  2  3</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">5</td>
<td class="org-right">41.7</td>
<td class="org-left">Heather</td>
<td class="org-left">Active</td>
<td class="org-left">#0012:&lt;2&gt; 0  1  3 #0009:&lt;2&gt; 0  1  3 #0008:&lt;2&gt; 1  0  3 #0004:&lt;2&gt; 1  0  3 #0003:&lt;2&gt; 1  0  3</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">-</td>
<td class="org-right">-</td>
<td class="org-left">Viktor</td>
<td class="org-left">Droppped</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Note that the first vote listed for Francis reads <code>#0010: 3 &lt;0&gt; 2  1</code>:
it was transferred from 3:Viktor to 0:Francis when Viktor was dropped.
</p>

<p>
Claire is now identified as having the Minimum Votes and will be
dropped in the next round. Francis and Heather are tied now but do not
have Minimum Votes so another round will take place. 
</p>
</div>
</div>



<div id="outline-container-org628fa8f" class="outline-4">
<h4 id="org628fa8f">Round 3 Tally</h4>
<div class="outline-text-4" id="text-org628fa8f">
<p>
Claire had the Minimum Votes and so the two ballots for her (#0005 and
#0002) are transferred to their next candidate which happens to be
Francis. Claire is then dropped which leaves the new tally as follows.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">NUM</th>
<th scope="col" class="org-left">COUNT</th>
<th scope="col" class="org-left">PERC</th>
<th scope="col" class="org-left">NAME</th>
<th scope="col" class="org-left">STATUS</th>
<th scope="col" class="org-left">VOTES</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-left">7</td>
<td class="org-left">58.3</td>
<td class="org-left">Francis</td>
<td class="org-left">Active</td>
<td class="org-left">#0002: 1 &lt;0&gt; 2  3 #0005: 1 &lt;0&gt; 2  3 #0010: 3 &lt;0&gt; 2  1 #0011:&lt;0&gt; 1  2  3 #0007:&lt;0&gt; 1  2  3 #0006:&lt;0&gt; 2  1  3 #0001:&lt;0&gt; 3  2  1</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">Claire</td>
<td class="org-left">Dropped</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">5</td>
<td class="org-left">41.7</td>
<td class="org-left">Heather</td>
<td class="org-left">MinVotes</td>
<td class="org-left">#0012:&lt;2&gt; 0  1  3 #0009:&lt;2&gt; 0  1  3 #0008:&lt;2&gt; 1  0  3 #0004:&lt;2&gt; 1  0  3 #0003:&lt;2&gt; 1  0  3</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">Viktor</td>
<td class="org-left">Dropped</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Heather is then identified as having the Minimum Votes leaving only a
single Active candidate: Francis. This makes Francis the winner
despite him having fewer 1st choice votes initially than Heather, just
as one would expect from an Underwood.
</p>
</div>
</div>
</div>
</div>


<div id="outline-container-orge5b9c64" class="outline-2">
<h2 id="orge5b9c64"><span class="section-number-2">2</span> <a id="org4f2145e"></a> Download Code and Setup</h2>
<div class="outline-text-2" id="text-2">
<p>
Download the code pack linked at the top of the page. Unzip this which
will create a project folder. Create new files in this
folder. Ultimately you will re-zip this folder to submit it.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">File</th>
<th scope="col" class="org-left">State</th>
<th scope="col" class="org-left">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>Makefile</code></td>
<td class="org-left">Provided</td>
<td class="org-left">Build file to compile all programs</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><code>rcv_funcs.c</code></td>
<td class="org-left">CREATE</td>
<td class="org-left">Problems 1-3 functions to write, outline provided below</td>
</tr>

<tr>
<td class="org-left"><code>rcv_main.c</code></td>
<td class="org-left">CREATE</td>
<td class="org-left">Problem 3 main function</td>
</tr>

<tr>
<td class="org-left"><code>rcv.h</code></td>
<td class="org-left">Provided</td>
<td class="org-left">Project Header file</td>
</tr>

<tr>
<td class="org-left"><code>cmdline_args.c</code></td>
<td class="org-left">Provided</td>
<td class="org-left">Demo of how to access command line arguments</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>data/votes-sample.txt</code></td>
<td class="org-left">Data</td>
<td class="org-left">Vote file for the election sample</td>
</tr>

<tr>
<td class="org-left"><code>data/votes-5cands.txt</code></td>
<td class="org-left">Data</td>
<td class="org-left">Vote file with 5 candidates</td>
</tr>

<tr>
<td class="org-left"><code>data/votes-stress.txt</code></td>
<td class="org-left">Data</td>
<td class="org-left">Large vote file with many candidates</td>
</tr>

<tr>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">TESTING</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>testy</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Test running script</td>
</tr>

<tr>
<td class="org-left"><code>test_rcv_funcs.c</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Testing file for required C functions</td>
</tr>

<tr>
<td class="org-left"><code>test-results/</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Directory in which temporary testing files are written</td>
</tr>

<tr>
<td class="org-left"><code>test_rcv1.org</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Problem 1 tests</td>
</tr>

<tr>
<td class="org-left"><code>test_rcv2.org</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Problem 2 tests</td>
</tr>

<tr>
<td class="org-left"><code>test_rcv3.org</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Problem 3 tests</td>
</tr>
</tbody>
</table>
</div>


<div id="outline-container-org9a48056" class="outline-3">
<h3 id="org9a48056"><span class="section-number-3">2.1</span> Makefile</h3>
<div class="outline-text-3" id="text-2-1">
<p>
A <code>Makefile</code> is provided as part of this project. Building programs in
C is a bit tedious and most folks use <b>build systems</b> of which <code>make</code>
is the oldest. The instructions and dependencies to create programs
are written in a <code>Makefile</code> which is then interpreted by the <code>make</code>
program which will run <code>gcc</code> and other commands to create programs.
</p>

<p>
Use this <code>Makefile</code> by issuing commands like <code>make prob1</code>
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; make help
Typical usage is:
  &gt; make                          # build all programs
  &gt; make clean                    # remove all compiled items
  &gt; make zip                      # create a zip file for submission
  &gt; make prob1                    # built targets associated with problem 1
  &gt; make test                     # run all tests
  &gt; make test-prob2               # run test for problem 2
  &gt; make test-prob2 testnum=5     # run problem 2 test #5 only
  &gt; make update                   # download and install any updates to project files

&gt;&gt; make prob2                   # build problem 2 demo program
gcc -Wall -Werror -g -Wno-unused-variable -c rcv_funcs.c
gcc -Wall -Werror -g -Wno-unused-variable -o test_rcv_funcs test_rcv_funcs.c rcv_funcs.o

&gt; make clean                    # remove all programs/binary object files
rm -f test_rcv_funcs rcv_main  *.o

&gt;&gt; make prob3                   # build problem 3 main program
gcc -Wall -Werror -g -Wno-unused-variable -c rcv_main.c
gcc -Wall -Werror -g -Wno-unused-variable -c rcv_funcs.c
gcc -Wall -Werror -g -Wno-unused-variable -o rcv_main rcv_main.o rcv_funcs.o
gcc -Wall -Werror -g -Wno-unused-variable -o test_rcv_funcs test_rcv_funcs.c rcv_funcs.o

&gt; make clean                    # remove all programs/binary object files
rm -f test_rcv_funcs rcv_main  *.o

&gt;&gt; make                         # build all programs/objects for the assignment
gcc -Wall -Werror -g -Wno-unused-variable -c rcv_funcs.c
gcc -Wall -Werror -g -Wno-unused-variable -o test_rcv_funcs test_rcv_funcs.c rcv_funcs.o
gcc -Wall -Werror -g -Wno-unused-variable -c rcv_main.c
gcc -Wall -Werror -g -Wno-unused-variable -o rcv_main rcv_main.o rcv_funcs.o
</pre>
</div>

<p>
You are not required to understand all that is in the <code>Makefile</code> (yet)
but it is a very useful tool well worth your time to learn.
</p>
</div>
</div>

<div id="outline-container-org13c2ab1" class="outline-3">
<h3 id="org13c2ab1"><span class="section-number-3">2.2</span> <a id="org1b07a36"></a> Automated Tests</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Automated tests are included with the code distribution. <b>These tests
are known to work on grace.umd.edu only</b> but in most cases they should
run identically in Linux environments. They <i>may</i> work on the Windows Subsystem
for Linux but no guarantees are made. They very unlikely to run on
MacOS natively as Linux-specific tools are used.
</p>

<p>
The provided <code>Makefile</code> allows automated tests to be run via calls
like <code>make test-prob1</code> to test Problem 1 and <code>make test-prob2</code> to test
Problem 2. See the transcript below.
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; make test-prob1                    # run tests for problem 1, compiles required code first
gcc -Wall -Werror -g -Wno-unused-variable -c rcv_funcs.c
gcc -Wall -Werror -g -Wno-unused-variable -o test_rcv_funcs test_rcv_funcs.c rcv_funcs.o
./testy -o md test_rcv1.org 
=====================================================
== test_rcv1.org : Problem 1 Basic RCV Function Tests
== Running 10 / 10 tests
 1) vote_print_1          : ok
 2) vote_print_2          : ok
 3) vote_print_3          : ok
 4) vote_next_candidate_1 : ok
 5) vote_next_candidate_2 : ok
 6) vote_next_candidate_3 : ok
 7) vote_next_candidate_4 : ok
 8) tally_print_table_1   : ok
 9) tally_print_table_2   : ok
10) tally_print_table_3   : ok
=====================================================
RESULTS: 10 / 10 tests passed

&gt;&gt; make test-prob2                    # run tests for problem 2
./testy test_rcv2.org 
========================================================================
== test_rcv3.org : Problem 3 Tally Allocation / Printing / Manipulation 
== Running 20 / 20 tests
 1) vote_make_empty                 : ok
 2) tally_add_vote_print_free_1     : ok
 3) tally_add_vote_print_free_2     : ok
 4) tally_add_vote_print_free_3     : ok
 5) tally_transfer_first_vote_1     : ok
 6) tally_transfer_first_vote_2     : ok
 7) tally_transfer_first_vote_3     : ok
 8) tally_transfer_first_vote_4     : ok
 9) tally_transfer_first_vote_5     : ok
...

&gt; make test                           # run tests for all problems
...
</pre>
</div>
<p>
Each problem describes specifically how tests can be run and how
credit will be assigned.
</p>

<p>
Note that one can <b>run a single test</b> with the following <code>make</code>
invocation which sets <code>testnum</code>.
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt; make test-prob2 testnum=5
</pre>
</div>
<p>
This is useful when debugging to limit the output and time it takes to
check program results.
</p>
</div>
</div>
</div>

<div id="outline-container-org9d79307" class="outline-2">
<h2 id="org9d79307"><span class="section-number-2">3</span> Outline of Code</h2>
<div class="outline-text-2" id="text-3">
<p>
The file <code>rcv_funcs.c</code> will contain most of the support functions for
the Ranked Choice Voting program. An outline of these functions are
presented below. Note that each function has the Problem # to which it
belongs. The final <code>main()</code> function should be written in the
<code>rcv_main.c</code> file.
</p>

<div class="org-src-container">
<pre class="src src-c">// rcv_funcs.c: Required functions for Ranked Choice Voting

#include "rcv.h"
////////////////////////////////////////////////////////////////////////////////
// GLOBAL VARIABLES

int LOG_LEVEL = 0;
// Global variable controlling how much info should be printed; it is
// assigned values like LOG_SHOWVOTES (defined in rcv.h as 3) to
// trigger additional output to be printed during certain
// functions. This output is useful to monitor and audit how election
// results are calculated.

////////////////////////////////////////////////////////////////////////////////
// PROBLEM 1 Functions

void vote_print(vote_t *vote);
// PROBLEM 1: Print a textual representation of the vote. A vote which
// is defined as follows
//
// vote_t vote = {.id= 17, .pos=1, .next=...,
//                .candidate_order={3, 0, 2, 1, NO_CANDIDATE}};
//
// would be printed  like this:
//
// #0017: 3 &lt;0&gt; 2  1
//
// The first token printed is a # character followed by the vote-&gt;id
// fields printed in a space of 4 digits with leading 0s using the
// built-in capabilities of printf() ending with a colon (:).  The
// remaining tokens are candidate indexs in order of preference, "3 0
// 2 1" in this case.  The candidate index at vote-&gt;pos is printed
// with angle brackets around it as in "&lt;0&gt;" while other indexes are
// printed with spaces aroudn them as in " 3 ". If `candidate_order[]`
// array has fewer than the MAX_CANDIDATE in it, the slot after the
// last preferred candidate will have `NO_CANDIDATE` in it and
// printing should terminate there. The `next` field is not printed
// and not used during printing.
//
// NOTE: For maximum flexibility, NO NEWLINE is printed at the end of
// the vote which allows several votes to printed on the same line if
// needed.

int vote_next_candidate(vote_t *vote, char *candidate_status);
// PROBLEM 1: Advance the vote to the next active candidate. This
// function usually changes `vote-&gt;pos` to indicate a new candidate is
// selected. If `candidate_order[pos]` is not NO_CANDIDATE and is less
// than MAX_CANDIDATES , increment `pos` and check if the
// `candidate_order[pos]` is ACTIVE. The status of each candidate is
// available in the `candidate_status[]` array where each index is one
// of CAND_ACTIVE, CAND_MINVOTES, CAND_DROPPED. If
// vote-&gt;pos exceeds MAX_CANDIDATES or a NO_CANDIDATE value is
// encountered in `candidate_order[]`, return NO_CANDIDATE. Otherwise
// return the index of the selected candidate for the vote.
//
// EXAMPLES:
// vote_t v = {.pos=1, .candidate_order={2, 0, 3, 1, NO_CANDIDATE}};
// int cand_status[4] = {DROPPED, DROPPED, DROPPED, ACTIVE};
// int next_cand = vote_next_candidate(&amp;vote, cand_status);
// - next_cand is 3
// - v is {.pos=3, .candidate_order={2, 0, 3, 1, NO_CANDIDATE}}
// - pos has advanced from 1 to 3 which is the next ACTIVE candidate
// next_cand = vote_next_candidate(&amp;vote, cand_status);
// - next_cand is NO_CANDIDATE
// - v is {.pos=4, .candidate_order={2, 0, 3, 1, NO_CANDIDATE}}
// - pos has incremented from 3 to 4
// next_cand = vote_next_candidate(&amp;vote, cand_status);
// - next_cand is NO_CANDIDATE
// - v is {.pos=4, .candidate_order={2, 0, 3, 1, NO_CANDIDATE}}
// - pos has not changed as it referred to NO_CANDIDATE already

void tally_print_table(tally_t *tally);
// PROBLEM 1: Print a table showing the vote breakdown for the
// tally. The table appears like the following.
//
// NUM COUNT %PERC S NAME
//   0     4  57.1 A Francis
//   1     1  14.3 M Claire
//   2     -     - D Heather
//   3     2  28.6 A Viktor
//
// This table would be printed for a tally_t with the following data
//
// tally_t t = {
//   .candidate_count = 4;
//   .candidate_names = {"Francis",   "Claire",      "Heather",    "Viktor"},
//   .candidate_status= {CAND_ACTIVE, CAND_MINVOTES, CAND_DROPPED, CAND_ACTIVE},
//   .candidate_vote_counts = {4,     1,             0,            2}
// }
//
// Each candidate is printed along with their "number", count of their
// votes, percentage of that count compared to the total votes for all
// candidates, their candidate state, and their name.  If a candidate
// has a status CAND_DROPPED their count and percentage is printed as
// a "-" to indicate their dropped status. All other candidates have
// their count printed as numbers.
//
// The width format for each column is as follows
// - NUM: integer, 3 wide, right aligned
// - COUNT: integer, 5 wide, right aligned
// - %PERC: floating point, 5 wide, 1 decimal place, right aligned
// - S: status of the candidate, one of A, M, D for ACTIVE, MINVOTES, DROPPED
// - NAME: string, left aligned
// The format specifiers of printf() are used to format these fields.
//
// If there are 0 total votes, this function has undefined behavior
// and may print random garbage. This situation will not be tested for
// any particular behavior.
//
// MAKEUP CREDIT: If there are more than 0 invalid votes, also prints
// the count of the invalid votes like the following:
//
// Invalid vote count: 5

void tally_set_minvote_candidates(tally_t *tally);
// PROBLEM 1: Scans the vote counts of candidates and sets the status
// of candidates with the minimum votes to CAND_MINVOTES excluding
// those with status CAND_DROPPED. All candidates with the minumum
// number of votes have their status set to CAND_MINVOTES.
//
// EXAMPLE:
//
// tally_t t = {
//   .candidate_count = 4;
//   .candidate_names = {"Francis",   "Claire",      "Heather",    "Viktor"},
//   .candidate_status= {CAND_DROPPED, CAND_ACTIVE,   CAND_ACTIVE,  CAND_ACTIVE},
//   .candidate_vote_counts = {0,      4,             2,            2}
// }
// tally_set_minvote_candidates(&amp;t);
// t is now {
//   .candidate_count = 4;
//   .candidate_names = {"Francis",   "Claire",      "Heather",     "Viktor"},
//   .candidate_status= {CAND_DROPPED, CAND_ACTIVE,   CAND_MINVOTES, CAND_MINVOTES},
//   .candidate_vote_counts = {0,      4,             2,             2}
// }
//
// Two candidates have changed status to CAND_MINVOTES but the 0th
// candidate who has status CAND_DROPPED is ignored.
//
// LOGGING: if the LOG_LEVEL is &gt;= LOG_MINVOTE, this function will
// print the following messages to standard out while running.
//
// "LOG: No MIN VOTE count found" : printed when the candidate count
// is 0 or all candidates have status CAND_DROPPED.
//
// "LOG: MIN VOTE count is XX" : printed after the minimum vote count is
// determined with XX substituted for the actual minimum vote count.
//
// "LOG: MIN VOTE count for candidate YY: ZZ\n" : printed for each
// candidate whose status is changed to CAND_MINVOTES with YY and ZZ
// as the candidate index and name.

int tally_condition(tally_t *tally);
// PROBLEM 1: Determine the current condition of the given tally which
// is one of {TALLY_ERROR TALLY_WINNER TALLY_TIE TALLY_CONTINUE}. The
// condition is determined by counting the status of candidates and
// returning a value based on the following circumstances.
//
// - If any candidate has a status outher than CAND_ACTIVE,
//   CAND_MINVOTES, CAND_DROPPED, returns TALLY_ERROR as something has
//   gone wrong tabulations.
// - If there is only 1 ACTIVE candidate, returns TALLY_WINNER as
//   the election has determined a winner
// - If there are 2 or more ACTIVE candidates, returns TALLY_CONTINUE as
//   additional rounds are needed to determine winner
// - If there are 0 ACTIVE candidates and 2 or more MINVOTE candidates,
//   returns TALLY_TIE as the election has ended with a Multiway Tie
// - Returns TALLY_ERROR in all other cases as something has gone wrong
//   in the tabulation (e.g. all candidates dropped, a single MINVOTE
//   candidate, some other bad state).

////////////////////////////////////////////////////////////////////////////////
// PROBLEM 2 Functions

vote_t *vote_make_empty();
// PROBLEM 2: Allocates a vote on the heap using malloc() and
// intitializes its id/pos fields to be -1, all of the entries in
// its candidate_order[] array to be NO_CANDIDATE, and the next field
// to NULL. Returns a pointer to that vote.

void tally_free(tally_t *tally);
// PROBLEM 2: De-allocates a tally and all its linked votes from the
// heap using free(). The entirety of the candidate_votes[] array is
// traversed and each list of votes in it is free()'d by iterating
// through each list and free()'ing each vote. Ends by free()'ing the
// tally itself.

void tally_add_vote(tally_t *tally, vote_t *vote);
// PROBLEM 2: Add the given vote to the given tally. The vote is
// assigned to candidate indicated by the vote-&gt;pos field and
// vote-&gt;candidate_order[] array.  The vote is prepended (added to the
// front) of the associated candidates list of votes and their vote
// count is incremented. This function is primarily used when
// initially populating a tally while other functions like
// tally_transfer_first_vote() are used when calculating elections.
//
// MAKEUP CREDIT: Votes whose preference is NO_CANDIDATE are prepended
// to the invalid_votes list with the invalid_vote_count incrementing.

void tally_print_votes(tally_t *tally);
// PROBLEM 2: Prints out the votes for each candidate in the tally
// which produces output like the following:
//
// VOTES FOR CANDIDATE 0: Andy
//   #0005:&lt;0&gt; 1  3  2  4
//   #0004:&lt;0&gt; 1  2  3  4
// 2 votes total
// VOTES FOR CANDIDATE 1: Bethany
// 0 votes total
// VOTES FOR CANDIDATE 2: Carl
//   #0002: 3 &lt;2&gt; 4  1  0
//   #0003:&lt;2&gt; 1  0  3  4
//   #0001:&lt;2&gt; 0  1  3  4
// 3 votes total
// ...
//
// - Each set of votes is preceded by the headline
//   "VOTES FOR CANDIDATE XX: YY"
//   with XX and YY as the candidate index and name.
// - Each candidate vote is printed starting with 2 spaces, then via a
//   call to vote_print(); then a newline. The list of votes for a
//   particular candidate is printed via iteration through the list
//   following the `next` field of the vote_t struct.
// - Each candidate vote list is ended with a line reading
//   "ZZ votes total"
//   with ZZ replaced by the count of votes for that candidate.
//
// MAKEUP CREDIT: If there are any invalide votes, an additional headline
// "INVALID VOTES"
// is printed followed by a listing of invalid votes in the same
// format as above and ending with a line showing the total invalid
// votes.

void tally_transfer_first_vote(tally_t *tally, int candidate_index);
// PROBLEM 2: Transfer the first vote for the candidate at
// `candidate_index` to the next candidate indicated on the vote. This
// is usually done when the indicated candidate is being dropped from
// the election and their votes are being re-assigned to others.
//
// # COUNT NAME    VOTES
// 0     4 Francis #0008: 3 &lt;0&gt; 2  1 #0009:&lt;0&gt; 1  2  3 #0005:&lt;0&gt; 1  2  3 #0001:&lt;0&gt; 3  2  1
// 1     2 Claire  #0004:&lt;1&gt; 0  2  3 #0002:&lt;1&gt; 0  2  3
// 2     4 Heather #0010:&lt;2&gt; 0  1  3 #0007:&lt;2&gt; 0  1  3 #0006:&lt;2&gt; 1  0  3 #0003:&lt;2&gt; 1  0  3
// 3     0 Viktor
//
// transfer_first_vote(tally, 1);  // Claire's first vote to Francis
//
// # COUNT NAME    VOTES
// 0     5 Francis #0004:&lt;1&gt; 0  2  3 #0008: 3 &lt;0&gt; 2  1 #0009:&lt;0&gt; 1  2  3 #0005:&lt;0&gt; 1  2  3 #0001:&lt;0&gt; 3  2  1
// 1     1 Claire  #0002:&lt;1&gt; 0  2  3
// 2     4 Heather #0010:&lt;2&gt; 0  1  3 #0007:&lt;2&gt; 0  1  3 #0006:&lt;2&gt; 1  0  3 #0003:&lt;2&gt; 1  0  3
// 3     0 Viktor
//
// Note that vote #0002 moves from the front of Claire's list to the
// front of Francis's list.  The `candidate_vote_count[]` array is
// also updated. The function vote_next_candidate(vote) is used to
// alter the vote to reflect the voters next preferred candidate and
// that function's return value is used to determine the destination
// candidate for the transfer. If the candidate at `candidate_index`
// has no votes (vote list is empty), this function does nothing and
// immediately returns.
//
// LOGGING: if LOG_LEVEL &gt;= LOG_VOTE_TRANSFERS then the following message
// is printed:
// "LOG: Transferred Vote #0002: 1 &lt;0&gt; 2  3  from 1 Claire to 0 Francis"
// where the details are adapted to the actual data. Make use of the
// vote_print() function to show the vote.
//
// MAKEUP CREDIT: Votes which return a NO_CANDIDATE result from
// vote_next_candidate() are moved to the invalid_votes list with a
// message to that effect printed:
// "Transferred Vote #0002: 1 &lt;0&gt; 2  3  from 1 Claire to Invalid Votes"

void tally_drop_minvote_candidates(tally_t *tally);
// PROBLEM 2: All candidates with the status CAND_MINVOTES have their
// votes transferred to other candidates via repeated calls to
// tally_transfer_first_vote(). Those with status CAND_MINVOTE are
// changed to have CAND_DROPPED to indicate they are no longer part of
// the election.
//
// LOGGING: If LOG_LEVEL &gt;= LOG_DROP_MINVOTES, prints the following
// for each MINVOTE candidate that is DROPPED:
// "LOG: Dropped Candidate XX: YY"
// with XX and YY as the candidate index and name respectively.

void tally_election(tally_t *tally);
// PROBLEM 2: Executes an election on the given tally.  Repeatedly
// performs the following operations.
//
// - Prints a headline "=== ROUND NN ===" with NN starting at 1 and
//   incrementing each round of the election
// - Drops the minimum vote candidates from the tally; in the first round
//   there will be no MINVOTE candidates but subsequent rounds may have 1
//   or more
// - Prints a table of the current tally state
// - If the LOG_LEVEL &gt;= LOG_SHOWVOTES or more, print all votes for all
//   candidates using an appropriate function; otherwise don't print
//   anything
// - Determine the MINVOTE candidate(s) and cycle to the next round
// Rounds continue while the Condition of the tally is
// TALLY_CONTINUE. When the election ends, one of the following messages
// is printed.
// - If a WINNER was found, print
//   "Winner: XX (candidate YY)"
//   with XX as the candidate name and YY as their index
// - If a TIE resulted, print each candidate that tied as in
//   "Multiway Tie Between:"
//   "AA (candidate XX)"
//   "BB (candidate YY)"
//   "CC (candidate ZZ)"
//   with AA,BB,CC as the candidate names and XX,YY,ZZ their indices.
// - If an ERROR in the election occurred, print
//   "Something is rotten in the state of Denmark"
//
// To print out winners / tie members, this function will iterate
// through the candidate_status[] array to examine the status of each
// candidate. A single winner will be the only CAND_ACTIVE candidate
// while members of a TIE will each have the state CAND_MINVOTES with no
// ACTIVE candidate.
//
// At LOG_LEVEL=0, the output for this function looks like the
// following:
// === ROUND 1 ===
// NUM COUNT %PERC S NAME
//   0     4  33.3 A Francis
//   1     2  16.7 A Claire
//   2     5  41.7 A Heather
//   3     1   8.3 A Viktor
// === ROUND 2 ===
// NUM COUNT %PERC S NAME
//   0     5  41.7 A Francis
//   1     2  16.7 A Claire
//   2     5  41.7 A Heather
//   3     -     - D Viktor
// === ROUND 3 ===
// NUM COUNT %PERC S NAME
//   0     7  58.3 A Francis
//   1     -     - D Claire
//   2     5  41.7 A Heather
//   3     -     - D Viktor
// Winner: Francis (candidate 0)
//

////////////////////////////////////////////////////////////////////////////////
// PROBLEM 3 FUNCTIONS

tally_t *tally_from_file(char *fname);
// PROBLEM 3: Opens the given `fname` and reads its contents to create
// a tally with votes assigned to candidates.  The format of the input
// file is as follows (# denotes comments that will not appear in the
// actual files)
//
// EXAMPLE 1: 4 candidates, 6 votes
// 4                               # first token in number of candidates
// Francis Claire Heather Viktor   # names of the 4 candidate
// 0 3 2 1                         # vote #0001 with preference of 4 candidates
// 1 0 2 3                         # vote #0002 with preference of 4 candidates
// 2 1 0 3                         # etc.
// 2 1 0 3
// 1 0 2 3
// 0 2 1 3
//
// EXAMPLE 2: 5 candidates, 7 votes
// 5                              # first token in number of candidates
// Al Bo Ce Di Ed                 # names of the 5 candidate
// 2 0 1 3 4                      # vote #0001 preference of 5 candidates
// 3 2 4 1 0                      # etc.
// 2 1 0 3 4
// 0 1 2 3 4
// 0 1 3 2 4
// 3 2 4 1 0
// 2 1 0 3 4
//
// Other examples are present in the "data/" directory.
//
// This function heap-allocates a tally_t struct then begins reading
// information from the file into the fields of that struct starting
// with the number of candidates and their names.  A loop is then used
// to iterate reading votes until the End of the File (EOF) is
// reached.  On determining that there is a vote to read, an empty
// vote_t is allocated using vote_make_empty() and the order
// preference of candidates is read into the vote along with
// initializing its pos and id fields. It is then added to the tally
// via tally_add_vote() before iterating to try to read another vote.
//
// This function makes heavy use of fscanf() to read data and checks
// the return value of fscanf() at times to determine if the end of a
// file has been reached. On reaching the end of the input, the file
// is closed and the completed tally is returned
//
// ERROR CASES: Near the beginning of its operation, this function
// checks that the specified file is opened successfully. If not, it
// prints the message
// "ERROR: couldn't open file 'XX'"
// with XX as the filename. NULL is returned in this case.
//
// Aside from failure to open a file, this function assumes that the
// data is formatted correctly and does no other error handling.
// - The first token is NCAND, the number of candidates
// - The next tokens are NCAND strings which are the candidate names
// - Each subsequent vote has exactly NCAND integers
// Bad input data that does not follow the above conventions will
// cause this function to have unpredictable behavior that is not
// tested.
//
// LOGGING: If LOG_LEVEL &gt;= LOG_FILEIO, this function prints the
// following messages which show the progress of the
// function. Substitute XX and CC and such with the actual data read.
//
// "LOG: File 'XX' opened" : when the file is successfully opened
// "LOG: File 'XX' has CC candidtes" : after reading the number of candidates
// "LOG: File 'XX' candidate CC is YY" : after reading a candidate name
// "LOG: File 'XX' vote #0123 &lt;0&gt; 2 3 1" : after reading a comple vote
// "LOG: File 'XX' end of file reached" : on reaching the end of the file

int main(int argc, char *argv[]); // this function in rcv_main.c
// PROBLEM 3: main() in rcv_main.c

</pre>
</div>
</div>

<div id="outline-container-org2d7931e" class="outline-3">
<h3 id="org2d7931e"><span class="section-number-3">3.1</span> Getting Started</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Create the file <code>rcv_funcs.c</code>. Copy the code outline above into
<code>rcv_func.c</code> to serve as a starting point for the project. Filling in
dummy bodies (e.g. <code>return 0</code> or <code>return NULL</code> etc.) will allow the
Automated Tests to run after which one can begin filling in
definitions for the functions according to the provided specification.
</p>

<p>
For the most part, try to solve functions in the order that they
appear in the code outline as later functions will use earlier
functions. If you do get stuck on a function, don't be afraid to move
on momentarily to keep your momentum up.
</p>
</div>
</div>

<div id="outline-container-orgeb6e844" class="outline-3">
<h3 id="orgeb6e844"><span class="section-number-3">3.2</span> The Dev Cycle</h3>
<div class="outline-text-3" id="text-3-2">
<ul class="org-ul">
<li>Read documentation on a required function</li>
<li>Write part of the implementation</li>
<li>Run test cases associated with function</li>
<li>Analyze the results</li>
<li>Consult docs on the function for clarification</li>
<li>Add <code>print()</code> statements to show debug information</li>
<li>Repeat the above until all tests for the function pass</li>
<li>Consult the MANUAL INSPECTION criteria to ensure your style and
functionality meet their requirements</li>
<li>Move on to the next function</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org00a7f35" class="outline-2">
<h2 id="org00a7f35"><span class="section-number-2">4</span> Problem 1: Votes and Tallies</h2>
<div class="outline-text-2" id="text-4">
<p>
The first project problem implements some basic functions used with
the Vote and Tally data types. These functions do not involve any
memory allocation or de-allocation, center on printing or finding
parts of Votes/Tallies, and only change the data in small ways.  Thus
these function serve as a good "warm-up" for the more intricate
functionality that will be required later. Notes below give some hints
on the data layout and how to implement some of the required
functions.
</p>
</div>

<div id="outline-container-orgaa0acaf" class="outline-3">
<h3 id="orgaa0acaf"><span class="section-number-3">4.1</span> Project Data Types</h3>
<div class="outline-text-3" id="text-4-1">
<p>
The header file <code>rcv.h</code> defines the central data types used in the
Ranked Choice Voting election calculation. These are
</p>
<ul class="org-ul">
<li><b>Vote (<code>vote_t</code>)</b>: Encodes a single ballot which indicates a
preference order for candidates along with the current position in
those preferences</li>
<li><b>Tally (<code>tally_t</code>)</b>: Stores votes associated with each candidate, the
status of the candidate (Active, Dropped, etc.) and is the altered
during an election to re-assign votes away from Dropped candidates
to Active candidates.</li>
</ul>

<p>
The associated structs are defined in the header and are worth
studying so they are shown again below.
</p>

<div class="org-src-container">
<pre class="src src-c"><span class="linenr">10: </span>#define MAX_CANDIDATES 128
<span class="linenr">11: </span>#define MAX_NAME       128
<span class="linenr">12: </span>
<span class="linenr">13: </span>typedef struct vote_node {             // Vote data type: single voter preferences of candidates
<span class="linenr">14: </span>  int id;                              // ID of the ballot for this vote
<span class="linenr">15: </span>  int pos;                             // index of currently selected candidate
<span class="linenr">16: </span>  int candidate_order[MAX_CANDIDATES]; // array of candidate preferences for this vote
<span class="linenr">17: </span>  struct vote_node *next;              // pointer to the next vote in a list of votes or NULL
<span class="linenr">18: </span>} vote_t;
<span class="linenr">19: </span>
<span class="linenr">20: </span>typedef struct {                                  // Tally data type: votes associated with all candidates
<span class="linenr">21: </span>  int candidate_count;                            // total candidates in the election, length of various arrays below
<span class="linenr">22: </span>  char candidate_names[MAX_CANDIDATES][MAX_NAME]; // names of each candidate
<span class="linenr">23: </span>  char candidate_status[MAX_CANDIDATES];          // flags for each candidate, on of UNKNOWN, LIVE, DROPPED
<span class="linenr">24: </span>  int candidate_vote_counts[MAX_CANDIDATES];      // length of vot lists associated with each candidate
<span class="linenr">25: </span>  vote_t *candidate_votes[MAX_CANDIDATES];        // pointers linked lists of votes for each candidate
<span class="linenr">26: </span>  vote_t *invalid_votes;                          // list of votes that are invalid: no live candidate is ranked
<span class="linenr">27: </span>  int invalid_vote_count;                         // length of invalid_vote list
<span class="linenr">28: </span>} tally_t;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcc51664" class="outline-3">
<h3 id="orgcc51664"><span class="section-number-3">4.2</span> Diagram of Data Layout</h3>
<div class="outline-text-3" id="text-4-2">
<p>
To get a sense of how this data will be laid out, below is a picture
diagramming the state of the following Tally which has 4 candidates
and 6 votes total.
</p>
</div>

<div id="outline-container-org8a1c3dc" class="outline-4">
<h4 id="org8a1c3dc">Table Representation of Tally / Votes</h4>
<div class="outline-text-4" id="text-org8a1c3dc">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">NUM</th>
<th scope="col" class="org-right">COUNT</th>
<th scope="col" class="org-right">PERC</th>
<th scope="col" class="org-left">NAME</th>
<th scope="col" class="org-left">STATUS</th>
<th scope="col" class="org-left">VOTES</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">50.0</td>
<td class="org-left">Francis</td>
<td class="org-left">Active</td>
<td class="org-left">#0004: 3 &lt;0&gt; 2  1 #0002:&lt;0&gt; 1  2  3 #0001:&lt;0&gt; 2  1  3</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">16.7</td>
<td class="org-left">Claire</td>
<td class="org-left">MinVotes</td>
<td class="org-left">#0005:&lt;1&gt; 0  2  3</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">33.3</td>
<td class="org-left">Heather</td>
<td class="org-left">Active</td>
<td class="org-left">#0006:&lt;2&gt; 0  1  3 #0003:&lt;2&gt; 0  3  1</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">-</td>
<td class="org-right">-</td>
<td class="org-left">Viktor</td>
<td class="org-left">Droppped</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgc9d7c38" class="outline-4">
<h4 id="orgc9d7c38">C structs Representation of Tally / Votes</h4>
<div class="outline-text-4" id="text-orgc9d7c38">
<div class="org-center">

<div id="org4051095" class="figure">
<p><img src="vote_tally.png" alt="vote_tally.png" style="max-width:100%;" />
</p>
<p><span class="figure-number">Figure 1: </span>Diagram showing the expected arrangment of Vote and Tally structs. It shows how Tallies contain overall information about the election state and possess links to the list of Votes associated with each candidate.</p>
</div>
</div>

<p>
Study this picture as it is the end goal of writing the required
functions to create the data arrangement shown and manipulate it to
calculate election results. If you find aspects of it confusing, ask a
staff member for help.
</p>
</div>
</div>
</div>

<div id="outline-container-org1b6af39" class="outline-3">
<h3 id="org1b6af39"><span class="section-number-3">4.3</span> Printing and Advancing a Vote</h3>
<div class="outline-text-3" id="text-4-3">
<p>
Votes in an RCV election contain an order of preference by the voter
for candidates. This preference is stored in the <code>candidate_order[]</code>
array of <code>vote_t</code>.  During elections, if a voter's preferred candidate
is dropped, their vote moves to their next preferred candidate. Thus
there is also a <code>pos</code> (position) field in the <code>vote_t</code> which indicates
the voter's current preferred Active candidate.
</p>

<p>
Throughout the election calculation, it will be necessary to print
individual <code>vote_t</code> structs in a compact format.  For this the
<code>print_vote()</code> function should be used after it is completed.
</p>
<div class="org-src-container">
<pre class="src src-c">void vote_print(vote_t *vote);
// PROBLEM 1: Print a textual representation of the vote. A vote which
// is defined as follows
// 
// vote_t vote = {.id= 17, .pos=1, .next=...,
//                .candidate_order={3, 0, 2, 1, NO_CANDIDATE}};
// 
// would be printed  like this:
// 
// #0017: 3 &lt;0&gt; 2  1 
//
// The first token printed is a # character followed by the vote-&gt;id
// fields printed in a space of 4 digits with leading 0s using the
// built-in capabilities of printf() ending with a colon (:).  The
// remaining tokens are candidate indexs in order of preference, "3 0
// 2 1" in this case.  The candidate index at vote-&gt;pos is printed
// with angle brackets around it as in "&lt;0&gt;" while other indexes are
// printed with spaces aroudn them as in " 3 ". All
// `candidate_order[]` arrays in votes will have a slot with
// `NO_CANDIDATE` after the candidate indices and printing ends at
// this slot. The `next` field is not printed and not used during
// printing.
//
// NOTE: For maximum flexibility, NO NEWLINE is printed at the end of
// the vote which allows several votes to printed on the same line if
// needed.
</pre>
</div>

<p>
A few hints on tricks to use to make this function manageable.
</p>
<ul class="org-ul">
<li><code>printf()</code> will be extremely useful. Look up its capability such as
printing numbers in a width of 4 and adding leading 0's to small
numbers.  This will make tasks like printing <code>#0017</code> for <code>id=17</code>
much easier than trying to hand-write code to produce such output.</li>
<li>The <code>candidate_order[]</code> array can contain up to 128 candidates but
all sane elections will have many fewer than this. The entries in
<code>candidate_order[]</code> are allow non-negative integers.  As the
documentation comment indicates, the special value <code>NO_CANDIDATE</code>
(which is defined as <code>-1</code> in <code>rcv.h</code>) is used to end the array of
candidates after the last valid candidate index. Use this fact to
terminate the loop that prints elements of <code>candidate_order[]</code>.</li>
<li>Make sure NOT to print a newline at the end of the vote as in some
cases, multiple votes may be printed on the same line and extra
newlines would interfere with this.</li>
</ul>

<p>
The second function makes a change to the Vote by advancing to the
next candidate.
</p>
<div class="org-src-container">
<pre class="src src-c">int vote_next_candidate(vote_t *vote, char *candidate_status);
// PROBLEM 1: Advance the vote to the next active candidate. This
// function usually changes `vote-&gt;pos` to indicate a new candidate is
// selected. If `candidate_order[pos]` is not NO_CANDIDATE and is less
// than MAX_CANDIDATES , increment `pos` and check if the
// `candidate_order[pos]` is ACTIVE. The status of each candidate is
// available in the `candidate_status[]` array where each index is one
// of CAND_ACTIVE, CAND_MINVOTES, CAND_DROPPED. If
// vote-&gt;pos exceeds MAX_CANDIDATES or a NO_CANDIDATE value is
// encountered in `candidate_order[]`, return NO_CANDIDATE. Otherwise
// return the index of the selected candidate for the vote.
//
// EXAMPLES:
// vote_t v = {.pos=1, .candidate_order={2, 0, 3, 1, NO_CANDIDATE}};
// int cand_status[4] = {DROPPED, DROPPED, DROPPED, ACTIVE};
// int next_cand = vote_next_candidate(&amp;vote, cand_status);
// - next_cand is 1 
// - v is {.pos=3, .candidate_order={2, 0, 3, 1, NO_CANDIDATE}}
// - pos has advanced from 1 to 3 which is the next ACTIVE candidate
// next_cand = vote_next_candidate(&amp;vote, cand_status);
// - next_cand is NO_CANDIDATE
// - v is {.pos=4, .candidate_order={2, 0, 3, 1, NO_CANDIDATE}}
// - pos has incremented from 3 to 4
// next_cand = vote_next_candidate(&amp;vote, cand_status);
// - next_cand is NO_CANDIDATE
// - v is {.pos=4, .candidate_order={2, 0, 3, 1, NO_CANDIDATE}}
// - pos has not changed as it referred to NO_CANDIDATE already
</pre>
</div>
<p>
This function should change the Vote ("mutation") so that <code>pos</code> goes
forward to next Active candidate. To determine whether candidates are
Active or not, the second parameter <code>candidate_status</code> is used:
it is an array of integers with the status of each candidate in it.
</p>

<p>
Candidate status values are defined in <code>rcv.h</code> via "pound-defines":
</p>
<div class="org-src-container">
<pre class="src src-c">// rcv.h
// STATUS of candidates in an election
#define CAND_UNKNOWN  0          // likely uninitialized
#define CAND_ACTIVE   1          // still in the running
#define CAND_MINVOTES 2          // minimum votes detected, likely drop 
#define CAND_DROPPED  3          // candidate removed during a round of voting
</pre>
</div>
<p>
They are simply integers BUT the word version of these (symbol) like
<code>CAND_ACTIVE</code> conveys much more information to a reader so should be
used to adhere to good style. If <code>candidate_status[i]==CAND_ACTIVE</code>,
then, that candidate is still in the election. Otherwise they have
been or soon will be eliminated.
</p>
</div>
</div>

<div id="outline-container-org49c10dc" class="outline-3">
<h3 id="org49c10dc"><span class="section-number-3">4.4</span> Tally Result Tables</h3>
<div class="outline-text-3" id="text-4-4">
<p>
Throughout the rounds of an RCV election, a summary of the current
distribution of votes needs to be shown so that an observer can verify
the progress. These tables display information in the Tally as shown
below.
</p>
<div class="org-src-container">
<pre class="src src-text">NUM COUNT %PERC S NAME
  0     4  57.1 A Francis
  1     1  14.3 M Claire
  2     -     - D Heather
  3     2  28.6 A Viktor
  |     |  |    | |
  |     |  |    | +--&gt; Candidate names
  |     |  |    +-&gt; Candidate status, A, M, D for ACTIVE, MINVOTES, DROPPED
  |     |  +--&gt; Percent of total vote for candidate or - if candidate Dropped
  |     +--&gt; Count of votes for each candidate or - if candidate dropped     
  +--&gt; Index of candidate
</pre>
</div>
<p>
The commentary at the bottom is not part of the table, only the
documentation shown here.  There are additional details about the
format in the documentation comments for the function shown in the
outline and repeated below.
</p>

<p>
A few hints on implementation.
</p>
<ul class="org-ul">
<li>Using <code>printf()</code> and its format specifiers is by far the easiest way
to produce this kind of tabular format. As with <code>vote_print()</code>,
utilize format specifiers to print numbers with a certain width and
decimal accuracy. Investigate how to do this if these techniques are
new to you. <b>Do not try to print a variable number of spaces to line
up numbers</b>: <code>printf()</code> can do this for you if you ask it to nicely.</li>
<li>To calculate the percentage of votes, it is necessary to iterate
over the array vote counts for candidates and compute the sum. This
is not stored anywhere explicitly and may change in some cases if
(e.g. if votes are invalidated due to not specifying enough
candidates).</li>
<li><p>
After forming a full vote count, you'll need to do some casting /
conversion from integers to doubles. Code like the following will
use integer division when a fractional quantity is needed.
</p>
<div class="org-src-container">
<pre class="src src-c">    int myvotes = 7;
    int total   = 12;
    double mypercent = myvotes / total;  // integer division: 0 result
</pre>
</div>
<p>
Experiment a bit and <b>don't forget to multiply by 100 to get a
percent rather than a fraction.</b>
</p></li>
<li>Check the <code>candidate_state[]</code> field of a Tally to for values like
<code>CAND_ACTIVE, CAND_MINVOTES, CAND_DROPPED</code> in a series of <code>if/else</code>
cases in order to print the correct output. If you are clever, you
might also observe these constants are defined as numbers <code>1,2,3</code>
and use an array of associated strings but that is not needed.</li>
<li>When a candidate is dropped, you must print a <code>-</code> for their vote
count and percentage. Check for this and use alternate calls to
<code>printf()</code> to do so: one case prints a <code>-</code> for these fields, the
other prints numbers.</li>
</ul>

<div class="org-src-container">
<pre class="src src-c">void tally_print_table(tally_t *tally);
// PROBLEM 1: Print a table showing the vote breakdown for the
// tally. The table appears like the following.
//
// NUM COUNT %PERC S NAME
//   0     4  57.1 A Francis
//   1     1  14.3 M Claire
//   2     -     - D Heather
//   3     2  28.6 A Viktor
//
// This table would be printed for a tally_t with the following data
//
// tally_t t = {
//   .candidate_count = 4;
//   .candidate_names = {"Francis",   "Claire",      "Heather",    "Viktor"},
//   .candidate_status= {CAND_ACTIVE, CAND_MINVOTES, CAND_DROPPED, CAND_ACTIVE},
//   .candidate_vote_counts = {4,     1,             0,            2}
// }
// 
// Each candidate is printed along with their "number", count of their
// votes, percentage of that count compared to the total votes for all
// candidates, their candidate state, and their name.  If a candidate
// has a status CAND_DROPPED their count and percentage is printed as
// a "-" to indicate their dropped status. All other candidates have
// their count printed as numbers.
// 
// The width format for each column is as follows
// - NUM: integer, 3 wide, right aligned
// - COUNT: integer, 5 wide, right aligned
// - %PERC: floating point, 5 wide, 1 decimal place, right aligned
// - S: status of the candidate, one of A, M, D for ACTIVE, MINVOTES, DROPPED
// - NAME: string, left aligned
// The format specifiers of printf() are used to format these fields.
//
// If there are 0 total votes, this function has undefined behavior
// and may print random garbage. This situation will not be tested for
// any particular behavior.
//
// MAKEUP CREDIT: If there are more than 0 invalid votes, also prints
// the count of the invalid votes like the following:
// 
// Invalid vote count: 5
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb9413fa" class="outline-3">
<h3 id="orgb9413fa"><span class="section-number-3">4.5</span> Minvote Candidates</h3>
<div class="outline-text-3" id="text-4-5">
<p>
During election rounds, the candidates with the minimum vote counts
are found and then dropped from the election. The
<code>tally_set_minvote_candidates()</code> searches and identifies the minimum
vote candidates. It only sets their status to <code>CAND_MINVOTES</code>. At
first glance, this function seems trivial. However, there are items
that complicate it beyond a typical min-finding exercise.
</p>
<ul class="org-ul">
<li>Candidates with the <code>CAND_DROPPED</code> status are ignored; they should
have 0 votes but should never be identified as having the Minimum
votes as they have already been dropped from the election and can't
be dropped again.</li>
<li>If something has gone wrong with the Tally, it may be that all
cadidates have status <code>CAND_DROPPED</code> so there are no Minvote
candidates. This is likely an error that has occurred elsewhere and
if may result in an error message being printed depending on the log
level.</li>
<li>Multiple candidates may have the minimum vote count and ALL of then
should have their status changed to <code>CAND_MINVOTES</code>.</li>
</ul>

<p>
The crux of the implementation will iterate once through the
candidates to find the minimum vote count NOT held by a Dropped
candidate, then iterate again through the candidates and change the
status of all candidates with the minimum vote count to
<code>CAND_MINVOTES</code>. 
</p>

<p>
This is the first function that must perform some actions based on the
global <code>LOG_LEVEL</code> variable. This variable should be declared at the
top of <code>rcv_funcs.c</code> and is set to various levels to report aspects of
the election calculation to enable human verification.  The
documentation comments indicate some messages to print for the log
level associated with Minimum Vote reporting. A typical implementation
will use something like <code>if(LOG_LEVEL &gt;= SOME_CONSTANT){ ... }</code> and
fill in the consequence of the conditional with required printing when
logging is enabled.
</p>

<div class="org-src-container">
<pre class="src src-c">void tally_set_minvote_candidates(tally_t *tally);
// PROBLEM 1: Scans the vote counts of candidates and sets the status
// of candidates with the minimum votes to CAND_MINVOTES excluding
// those with status CAND_DROPPED. All candidates with the minumum
// number of votes have their status set to CAND_MINVOTES.
//
// EXAMPLE:
//
// tally_t t = {
//   .candidate_count = 4;
//   .candidate_names = {"Francis",   "Claire",      "Heather",    "Viktor"},
//   .candidate_status= {CAND_DROPPED, CAND_ACTIVE,   CAND_ACTIVE,  CAND_ACTIVE},
//   .candidate_vote_counts = {0,      4,             2,            2}
// }
// tally_set_minvote_candidates(&amp;t);
// t is now {
//   .candidate_count = 4;
//   .candidate_names = {"Francis",   "Claire",      "Heather",     "Viktor"},
//   .candidate_status= {CAND_DROPPED, CAND_ACTIVE,   CAND_MINVOTES, CAND_MINVOTES},
//   .candidate_vote_counts = {0,      4,             2,             2}
// }
//
// Two candidates have changed status to CAND_MINVOTES but the 0th
// candidate who has status CAND_DROPPED is ignored.
// 
// LOGGING: if the LOG_LEVEL is &gt;= LOG_MINVOTE, this function will
// print the following messages to standard out while running.
//
// "LOG: No MIN VOTE count found" : printed when the candidate count
// is 0 or all candidates have status CAND_DROPPED.
//
// "LOG: MIN VOTE count is XX" : printed after the minimum vote count is
// determined with XX substituted for the actual minimum vote count.
//
// "LOG: MIN VOTE count for candidate YY: ZZ\n" : printed for each
// candidate whose status is changed to CAND_MINVOTES with YY and ZZ
// as the candidate index and name.
</pre>
</div>
</div>
</div>

<div id="outline-container-org70a2658" class="outline-3">
<h3 id="org70a2658"><span class="section-number-3">4.6</span> Ending Conditions for Elections</h3>
<div class="outline-text-3" id="text-4-6">
<p>
To determine if an election has concluded, the Tally can be analyzed
to detect ending conditions. Ending conditions are associated with the
count of Active and Minvote candidates as described in the
documentation comments below. As in other places, this function
returns integers but should only return symbols associated with Tally
conditions as defined in <code>rcv.h</code>. These are:
</p>
<div class="org-src-container">
<pre class="src src-c">//rcv.h
// CONDITION of an election returned by the tally_condition() function
#define TALLY_ERROR    1         // something is wrong with the vote counts
#define TALLY_WINNER   2         // single active candidate who is the winner
#define TALLY_TIE      3         // an all-way tie which ends the election
#define TALLY_CONTINUE 4         // another round can be applied ot the tally
</pre>
</div>

<p>
The basic approach is to iterate through the candidates and total the
number of Active, Minvote, and Dropped candidates.  Then a series of
conditionals is used to determine if any of the ending conditions have
been met, defaulting to the Continiuing the election if not.
</p>

<div class="org-src-container">
<pre class="src src-c">int tally_condition(tally_t *tally);
// PROBLEM 1: Determine the current condition of the given tally which
// is one of {TALLY_ERROR TALLY_WINNER TALLY_TIE TALLY_CONTINUE}. The
// condition is determined by counting the status of candidates and
// returning a value based on the following circumstances.
// 
// - If any candidate has a status outher than CAND_ACTIVE,
//   CAND_MINVOTES, CAND_DROPPED, returns TALLY_ERROR as something has
//   gone wrong tabulations.
// - If there is only 1 ACTIVE candidate, returns TALLY_WINNER as 
//   the election has determined a winner
// - If there are 2 or more ACTIVE candidates, returns TALLY_CONTINUE as
//   additional rounds are needed to determine winner
// - If there are 0 ACTIVE candidates and 2 or more MINVOTE candidates,
//   returns TALLY_TIE as the election has ended with a Multiway Tie
// - Returns TALLY_ERROR in all other cases as something has gone wrong
//   in the tabulation (e.g. all candidates dropped, a single MINVOTE
//   candidate, some other bad state).
</pre>
</div>
</div>
</div>

<div id="outline-container-orge1ff1cb" class="outline-3 grading 30">
<h3 id="orge1ff1cb"><span class="section-number-3">4.7</span> Grading Criteria for Problem 1&#xa0;&#xa0;&#xa0;<span class="tag"><span class="grading">grading</span>&#xa0;<span class="30">30</span></span></h3>
<div class="outline-text-3" id="text-4-7">
<p>
The following criteria will be checked.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Weight</th>
<th scope="col" class="org-left">Criteria</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">AUTOMATED TESTS via <code>make test-prob1</code></td>
</tr>

<tr>
<td class="org-right">15</td>
<td class="org-left">Runs tests in <code>test_rcv1.org / test_rcv_funcs.c</code> on the Problem 1 functions in <code>rcv_funcs.c</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Runs all code under Valgrind to ensure that no memory errors are present.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">1 point per test passed</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">MANUAL INSPECTION</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left">Style</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Good indentation of code clearly denoting function/loop/conditional scopes</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of defined symbols like <code>NO_CANDIDATE</code> and <code>CAND_ACTIVE</code> rather than raw 1's and 3's, etc.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Limited nesting of code: 3 levels deep for loops/conditionals should be sufficient</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Avoids redundant cases which require same code to be copy/pasted in multiple spots</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><code>vote_print()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">In loop to print <code>candidate_order[]</code>, checks bounds on <code>MAX_CANDIDATES</code> and looks</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">for <code>NO_CANDIDATE</code> value to terminate loop</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><code>vote_next_candidate()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear checks of <code>pos</code> against <code>MAX_CANDIDATES</code> to avoid out of bounds access</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Checks for <code>NO_CANDIDATE</code> preference which causes it to immediately return</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><code>tally_print_table()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Section to total votes of all candidates</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of <code>printf()</code> format specifiers to align numbers, show single decimal place</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear identification of <code>DROPPED</code> candidates with special printing for them</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><code>tally_set_minvotes_candidates()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear loop to determine minimum vote count</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear loop to set <code>CAND_MINVOTE</code> status for appropriate candidates</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Detects case where there are is no minimum index as all candidates are Dropped</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Performs Log printing for appropriate log level</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><code>tally_condition()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear loop to count candidates of each status</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Case analysis to determine condtion to return</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


<div id="outline-container-org7c7a68d" class="outline-2">
<h2 id="org7c7a68d"><span class="section-number-2">5</span> Problem 2: Tally Mutation</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org8b465e3" class="outline-3">
<h3 id="org8b465e3"><span class="section-number-3">5.1</span> Creating Voters and Freeing Tallies</h3>
<div class="outline-text-3" id="text-5-1">
<p>
Later, when coding funcitonality to laod Votes and Tallies from files,
it will be useful to be able to allocate an empty "default" vote and
then fill it with the data from the file.  The <code>vote_make_empty()</code>
will be used for this as it heap allocates a vote and fills it with
default values. <code>vote_make_empty()</code> also makes writing test cases much
easier and many of the remaining tests will directly or inderctly use
it.
</p>

<div class="org-src-container">
<pre class="src src-c">vote_t *vote_make_empty();
// PROBLEM 2: Allocates a vote on the heap using malloc() and
// intitializes its id/pos fields to be -1, all of the entries in
// its candidate_order[] array to be NO_CANDIDATE, and the next field
// to NULL. Returns a pointer to that vote.
</pre>
</div>

<p>
The slightly complex data Tally data structure involves lists of Vote
nodes. When deallocating a Tally, these lists must be traversed and
each Vote in them free()'d before ultimately freeing the entire
Tally. This operation is complex enough that it deserves its own
de-allocation function.
</p>
<div class="org-src-container">
<pre class="src src-c">void tally_free(tally_t *tally);
// PROBLEM 2: De-allocates a tally and all its linked votes from the
// heap using free(). The entirety of the candidate_votes[] array is
// traversed and each list of votes in it is free()'d by iterating
// through each list and free()'ing each vote. Ends by free()'ing the
// tally itself.
</pre>
</div>
</div>
</div>

<div id="outline-container-org265b4b6" class="outline-3">
<h3 id="org265b4b6"><span class="section-number-3">5.2</span> Adding Votes to Tallies</h3>
<div class="outline-text-3" id="text-5-2">
<p>
When constructing Tallies, it is handy to have a function that
automatically places a Vote with the correct candidate based on the
preferences indicated within the vote (e.g. <code>vote-&gt;candidate_order[0]</code>
if <code>vote-&gt;pos</code> is 0).  This is needed when reading votes from data
files and adding them to a Tally and also makes it for much cleaner lookin
test cases. The following function is relatively short and
accomplishes this.
</p>

<div class="org-src-container">
<pre class="src src-c">void tally_add_vote(tally_t *tally, vote_t *vote);
// PROBLEM 2: Add the given vote to the given tally. The vote is
// assigned to candidate indicated by the vote-&gt;pos field and
// vote-&gt;candidate_order[] array.  The vote is prepended (added to the
// front) of the associated candidates list of votes and their vote
// count is incremented. This function is primarily used when
// initially populating a tally while other functions like
// tally_transfer_first_vote() are used when calculating elections.
//
// MAKEUP CREDIT: Votes whose preference is NO_CANDIDATE are prepended
// to the invalid_votes list with the invalid_vote_count incrementing.
</pre>
</div>
</div>
</div>

<div id="outline-container-org64ff4dd" class="outline-3">
<h3 id="org64ff4dd"><span class="section-number-3">5.3</span> Printing Tally Votes</h3>
<div class="outline-text-3" id="text-5-3">
<p>
For a detailed view of election calculations, it is worthwhile to see
the specific votes assigned to each candidate.  This output is
accomplished by the following function which utilizes the earlier
<code>vote_print()</code> function to format votes for output.
</p>

<div class="org-src-container">
<pre class="src src-c">void tally_print_votes(tally_t *tally);
// PROBLEM 2: Prints out the votes for each candidate in the tally
// which produces output like the following:
//
// VOTES FOR CANDIDATE 0: Andy
//   #0005:&lt;0&gt; 1  3  2  4 
//   #0004:&lt;0&gt; 1  2  3  4 
// 2 votes total
// VOTES FOR CANDIDATE 1: Bethany
// 0 votes total
// VOTES FOR CANDIDATE 2: Carl
//   #0002: 3 &lt;2&gt; 4  1  0 
//   #0003:&lt;2&gt; 1  0  3  4 
//   #0001:&lt;2&gt; 0  1  3  4 
// 3 votes total
// ...
//
// - Each set of votes is preceded by the headline
//   "VOTES FOR CANDIDATE XX: YY"
//   with XX and YY as the candidate index and name.
// - Each candidate vote is printed starting with 2 spaces, then via a
//   call to vote_print(); then a newline. The list of votes for a
//   particular candidate is printed via iteration through the list
//   following the `next` field of the vote_t struct.
// - Each candidate vote list is ended with a line reading
//   "ZZ votes total"
//   with ZZ replaced by the count of votes for that candidate.
// 
// MAKEUP CREDIT: If there are any invalide votes, an additional headline
// "INVALID VOTES"
// is printed followed by a listing of invalid votes in the same
// format as above and ending with a line showing the total invalid
// votes.
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdb64c7b" class="outline-3">
<h3 id="orgdb64c7b"><span class="section-number-3">5.4</span> Dropping Candidates and Transferring Votes</h3>
<div class="outline-text-3" id="text-5-4">
<p>
During a round, the candidates with the Minimum Vote count will be
Dropped from the election.  Before doing so, all the votes assigned to
the candidate are transferred to the next preferred candidate in the
Vote.  This functionality is split into two functions:
</p>
<ul class="org-ul">
<li><code>tally_transfer_first_vote(tally, idx)</code> will transfer the first vote
for the candidate at index <code>idx</code> to that Votes next choice. The next
choice is determined via call to <code>vote_next_candidate()</code> which was
previoulsy written. For efficiency, the Vote is moved to the front
of the list for the next choice candidate</li>
<li><code>tally_drop_minvote_candidates(tally)</code> will iterate over all
candidates. Any candidate which has status <code>CAND_MINVOTES</code> will have
<code>tally_transfer_first_vote()</code> called on it repeatedly to empty its
vote list before being assigned status <code>CAND_DROPPED</code>.</li>
</ul>
<p>
These functions require a bit of care as the involve linked list
manipulations. However, since all changes happen at the beginning of
lists, the functions will have low runtime complexity and not be
overly long to implement.
</p>

<p>
<b>Make sure to print Log messages accoding to the documentation
comments when <code>LOG_LEVEL</code> is sufficiently high.</b>
</p>

<div class="org-src-container">
<pre class="src src-c">void tally_transfer_first_vote(tally_t *tally, int candidate_index);
// PROBLEM 2: Transfer the first vote for the candidate at
// `candidate_index` to the next candidate indicated on the vote. This
// is usually done when the indicated candidate is being dropped from
// the election and their votes are being re-assigned to others.
//
// # COUNT NAME    VOTES
// 0     4 Francis #0008: 3 &lt;0&gt; 2  1 #0009:&lt;0&gt; 1  2  3 #0005:&lt;0&gt; 1  2  3 #0001:&lt;0&gt; 3  2  1 
// 1     2 Claire  #0004:&lt;1&gt; 0  2  3 #0002:&lt;1&gt; 0  2  3 
// 2     4 Heather #0010:&lt;2&gt; 0  1  3 #0007:&lt;2&gt; 0  1  3 #0006:&lt;2&gt; 1  0  3 #0003:&lt;2&gt; 1  0  3 
// 3     0 Viktor
//
// transfer_first_vote(tally, 1);  // Claire's first vote to Francis
//
// # COUNT NAME    VOTES
// 0     5 Francis #0004:&lt;1&gt; 0  2  3 #0008: 3 &lt;0&gt; 2  1 #0009:&lt;0&gt; 1  2  3 #0005:&lt;0&gt; 1  2  3 #0001:&lt;0&gt; 3  2  1 
// 1     1 Claire  #0002:&lt;1&gt; 0  2  3 
// 2     4 Heather #0010:&lt;2&gt; 0  1  3 #0007:&lt;2&gt; 0  1  3 #0006:&lt;2&gt; 1  0  3 #0003:&lt;2&gt; 1  0  3 
// 3     0 Viktor
//
// Note that vote #0002 moves from the front of Claire's list to the
// front of Francis's list.  The `candidate_vote_count[]` array is
// also updated. The function vote_next_candidate(vote) is used to
// alter the vote to reflect the voters next preferred candidate and
// that function's return value is used to determine the destination
// candidate for the transfer. If the candidate at `candidate_index`
// has no votes (vote list is empty), this function does nothing and
// immediately returns.
//
// LOGGING: if LOG_LEVEL &gt;= LOG_VOTE_TRANSFERS then the following message
// is printed:
// "LOG: Transferred Vote #0002: 1 &lt;0&gt; 2  3  from 1 Claire to 0 Francis"
// where the details are adapted to the actual data. Make use of the
// vote_print() function to show the vote.
//
// MAKEUP CREDIT: Votes which return a NO_CANDIDATE result from
// vote_next_candidate() are moved to the invalid_votes list with a
// message to that effect printed:
// "Transferred Vote #0002: 1 &lt;0&gt; 2  3  from 1 Claire to Invalid Votes"

void tally_drop_minvote_candidates(tally_t *tally);
// PROBLEM 2: All candidates with the status CAND_MINVOTES have their
// votes transferred to other candidates via repeated calls to
// tally_transfer_first_vote(). Those with status CAND_MINVOTE are
// changed to have CAND_DROPPED to indicate they are no longer part of
// the election.
//
// LOGGING: If LOG_LEVEL &gt;= LOG_DROP_MINVOTES, prints the following
// for each MINVOTE candidate that is DROPPED:
// "LOG: Dropped Candidate XX: YY"
// with XX and YY as the candidate index and name respectively.
</pre>
</div>
</div>
</div>

<div id="outline-container-org961b65b" class="outline-3">
<h3 id="org961b65b"><span class="section-number-3">5.5</span> Running an Election</h3>
<div class="outline-text-3" id="text-5-5">
<p>
With all of the previous functions in place, all that remains is to
execute the "algorithm" associated with an Election to calculate its
results.  RCV elections end with either a Winner or multi-way
Tie. These can be deteceted for a Tally via a call to
<code>tally_condition()</code>. Alternatively, the condition may be to Continue
in which case another round is required to make progress. The
documentation comments below give the basic flow of the algorithm and
should be studied closely.
</p>

<p>
A few additional hints.
</p>
<ul class="org-ul">
<li>Use a loop of some sort and track a counter to report the</li>
</ul>

<div class="org-src-container">
<pre class="src src-c">void tally_election(tally_t *tally);
// PROBLEM 2: Executes an election on the given tally.  Repeatedly
// performs the following operations.
//
// - Prints a headline "=== ROUND NN ===" with NN starting at 1 and
//   incrementing each round of the election
// - Drops the minimum vote candidates from the tally; in the first round
//   there will be no MINVOTE candidates but subsequent rounds may have 1
//   or more
// - Prints a table of the current tally state
// - If the LOG_LEVEL &gt;= LOG_SHOWVOTES or more, print all votes for all
//   candidates using an appropriate function; otherwise don't print
//   anything
// - Determine the MINVOTE candidate(s) and cycle to the next round
// Rounds continue while the Condition of the tally is
// TALLY_CONTINUE. When the election ends, one of the following messages
// is printed.
// - If a WINNER was found, print
//   "Winner: XX (candidate YY)"
//   with XX as the candidate name and YY as their index
// - If a TIE resulted, print each candidate that tied as in
//   "Multiway Tie Between:"
//   "AA (candidate XX)"
//   "BB (candidate YY)"
//   "CC (candidate ZZ)"
//   with AA,BB,CC as the candidate names and XX,YY,ZZ their indices.
// - If an ERROR in the election occurred, print
//   "Something is rotten in the state of Denmark"
// 
// To print out winners / tie members, this function will iterate
// through the candidate_status[] array to examine the status of each
// candidate. A single winner will be the only CAND_ACTIVE candidate
// while members of a TIE will each have the state CAND_MINVOTES with no
// ACTIVE candidate.
//
// At LOG_LEVEL=0, the output for this function looks like the
// following:
// === ROUND 1 ===
// NUM COUNT %PERC S NAME
//   0     4  33.3 A Francis
//   1     2  16.7 A Claire
//   2     5  41.7 A Heather
//   3     1   8.3 A Viktor
// === ROUND 2 ===
// NUM COUNT %PERC S NAME
//   0     5  41.7 A Francis
//   1     2  16.7 A Claire
//   2     5  41.7 A Heather
//   3     -     - D Viktor
// === ROUND 3 ===
// NUM COUNT %PERC S NAME
//   0     7  58.3 A Francis
//   1     -     - D Claire
//   2     5  41.7 A Heather
//   3     -     - D Viktor
// Winner: Francis (candidate 0)
</pre>
</div>
</div>
</div>

<div id="outline-container-org969de3e" class="outline-3 grading 40">
<h3 id="org969de3e"><span class="section-number-3">5.6</span> Grading Criteria for Problem 2&#xa0;&#xa0;&#xa0;<span class="tag"><span class="grading">grading</span>&#xa0;<span class="40">40</span></span></h3>
<div class="outline-text-3" id="text-5-6">
<p>
The following criteria will be checked.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Weight</th>
<th scope="col" class="org-left">Criteria</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">AUTOMATED TESTS via <code>make test-prob2</code></td>
</tr>

<tr>
<td class="org-right">20</td>
<td class="org-left">Runs tests in <code>test_rcv2.org / test_rcv_funcs.c</code> on the Problem 2 functions in <code>rcv_funcs.c</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Runs all code under Valgrind to ensure that no memory errors are present.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">1 point per test passed</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">MANUAL INSPECTION</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left">Style</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Good indentation of code clearly denoting function/loop/conditional scopes</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of defined symbols like <code>NO_CANDIDATE</code> and <code>CAND_ACTIVE</code> rather than raw 1's and 3's, etc.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Limited nesting of code: 3 levels deep for loops/conditionals should be sufficient</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Avoids redundant cases which require same code to be copy/pasted in multiple spots</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><code>vote_make_empty()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of <code>malloc()</code> to heap allocate</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Proper initialization of fields to -1, <code>NO_CANDIDATE</code>, or <code>NULL</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><code>tally_free()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear iteration to free entire lists of votes</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Tally struct not free()'d until after lists free()'d</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><code>tally_add_vote()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Adds votes to the front of candidate lists; increments the associated vote count</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Adds to the candidate indicated at vote's <code>pos</code> field</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><code>tally_print_votes()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of <code>vote_print()</code> to format votes</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clearly iterates through vote lists for each candidate</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><code>tally_transfer_first_vote()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Uses <code>vote_next_candidate()</code> to advance a vote and determine target candidate for transfer</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Properly adjusts the list associated with candidate losing the vote which may become <code>NULL</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Performs Log printing for appropriate log level</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><code>tally_drop_minvote_candidates()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Iteration over all candidates to deal with multiple Minvote candidates</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Repeated calls to <code>tally_transfer_first_vote()</code> to remove votes</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Performs Log printing for appropriate log level</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left"><code>tally_election()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear loop associated with each ROUND of the election</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Uses previously defined functions to check the Tally Condition, Drop candidates, identify Minvotes</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Does case analysis to determine Winner / Tie / Error results and prints appropriate messages</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Performs Log printing for appropriate log level</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


<div id="outline-container-org98a5ce5" class="outline-2">
<h2 id="org98a5ce5"><span class="section-number-2">6</span> Problem 3: Data Files and Main</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org2103f0d" class="outline-3">
<h3 id="org2103f0d"><span class="section-number-3">6.1</span> Vote Data Files</h3>
<div class="outline-text-3" id="text-6-1">
<p>
Voting machinery that is in elections will often involve scanning a
form that is filled out by the voter and then converting the contents
of many such ballots into a data file. A simple version of such an
aggregate looks like the following. Comments on contents of the file
appear after # marks and are not actually part of the file.
</p>
</div>

<div id="outline-container-orgfac6218" class="outline-4">
<h4 id="orgfac6218">EXAMPLE 1: 4 candidates, 6 votes</h4>
<div class="outline-text-4" id="text-orgfac6218">
<div class="org-src-container">
<pre class="src src-python">4                               # first token in number of candidates
Francis Claire Heather Viktor   # names of the 4 candidate
0 3 2 1                         # vote #0001 with preference of 4 candidates
1 0 2 3                         # vote #0002 with preference of 4 candidates
2 1 0 3                         # etc.
2 1 0 3 
1 0 2 3 
0 2 1 3 
</pre>
</div>
</div>
</div>

<div id="outline-container-org09b92a3" class="outline-4">
<h4 id="org09b92a3">EXAMPLE 2: 5 candidates, 7 votes</h4>
<div class="outline-text-4" id="text-org09b92a3">
<div class="org-src-container">
<pre class="src src-python">5                              # first token in number of candidates
Al Bo Ce Di Ed                 # names of the 5 candidate
2 0 1 3 4                      # vote #0001 preference of 5 candidates
3 2 4 1 0                      # etc.
2 1 0 3 4 
0 1 2 3 4 
0 1 3 2 4 
3 2 4 1 0 
2 1 0 3 4 
</pre>
</div>
</div>
</div>

<div id="outline-container-org69f74e9" class="outline-4">
<h4 id="org69f74e9">Other Examples</h4>
<div class="outline-text-4" id="text-org69f74e9">
<p>
There are a variety of other examples of vote data files in the
<code>data/</code> directory for the project. Many of these files are used in
testing so DON'T DELETE THE data/ DIRECTORY.
</p>
</div>
</div>
</div>

<div id="outline-container-orgf493c62" class="outline-3">
<h3 id="orgf493c62"><span class="section-number-3">6.2</span> Loading Vote Data</h3>
<div class="outline-text-3" id="text-6-2">
<p>
Data is loaded from files into a Tally via the following
function. <b>This is the most complex function the project</b> so expect to
take some time to get it right.
</p>
<div class="org-src-container">
<pre class="src src-c">tally_t *tally_from_file(char *fname);
// PROBLEM 3: Opens the given `fname` and reads its contents to create
// a tally with votes assigned to candidates.  
// ...
//
// This function heap-allocates a tally_t struct then begins reading
// information from the file into the fields of that struct starting
// with the number of candidates and their names.  A loop is then used
// to iterate reading votes until the End of the File (EOF) is
// reached.  On determining that there is a vote to read, an empty
// vote_t is allocated using vote_make_empty() and the order
// preference of candidates is read into the vote along with
// initializing its pos and id fields. It is then added to the tally
// via tally_add_vote() before iterating to try to read another vote.
// 
// This function makes heavy use of fscanf() to read data and checks
// the return value of fscanf() at times to determine if the end of a
// file has been reached. On reaching the end of the input, the file
// is closed and the completed tally is returned
//
// ERROR CASES: Near the beginning of its operation, this function
// checks that the specified file is opened successfully. If not, it
// prints the message
// "ERROR: couldn't open file 'XX'"
// with XX as the filename. NULL is returned in this case.
//
// Aside from failure to open a file, this function assumes that the
// data is formatted correctly and does no other error handling.
// - The first token is NCAND, the number of candidates
// - The next tokens are NCAND strings which are the candidate names
// - Each subsequent vote has exactly NCAND integers
// Bad input data that does not follow the above conventions will
// cause this function to have unpredictable behavior that is not
// tested.
//
// LOGGING: If LOG_LEVEL &gt;= LOG_FILEIO, this function prints the
// following messages which show the progress of the function.
</pre>
</div>

<p>
Some hints and notes on implementing the function.
</p>
<ul class="org-ul">
<li>Document your work with comments. This function is longer than the
others and has several "stages" so including comments on what is
happening at each stage is both a good policy and <b>required for full
credit</b>.  Comments don't need to be too verbose but commentary like
"Reading number of candidates" and "Reading all candidate names" and
"attempting to read another vote" help to indicate the intent of
otherwise obscure I/O calls.</li>
<li>You'll need to utilize the <code>fopen(), fclose(),</code> and <code>fscanf()</code>
functions throughout this function. These will be covered in lecture
and lab work with a recent lab demonstrating similar techniques on
how to read in data from files to build a data structure. Draw on
those experiences to implement this function.</li>
<li>The first part of Vote files are easy to read as they comprise a
number of candidates followed by that many candidate names. To store
the names (and remaining data) you'll need to allocate a Tally
struct to store them in.  Do so on the Heap as the Tally will
eventually be returned from this function.</li>
<li>There is no special "make Tally" function: you may write one
yourself or just use <code>malloc()</code> to allocate a Tally and initialize
its fields. <b>Just don't forget to initialize the fields of the
Tally</b>: not setting pointers to NULL or integers to 0 will likely
lead to bad results later.</li>
<li>Votes files <b>do not specify how many votes are in them</b>. This will
require a certain style of reading that boils down to
<ul class="org-ul">
<li>Try to read the first part of vote</li>
<li>If input fails due to reaching the end of a file, there are no
more votes and file input can end: <b>make sure you find out how to
check if <code>fscanf()</code> fails due to reaching the end of a file</b></li>
<li>If successful, read the remainder the data into an allocated
struct and add the new Vote to the growing Tally before iterating
again</li>
</ul></li>
<li>Each vote are made up of a sequence of candidate indices; for vote
files with 5 candidates, each vote has 5 numbers; with 8 candidates,
each vote has 8 numbers. To read a full vote, a loop is required.</li>
<li>It may be worthwhile to implement <code>main()</code> as described below before
finishing this function so that you can experiment with loading
files in the <code>data/</code> directory and set the <code>LOG_LEVEL</code> to
<code>LOG_FILEIO</code> (5) to see log messages printed while the file is
loaded. This can be extremely helpful for debugging.</li>
</ul>
</div>
</div>

<div id="outline-container-org80cc8a8" class="outline-3">
<h3 id="org80cc8a8"><span class="section-number-3">6.3</span> The Main Function</h3>
<div class="outline-text-3" id="text-6-3">
<p>
The final part of the RCV application is to code a <code>main()</code>
function. Unlike the "service" or "helper" functions, <code>main()</code> should
be in its own file, <code>rcv_main.c</code>.  Create this file, and a <code>main()</code>
prototype that allows for command line arguments to be passed
in. Don't forget to include the project header as otherwise this
separate file will not be able to use the various functions in
<code>rcv_funcs.c</code>.
</p>
<div class="org-src-container">
<pre class="src src-c">#include "rcv.h"
int main(int argc, char *argv[]){
  ...
}
</pre>
</div>
<p>
The <code>rcv_main.c</code> file will be compiled to <code>rcv_main</code> using the
included <code>Makefile</code> and this program has two required command line
forms it must support.
</p>
<ol class="org-ol">
<li>Only the data file with the votes is passed in</li>
<li>A <code>-log N</code> option appears preceding the data file. This sets the
global variable <code>LOG_LEVEL</code> which will trigger additional output to
be printed.</li>
</ol>

<p>
Examples of these two command line forms are below.
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; ./rcv_main data/votes-sample.txt           # Form 1: argc=2, only data file 
=== ROUND 1 ===                               # on command line
NUM COUNT %PERC S NAME
  0     4  33.3 A Francis
  1     2  16.7 A Claire
  2     5  41.7 A Heather
  3     1   8.3 A Viktor
=== ROUND 2 ===
NUM COUNT %PERC S NAME
  0     5  41.7 A Francis
  1     2  16.7 A Claire
  2     5  41.7 A Heather
  3     -     - D Viktor
=== ROUND 3 ===
NUM COUNT %PERC S NAME
  0     7  58.3 A Francis
  1     -     - D Claire
  2     5  41.7 A Heather
  3     -     - D Viktor
Winner: Francis (candidate 0)

&gt;&gt; ./rcv_main -log 2 data/votes-sample.txt    # form 2: argc=4, -log option passed
=== ROUND 1 ===                               # to specify log level, then data file
NUM COUNT %PERC S NAME
  0     4  33.3 A Francis
  1     2  16.7 A Claire
  2     5  41.7 A Heather
  3     1   8.3 A Viktor
LOG: MIN VOTE count is 1                      # Log messages for Minvotes printed
LOG: MIN VOTE COUNT for candidate 3: Viktor
=== ROUND 2 ===
LOG: Dropped Candidate 3: Viktor              # Log messages for Dropped candidates printed
NUM COUNT %PERC S NAME
  0     5  41.7 A Francis
  1     2  16.7 A Claire
  2     5  41.7 A Heather
  3     -     - D Viktor
LOG: MIN VOTE count is 2
LOG: MIN VOTE COUNT for candidate 1: Claire
=== ROUND 3 ===
LOG: Dropped Candidate 1: Claire
NUM COUNT %PERC S NAME
  0     7  58.3 A Francis
  1     -     - D Claire
  2     5  41.7 A Heather
  3     -     - D Viktor
LOG: MIN VOTE count is 5
LOG: MIN VOTE COUNT for candidate 2: Heather
Winner: Francis (candidate 0)
</pre>
</div>

<p>
To get insight into how command line arguments are received in the
<code>argc / argv[]</code> parameters to <code>main()</code>, study the provided
<code>cmdline_args.c</code> program which prints command line arguments passed to
its executable.
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; gcc cmdline_args.c
&gt;&gt; ./a.out
There are 1 command line arguments
arg 0: './a.out'
&gt;&gt; ./a.out apple banana peach
There are 4 command line arguments
arg 0: './a.out'
arg 1: 'apple'
arg 2: 'banana'
arg 3: 'peach'
...
</pre>
</div>

<p>
A few other hints
</p>
<ul class="org-ul">
<li>It is a good idea to check that the number of command line arguments
is either 2 (Form 1) and 4 (Form 2) and if not, bail out from the
program. This won't be tested but it simplifies the rest of the
program.</li>
<li>All command line arguments come into C programs as strings
(<code>char*</code>).  That means the number after the <code>-log</code> option will also
be a string of characters and needs to be converted to an <code>int</code> to
be used in the program.  The <code>atoi()</code> function is useful for this:
search for documentation on it and use it for the conversion.</li>
<li><p>
Make sure to check that loading Votes from a file into a Tally
succeeds. If not, print the following error message:
</p>
<pre class="example">
Could not load votes file. Exiting with error code 1
</pre>

<p>
then return 1 to indicate that the program was not successful.
</p></li>
<li>If a Tally is successfully loaded, run an election on it. Don't
forget to free its memory before ending the program.</li>
</ul>
</div>
</div>

<div id="outline-container-orge524f2c" class="outline-3 grading 30">
<h3 id="orge524f2c"><span class="section-number-3">6.4</span> Grading Criteria for Problem 3&#xa0;&#xa0;&#xa0;<span class="tag"><span class="grading">grading</span>&#xa0;<span class="30">30</span></span></h3>
<div class="outline-text-3" id="text-6-4">
<p>
The following criteria will be checked.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Weight</th>
<th scope="col" class="org-left">Criteria</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">AUTOMATED TESTS via <code>make test-prob3</code></td>
</tr>

<tr>
<td class="org-right">15</td>
<td class="org-left">Runs tests in <code>test_rcv3.org / test_rcv_funcs.c</code> on the Problem 2 functions in <code>rcv_funcs.c</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Runs all code under Valgrind to ensure that no memory errors are present.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">1 point per test passed</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">MANUAL INSPECTION</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left">Style</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Good indentation of code clearly denoting function/loop/conditional scopes</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of defined symbols like <code>NO_CANDIDATE</code> and <code>CAND_ACTIVE</code> rather than raw 1's and 3's, etc.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Limited nesting of code: 3 levels deep for loops/conditionals should be sufficient</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Avoids redundant cases which require same code to be copy/pasted in multiple spots</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">7</td>
<td class="org-left"><code>tally_load_from_file()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear comments indicating stages of file processing  / what is being read or done</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Checks for failure to open a file and returns</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clearly marked code sections to read candidate names</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clearly marked code sections to read votes until the end of file is reached</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Performs Log printing for appropriate log level</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left"><code>main()</code> in <code>rcv_main.c</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Case analysis of arguments to detect 2 or 4 arguments</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of <code>atoi()</code> to convert strings to <code>ints</code> when needed</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Checks for failure to load vote file</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-orgf49689b" class="outline-2">
<h2 id="orgf49689b"><span class="section-number-2">7</span> Optional MAKEUP Credit</h2>
<div class="outline-text-2" id="text-7">
<p>
Some additional credit will be available for completing an optional
part of the project which will be described after the initial release
in this section.
</p>

<p>
Certain parts of the documentation comments mention MAKEUP credit
functionality. You may implement this now as it will play a part in
earning MAKEUP Credit.
</p>
</div>
</div>

<div id="outline-container-orgaf90b13" class="outline-2">
<h2 id="orgaf90b13"><span class="section-number-2">8</span> Project Submission</h2>
<div class="outline-text-2" id="text-8">
</div>

<div id="outline-container-orgb432ad6" class="outline-3">
<h3 id="orgb432ad6"><span class="section-number-3">8.1</span> <a id="org10830e0"></a> Submit to Gradescope</h3>
<div class="outline-text-3" id="text-8-1">
<p>
Some of the pictures below are dated and contain out of sync info
like:
</p>
<ul class="org-ul">
<li>'Assignment' rather than'Project'</li>
<li>Class code 'CSCI 2021' rather than 'CMSC216'</li>
<li>Mention some files that are not part of the current project</li>
<li>May indicate some other zip name when <code>p1-complete.zip</code> is that
default name of the zip for completed projects.</li>
</ul>
<p>
However, most students should have no trouble adapting these
instructions which amount to: <code>make zip</code> then upload the zip to
Gradescope. 
</p>

<ol class="org-ol">
<li><p>
In a terminal, change to your project code directory and type <b>make
zip</b> which will create a zip file of your code. A session should
look like this:
</p>
<div class="org-src-container">
<pre class="src src-sh">   &gt; cd 216-sync/p1-code         # location of assignment code

   &gt; ls 
   Makefile    rcv_main.c  rcv_funcs.c  data/
   ...

   &gt; make zip                     # create a zip file using Makefile target
   rm -f p1-complete.zip
   cd .. &amp;&amp; zip "p1-code/p1-complete.zip" -r "p1-code"
     adding: p1-code/ (stored 0%)
     adding: p1-code/Makefile (deflated 68%)
     adding: p1-code/test_prob1.org (deflated 69%)
     ...
   Zip created in p1-complete.zip

   &gt; ls p1-complete.zip
   p1-complete.zip
</pre>
</div></li>
<li><p>
Log into <a href="https://www.gradescope.com/">Gradescope</a> and locate and click 'Project 1' which will
open up submission
</p>
<div class="org-center">

<div id="org813d144" class="figure">
<p><img src="gradescope01.png" alt="gradescope01.png" style="max-width:100%;" />
</p>
</div>
</div></li>
<li><p>
Click on the 'Drag and Drop' text which will open a file selection
dialog; locate and choose your <code>p1-complete.zip</code> file (<i>The
pictures below may use a different zip name like <code>a1-code.zip</code></i>)
</p>
<div class="org-center">

<div id="org73dd056" class="figure">
<p><img src="gradescope02.png" alt="gradescope02.png" style="max-width:100%;" />
</p>
</div>
</div></li>
<li><p>
This will show the contents of the Zip file and should include your
C source files along with testing files and directories. 
</p>
<div class="org-center">

<div id="org7fc8403" class="figure">
<p><img src="gradescope03.png" alt="gradescope03.png" style="max-width:100%;" />
</p>
</div>
</div></li>
<li><p>
Click 'Upload' which will show progress uploading files.  It may
take a few seconds before this dialog closes to indicate that the
upload is successful. Note: there is a limit of 256 files per
upload; normal submissions are not likely to have problems with
this but you may want to make sure that nothing has gone wrong such
as infinite loops creating many files or incredibly large files. 
</p>

<p>
<b>WARNING</b>: There is a limit of 256 files per zip. Doing <code>make zip</code>
will warn if this limit is exceeded but uploading to Gradescope
will fail without any helpful messages if you upload more the 256
files in a zip. 
</p>

<div class="org-center">

<div id="org3401764" class="figure">
<p><img src="gradescope04.png" alt="gradescope04.png" style="max-width:100%;" />
</p>
</div>
</div></li>

<li><p>
Once files have successfully uploaded, the Autograder will begin
running the command line tests and recording results.  These are
the same tests that are run via <code>make test</code>.   
</p>
<div class="org-center">

<div id="org94f09ab" class="figure">
<p><img src="gradescope05.png" alt="gradescope05.png" style="max-width:100%;" />
</p>
</div>
</div></li>
<li><p>
When the tests have completed, results will be displayed
summarizing scores along with output for each batch of tests.
</p>
<div class="org-center">

<div id="org4cc88fc" class="figure">
<p><img src="gradescope06.png" alt="gradescope06.png" style="max-width:100%;" />
</p>
</div>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org3f6c681" class="outline-3">
<h3 id="org3f6c681"><span class="section-number-3">8.2</span> Late Project Submission Policies</h3>
<div class="outline-text-3" id="text-8-2">
<p>
You may wish to review the policy on late project submission which
will cost 1 Engagement Point per day late. <b>No projects will be
accepted more than 48 hours after the deadline.</b>
</p>

<p>
<a href="https://www.cs.umd.edu/~profk/216/syllabus.html#late-submission">https://www.cs.umd.edu/~profk/216/syllabus.html#late-submission</a>
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr/> <i> <a href="https://www.umd.edu/web-accessibility" title="UMD Web Accessibility">Web Accessibility</a> <br/> Author: Chris Kauffman (<a href="mailto:profk@umd.edu">profk@umd.edu</a>) <br/> Date: 2024-09-11 Wed 14:37 <br/> </i>
</div>
</body>
</html>
