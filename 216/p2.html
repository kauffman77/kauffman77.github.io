<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-03-04 Tue 21:22 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CMSC216 Project 2: Bit Ops, Debugging, Data Structures</title>
<meta name="author" content="Chris Kauffman" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<meta name="viewport" content="width=device-width, maximum-scale=1, minimum-scale=1" />
<style type="text/css">
@media screen {
:root {
--heading-bg-color:#e21833;
--heading-fg-color:#ffd200;
}
html {
font-family: serif;
text-align: justify;
}
pre.src, pre.example {
overflow-x: scroll;
}
/* Merge subtitle area with title area */
.subtitle {
text-align: center;
margin-top: -2em;
padding-top: 1em;
padding-bottom: 0.1em;
}
.title, .subtitle {
color: var(--heading-fg-color);
background-color: var(--heading-bg-color);
}
/* Section borders, left section header style */
div.outline-2, #table-of-contents {
background-color: rgb(250,250,250);
border: 0.75em solid var(--heading-bg-color);
border-top: 0em;
padding: 0em .5em .5em .5em; /* top right bottom left */
margin: 1em 0em 1em 0em; /* top right bottom left */
}
div.outline-2 > h2, #table-of-contents > h2 {
background-color: var(--heading-bg-color);
color: var(--heading-fg-color);
font-variant: small-caps;
padding: 0em 0em 0em .5em; /* top right bottom left */
margin: 0em -.5em 0em -.75em; /* top right bottom left */
text-align: left;
}
blockquote {
font-style: italic;
}
td, th {
padding-top: 2px;
padding-bottom: 2px;
}
body {
background-color: #EEE;
}
pre {
}
#content, #preamble, #postamble {
margin-left:300px;
max-width: 100%;
}
.tag {
background-color: inherit; font-family: inherit;
padding: inherit; font-size: 80%; font-weight: inherit;
text-transform: uppercase;
}

.figure p { text-align: inherit; }
figure-number { font-style: italic; }
#table-of-contents {
text-align: left;
position: fixed;
left: 0;
margin: 0 auto;
padding: 0;
width: 300px;
top: 0;
height: 100%;
border: 0;
display: block;
}
#text-table-of-contents {
overflow-y: scroll;
height: 100%;
}
#text-table-of-contents ul {
padding-left: 1em;
margin-left: 0.5em;
}
#table-of-contents > h2 {
padding: 0.1em;
margin: 0;
}
/* adjustments for small screen, toc at top only */
@media (max-width: 800px) { /* landscape for iphone */
html {
-webkit-text-size-adjust: none;  /* prevent scaling of text on mobile */
}
body {
background-color: #EEE;
width:100%;
margin:0 auto;
}
#content, #preamble, #postamble {
margin-left:0;
}
#table-of-contents {
position: static;
left: inherit;
width:inherit;
height: auto;
border-top: 0em;
padding: 0em .5em .5em .5em; /* top right bottom left */
margin: 1em 0em 1em 0em; /* top right bottom left */
border: 0.75em solid #006633;
}
div.outline-2, #table-of-contents {
background-color: rgb(250,250,250);
border: 0.75em solid var(--heading-bg-color);
border-top: 0em;
padding: 0em .5em .5em .5em; /* top right bottom left */
margin: 1em 0em 1em 0em; /* top right bottom left */
}
div.outline-2 > h2, #table-of-contents > h2 {
background-color: var(--heading-bg-color);
color: var(--heading-fg-color);
font-variant: small-caps;
padding: 0em 0em 0em .5em; /* top right bottom left */
margin: 0em -.5em 0em -.75em; /* top right bottom left */
text-align: left;
}
#text-table-of-contents {
overflow-y: visible;
height: inherit;
}
#text-table-of-contents ul {
padding-left: 1em;
margin-left: 0.5em;
}
}
.linenr { font-size: xx-small; }
th.org-left   { text-align: left;   }
}

@media print {
html {
font-family: serif;
font-size: 10pt;
text-align: justify;
.linenr { font-size: xx-small; }
}
}
</style>
<style>
/* Theme: Srcery
Description: Srcery dark color scheme for highlight.js
Author: Chen Bin <chen.bin@gmail.com>
Maintainer: @redguardtoo
Website: https://srcery-colors.github.io/
Date: 2021-04-13
https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/srcery.css

Tailored by: Chris Kauffman <profk@umd.edu>
Date: Sat Nov 25 06:16:20 PM EST 2023
*/
pre code.hljs {
display: block;
overflow-x: auto;
padding: 1em
}
code.hljs {
padding: 3px 5px
}
.hljs {
background: #1C1B19;
/* Black */
color: #FFFFFF/* Bright White */

}
/* Bright White */
.hljs-subst,
.hljs-quote,
.hljs-literal {
color: #FCE8C3
}
/* Bright Blue */
.hljs-type,
.hljs-symbol {
color: #68A8E4
}
/* Red */
.hljs-keyword,
.hljs-deletion {
color: #EF2F27
}
/* Yellow */
.hljs-name,
.hljs-function,
.hljs-attribute,
.hljs-selector-attr,
.hljs-selector-id,
.hljs-selector-class,
.hljs-selector-pseudo,
.hljs-section,
.hljs-title {
color: #FBB829
}
/* Cyan */
.hljs-code,
.hljs-variable,
.hljs-property,
.hljs-template-variable,
.hljs-class {
color: #0AAEB3
}
/* Bright Green */
.hljs-string,
.hljs-regexp,
.hljs-bullet,
.hljs-addition {
color: #98BC37
}
/* Bright Magenta */
.hljs-built_in,
.hljs-params {
color: #FF5C8F
}
/* Blue */
.hljs-template-tag,
.hljs-selector-tag {
color: #2C78BF
}
/* Bright Black */
.hljs-link,
.hljs-number,
.hljs-comment,
.hljs-meta {
color: #B1B195
/* color: #918175 */
}
.hljs-emphasis {
font-style: italic
}
.hljs-strong {
font-weight: bold
}
/* @see https://github.com/srcery-colors/srcery-emacs for reference */
</style>

<link rel="stylesheet" href="./srcery-ck.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
function interactive_lang() {      // define a custom "interactive" language
return {
name: 'interactive',           // language name
keywords: {
$pattern: /[^ \t\n]+/,       // lex based on non-whitespace
keyword: [">>","(shellac)","HM>","TM>","HS>","homeputer>","grace3:","grace4:","grace5:","grace6:","grace7:","grace8:","grace9:","grace10:","grace3>>","grace4>>","grace5>>","grace6>>","grace7>>","grace8>>","grace9>>","grace10>>"], // allowed interactive prompts
},
contains: [
// hljs.HASH_COMMENT_MODE,   // use standard hash comments, any # is a comment
hljs.COMMENT(/#+ /, /$/),    // use custom comment of # w/ whitespace
hljs.COMMENT(/#+/, /$/),     // and a sequence of hashes
]
};
};
hljs.registerLanguage('interactive', interactive_lang);     // register custom language

// Add highlighjs CSS classes to elemens marked with relevant org classes
lang_map = new Map();              // map of org to hljs languages
lang_map.set("src-c"     , "language-c");
lang_map.set("src-python", "language-python");
lang_map.set("src-text"  , "language-plaintext");
lang_map.set("src-sh"    , "language-interactive");
function add_class(el) {           // applied to each pre.src element
for (let [org_lang, hljs_lang] of lang_map) {
if(el.classList.contains(org_lang)){
el.classList.add(hljs_lang);
}
}
}
// visit all pre.src elements and apply function to add language class
document.querySelectorAll('pre.src').forEach(add_class);
hljs.configure({cssSelector: 'pre'}); // select pre blocks only to highligh
hljs.highlightAll();                  // perform highlighting on all pre blocks
});
</script>
</head>
<body>
<div id="preamble" class="status">
<i>Last Updated: 2025-03-04 Tue 21:22</i>
</div>
<div id="content" class="content">
<h1 class="title">CMSC216 Project 2: Bit Ops, Debugging, Data Structures</h1>
<ul class="org-ul">
<li><b>Due: 11:59pm Fri 14-Mar-2025</b></li>
<li><i>Approximately 4.0% of total grade</i></li>
<li>Submit to <a href="https://www.gradescope.com/"><b>Gradescope</b></a></li>
<li>Projects are <b>individual work</b>: no collaboration with other students
is allowed. Seek help from course staff if you get stuck for too long.</li>
</ul>

<div id="outline-container-orgb906afd" class="outline-4">
<h4 id="orgb906afd">CODE/TEST DISTRIBUTION: <a href="p2-code.zip">p2-code.zip</a></h4>
</div>

<div id="outline-container-org817b2d3" class="outline-4">
<h4 id="org817b2d3">VIDEO OVERVIEW: <i>Not Yet Available</i></h4>
</div>
<div id="outline-container-org878651d" class="outline-4">
<h4 id="org878651d">CHANGELOG: Empty</h4>
</div>
<div id="outline-container-org854fbbc" class="outline-4">
<h4 id="org854fbbc"></h4>
<div class="outline-text-4" id="text-org854fbbc">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgb0d1494">1. Introduction</a></li>
<li><a href="#org2889c49">2. Download Code and Setup</a></li>
<li><a href="#orgb7b00d4">3. <b>Problem 1</b>: Digital Scale Simulation</a>
<ul>
<li><a href="#org3e0df4e">3.1. Overview</a></li>
<li><a href="#org5bb0cca">3.2. Scale Features and Tare</a></li>
<li><a href="#org1dc11ce">3.3. Scale Hardware Ports</a></li>
<li><a href="#org10cf953">3.4. Scale Structs and Defines</a></li>
<li><a href="#org99632ce">3.5. <code>scale_update.c</code> Outline</a></li>
<li><a href="#org211aed3">3.6. Diagram of Display</a></li>
<li><a href="#org61b5acf">3.7. Digit Patterns</a></li>
<li><a href="#org827a624">3.8. Implementation Hints</a></li>
<li><a href="#orge3b386f">3.9. Scale Simulator and Main</a></li>
<li><a href="#org023d63b">3.10. Problem 1 Grading Criteria</a></li>
</ul>
</li>
<li><a href="#org7d40a1c">4. <b>Problem 2</b>: Debugging the Puzzlebox</a>
<ul>
<li><a href="#orga6e53af">4.1. Overview</a></li>
<li><a href="#org134e7ec">4.2. <code>input.txt</code> Input File</a></li>
<li><a href="#orgc41b35c">4.3. <code>gdb</code> The GNU Debugger</a></li>
<li><a href="#orgd4e5ba6">4.4. Typical Cycle</a></li>
<li><a href="#orgb0d8298">4.5. Kinds of Puzzles</a></li>
<li><a href="#org60437a2">4.6. Tests for <code>puzzlebox.c</code></a></li>
</ul>
</li>
<li><a href="#org6f77e7b">5. <b>Problem 3</b>: Hash Tables in C</a>
<ul>
<li><a href="#org04823e5">5.1. Overview</a></li>
<li><a href="#org6b61f01">5.2. <code>hashset_main</code> Demonstration</a></li>
<li><a href="#orga0bc501">5.3. Diagram of Hash Set Data structures</a></li>
<li><a href="#orgfe0bab1">5.4. Hash Table Data Types</a></li>
<li><a href="#orgf372bd2">5.5. Provided <code>hash_code()</code> Function</a></li>
<li><a href="#org09989f3">5.6. <code>hashset_funcs.c</code> Outline</a></li>
<li><a href="#orge5aa9a0">5.7. <code>hashset_main.c</code>: main function / application</a></li>
<li><a href="#orgcd113ec">5.8. Grading Criteria for Problem 3</a></li>
</ul>
</li>
<li><a href="#org9dc4fb5">6. Project Submission</a>
<ul>
<li><a href="#org8cf78ac">6.1. Submit to Gradescope</a></li>
<li><a href="#orgcb3c3fe">6.2. Late Policies</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb0d1494" class="outline-2">
<h2 id="orgb0d1494"><span class="section-number-2">1</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
This project addresses more advanced C programming topics each in its
own problem.
</p>

<ol class="org-ol">
<li><b>Bit-level operations</b> are common in C and systems programming.  This
assignment features a problem in which shifting and bitwise AND/OR-ing
are required to complete the requirements.</li>

<li>Debugging is also a critical skill enabled by the <b>debugger</b>. The
second problem in the assignment makes use of the GNU Debugger, <code>gdb</code>,
to work through a puzzle program requiring specific inputs to pass its
"phases".</li>

<li>Data structures pervade computing and getting some practice with
them in C will improve one's skill at pointers and memory usage
while also giving a great appreciation for garbage collected
languages.  A basic "set" application which tracks a collection of
unique values is implemented, backed by a hash table.</li>
</ol>
</div>


<div id="outline-container-org9b063af" class="outline-4">
<h4 id="org9b063af">Difficulty Notice</h4>
<div class="outline-text-4" id="text-org9b063af">
<p>
Past students have found this content to be <b>more challenging than
Project 1.</b>
</p>

<p>
If you were pressed for time to finish Project 1, start this project
<b>as early as possible</b>.  Most students have found the first two
problems (bit manipulations and debugging) only mildly challenging but
run out of time on the larger third problem.
</p>
<div class="org-center">
<p>
<b><i>You have been warned.</i></b>
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org2889c49" class="outline-2">
<h2 id="org2889c49"><span class="section-number-2">2</span> <a id="orgfbcd664"></a> Download Code and Setup</h2>
<div class="outline-text-2" id="text-2">
<p>
Download the code pack linked at the top of the page. Unzip this which
will create a project folder. Create new files in this
folder. Ultimately you will re-zip this folder to submit it.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">File</th>
<th scope="col" class="org-left">State</th>
<th scope="col" class="org-left">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>scale_update.c</code></td>
<td class="org-left">CREATE</td>
<td class="org-left">Create this file and write required function in it to complete Problem 1</td>
</tr>

<tr>
<td class="org-left"><code>scale.h</code></td>
<td class="org-left">Provided</td>
<td class="org-left">Problem 1 header file</td>
</tr>

<tr>
<td class="org-left"><code>scale_main.c</code></td>
<td class="org-left">Provided</td>
<td class="org-left">Problem 1 main() function for scale hardware simulation</td>
</tr>

<tr>
<td class="org-left"><code>scale_sim.c</code></td>
<td class="org-left">Provided</td>
<td class="org-left">Problem 1 suppor functions to assist with simulating scale device</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>test_scale_update.c</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Problem 1 function tests for <code>scale_upate.c</code></td>
</tr>

<tr>
<td class="org-left"><code>test_scale.org</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Problem 1 testing data file</td>
</tr>

<tr>
<td class="org-left"><code>testy</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Problem 1 test running script</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>scale_examples.sh</code></td>
<td class="org-left">Provided</td>
<td class="org-left">Problem 1 script to produce a variety of scale examples</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><code>puzzlebox.c</code></td>
<td class="org-left">Provided</td>
<td class="org-left">Problem 2 Debugging problem</td>
</tr>

<tr>
<td class="org-left"><code>input.txt</code></td>
<td class="org-left">EDIT</td>
<td class="org-left">Problem 2 Input for <code>puzzlebox</code>, fill this in</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><code>hashset.h</code></td>
<td class="org-left">Provided</td>
<td class="org-left">Problem 3 header file</td>
</tr>

<tr>
<td class="org-left"><code>hashset_funcs.c</code></td>
<td class="org-left">CREATE</td>
<td class="org-left">Problem 3 functions to write</td>
</tr>

<tr>
<td class="org-left"><code>hashset_main.c</code></td>
<td class="org-left">CREATE</td>
<td class="org-left">Problem 3 main function to write</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>data/hashset_demo.script</code></td>
<td class="org-left">Data</td>
<td class="org-left">Problem 3 sample input scripts to main program</td>
</tr>

<tr>
<td class="org-left"><code>data/alphabet.script</code></td>
<td class="org-left">Data</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>data/rm.hashset</code></td>
<td class="org-left">Data</td>
<td class="org-left">Problem 3 sample hash set save files</td>
</tr>

<tr>
<td class="org-left"><code>data/alphabet.hashset</code></td>
<td class="org-left">Data</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>data/alphabet_expand.hashset</code></td>
<td class="org-left">Data</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>test_hashmap.org</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Problem 3 tests</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><code>Makefile</code></td>
<td class="org-left">Provided</td>
<td class="org-left">Build file to compile all programs</td>
</tr>

<tr>
<td class="org-left"><code>testy</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Test running script</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-org19b18e1" class="outline-4">
<h4 id="org19b18e1">Makefile</h4>
<div class="outline-text-4" id="text-org19b18e1">
<p>
As in the first assignment, a <code>Makefile</code> is provided as part of this
project. The essential targets pertinent to each problem are described
in those sections. The <code>Makefile</code> is equipped with a brief help
listing:
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; make help
Typical usage is:
  &gt; make                          # build all programs
  &gt; make clean                    # remove all compiled items
  &gt; make zip                      # create a zip file for submission
  &gt; make prob1                    # built targets associated with problem 1
  &gt; make test                     # run all tests
  &gt; make test-prob2               # run test for problem 2
  &gt; make test-prob2 testnum=5     # run problem 2 test #5 only
  &gt; make update                   # download and install any updates to project files
</pre>
</div>
</div>
</div>


<div id="outline-container-orgff4e672" class="outline-4">
<h4 id="orgff4e672">Automated Tests</h4>
<div class="outline-text-4" id="text-orgff4e672">
<p>
As in previous assignments, automated tests are provided and
associated with problems. Each problem describes how to run tests
associated with it. Generally this is done as before:
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; make test-prob1
gcc -Wall -Wno-comment -Werror -g  -c scale_main.c
gcc -Wall -Wno-comment -Werror -g  -c scale_update.c
...
./testy -o md test_scale.org 
===========================================================================
== test_scale.org : Problem 1 test_scale_update and scale_main tests
== Running 40 / 40 tests
 1) scale_from_ports_01      : ok
 2) scale_from_ports_02      : ok
 3) scale_from_ports_03      : ok
...

&gt;&gt; make test-prob2         # run "tests" associated with problem 2
... 
&gt;&gt; ./puzzlebox input.txt   # same as above: run puzzlebox to test answers
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb7b00d4" class="outline-2">
<h2 id="orgb7b00d4"><span class="section-number-2">3</span> <b>Problem 1</b>: Digital Scale Simulation</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org3e0df4e" class="outline-3">
<h3 id="org3e0df4e"><span class="section-number-3">3.1</span> Overview</h3>
<div class="outline-text-3" id="text-3-1">
<p>
You are tasked with writing code which will be run by a
microcontroller in a digital scale.  The hardware has the following
relevant features.
</p>
<ul class="org-ul">
<li>An internal sensor detects weight that is on the scale. The value
reported by the device is stored in a special hardware location that
is presented as a global variable to C programs.</li>
<li>A digital display controlled by a hardware port.  Setting a certain
global variable will change the display to show information to a
user of the device.</li>
<li>User code that you will need to write to update the display based on
the value reported by the internal sensors</li>
<li>A simulator program with <code>Makefile</code> to test your code</li>
</ul>
<p>
Each feature is discussed in subsequent sections.
</p>
</div>
</div>

<div id="outline-container-org5bb0cca" class="outline-3">
<h3 id="org5bb0cca"><span class="section-number-3">3.2</span> Scale Features and Tare</h3>
<div class="outline-text-3" id="text-3-2">
<p>
The scale has the following features.
</p>
<ul class="org-ul">
<li>Displays in either Ounces (OZ) or Pounds (LB); there are 16 ounces
per pound</li>
<li>Weight sensor detects changes of up 0.1 ounces</li>
<li>Internal sensor that works for ranges of 0 to 99.9 ounces (and
equivalent pounds)</li>
<li>Has a "Tare" feature described below</li>
</ul>
</div>

<div id="outline-container-orgb5b53e2" class="outline-4">
<h4 id="orgb5b53e2">Tare Feature</h4>
<div class="outline-text-4" id="text-orgb5b53e2">
<p>
Many tabletop digital scales have a handy "TARE" functionality (Arabic
for "that which is removed").  It is used to measure the weight of
something in a container conveniently as follows.
</p>
<ol class="org-ol">
<li>The empty container is placed on the scale</li>
<li>The "TARE" button is pressed which stores the weight of the
container in scale memory</li>
<li>The container may be removed and filled with the actual material to be
weighed; during that time, the scale will read a Negative weight</li>
<li>The filled container is placed on the scale again and the weight of
only the material is shown (internally the previous container
weight is subtracted from the measured weight and displayed)</li>
</ol>
<p>
The diagram below shows steps 1, 2, and 4.
</p>
<div class="org-center">

<div id="org3165c2e" class="figure">
<p><img src="tare-feature.png" alt="tare-feature.png" style="max-width:100%;" />
</p>
<p><span class="figure-number">Figure 1: </span>Example of using the Tare feature of the scale to weigh the contents of a container. The empty bowl is first placed on the scale and the "Tare" button is pressed before weighing the filled bowl.</p>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org1dc11ce" class="outline-3">
<h3 id="org1dc11ce"><span class="section-number-3">3.3</span> Scale Hardware Ports</h3>
<div class="outline-text-3" id="text-3-3">
<p>
The Scale has hardware that is exposed through several global
variables in C programs. These are as follows. 
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Variable / Port</th>
<th scope="col" class="org-left">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>short SCALE_SENSOR_PORT</code></td>
<td class="org-left">The weight currently on the scale in tenths of ounces</td>
</tr>

<tr>
<td class="org-left"><code>short SCALE_TARE_PORT</code></td>
<td class="org-left">A previously saved sensor value, usually subtracted to account for a "container" weight</td>
</tr>

<tr>
<td class="org-left"><code>unsigned char SCALE_STAUS_PORT</code></td>
<td class="org-left">Indicates whether to display ounces or pounds, whether buttons are pressed</td>
</tr>

<tr>
<td class="org-left"><code>int SCALE_DISPLAY_PORT</code></td>
<td class="org-left">Each bit controls part of the LCD display allowing weights to be shown</td>
</tr>
</tbody>
</table>

<p>
Notes on each of the ports are included in the header file and are
shown below. You do not need to define any of these variables as they
already exist in the simulator / hardware. Some variables are
read-only while others can be read and written. The objective is to
write several functions which extract information from these variables
and creates a display of the device state for a user. Details of how
to go about this are described in subsequent functions.
</p>

<div class="org-src-container">
<pre class="src src-c">extern short SCALE_SENSOR_PORT;
// Set by the hardware to indicate the load placed on the scale. The
// sensor is in units of 0.1 oz so that a sensor value of 238 would be
// 23.8 ounces. If negative or greater than 999, a hardware error has
// occurred. This port should only be read from.

extern short SCALE_TARE_PORT;
// Internal hardware that stores a previous sensor value for use later
// such as to subtract off the weight of a container on the scale to
// determine the weight of its contents. If this value is negative or
// greater than 999, a hardware error has occurred.  This port may be
// read or written to.

extern unsigned char SCALE_STATUS_PORT;
// A series of bits indicating various aspects of the scale's state as
// detected by the hardware. While there are 8 bits, only 2 of them
// are used by the software. The bits are as follows:
// 
// Bit 0: Unused
// Bit 1: Unused
// Bit 2: Unit Select, 0 for ounces (oz), 1 for pounds (lb)
// Bit 3: Unused
// Bit 4: Unused
// Bit 5: Tare Button, 1 for pressed, 0 for not
// Bit 6: Unused
// Bit 7: Unused
//
// This port should only be read from.

extern int SCALE_DISPLAY_PORT;
// Controls the scale display. Readable and writable. Routines
// wishing to change the display should alter the bits of this
// variable.

</pre>
</div>
</div>
</div>

<div id="outline-container-org10cf953" class="outline-3">
<h3 id="org10cf953"><span class="section-number-3">3.4</span> Scale Structs and Defines</h3>
<div class="outline-text-3" id="text-3-4">
<p>
During processing, the functions that are required need to pass
several pieces of data around that describe the state of the
device. These are summarized in a struct that is defined in the header
file and shown below. The documentation associated with the struct and
<code>#define</code>'d constants are used in functions to manipulate the machine
state.
</p>

<div class="org-src-container">
<pre class="src src-c">
////////////////////////////////////////////////////////////////////////////////
// scale data and structs

#define UNIT_KG 1               // show kilograms
#define UNIT_LB 2               // show pounds (2.2 pounds per kg)

#define MODE_SHOW      1        // show measured weight as sensor_val - tare_val 
#define MODE_TARE      2        // store the sensor_val into tare_val, Tare Indicator on
#define MODE_ERROR     4        // error of some kind

// store state of the scale in a struct for easier access
typedef struct{
  short weight;            // calculated weight for use elsewhere
  char mode;               // one of the MODE_XX values indicating what to do/show
  char indicators;         // Bit field with 1's for different indicators
  // Bit 0: Ounce Indicator On/Off
  // Bit 1: Pound Indicator On/Off
  // Bit 2: Tare Indicator On/Off, on when stored Tare value is non-zero
} scale_t;

</pre>
</div>
</div>
</div>

<div id="outline-container-org99632ce" class="outline-3">
<h3 id="org99632ce"><span class="section-number-3">3.5</span> <code>scale_update.c</code> Outline</h3>
<div class="outline-text-3" id="text-3-5">
<p>
Periodically the microcontroller managing the scale will call
<code>scale_update()</code> which should access the sensors/ports and set the
display using several functions are used to subdivide this task. The
functions to write for the problem are outlined below. Each includes
documentation about what is to be done in the function and constraints
on the implementation. Details about how to format the digital display
described in later sections.
</p>

<div class="org-src-container">
<pre class="src src-c">// scale_update.c: functions that read scale hardware, convert its
// encode its state in a struct, and adjusts the display to show the
// user information.

#include "scale.h"

int scale_from_ports(scale_t *scale);
// Uses the values in SCALE_SENSOR_PORT, SCALE_TARE_PORT, and
// SCALE_STATUS_PORT to set the fields of the `scale` struct to
// appropriate values. 
//
// Does bound checking so that if the SCALE_SENSOR_PORT or
// SCALE_TARE_PORT is out of range (see their docs) sets the fields of
// scale to be 0's, sets the scale-&gt;mode to be MODE_ERROR, and
// returns 1. 
//
// If SCALE_STATUS_PORT indicates the Tare button is being pressed
// (see that variable's docs), sets fields of `scale` to be 0, sets
// the mode to be MODE_TARE, and returns 2.
//
// Otherwise sets the fields of scale as follows.
//
// - mode :: set to MODE_SHOW to show the display weight as normal
//
// - weight :: set to (SCALE_SENSOR_PORT - SCALE_TARE_PORT).  Converts
//   to pounds if SCALE_STATUS_PORT indicates that is the desired
//   unit. Conversion is done using bit shifting / masking and rounds
//   pounds up if the ounces are halfway to the next pound.
//
// - indicators :: sets a bit to turn on either the Ounce or Pound
//   Indicator light. If the SCALE_TARE_PORT is not zero, sets a bit
//   to turn on the Tare indicator light. See documentation for the
//   scale_t struct for which bits control which indicator lights.
//
// CONSTRAINTS: Uses only integer operations. No floating point
// operations are used as the target machine does not have a FPU. Does
// not use any math functions such as abs().
//
// CONSTRAINTS: Does not use integer division; uses bit shifting and
// masking to compute division by powers of two and perform rounding.
// 
// CONSTRAINT: Limit the complexity of code as much as possible. Do
// not use conditionals nested deeper than 2 levels. Seek to make the
// code as short, and simple as possible. Code longer than 70 lines
// may be penalized for complexity.

int scale_display_special(scale_t scale, int *display);
// Sets the bits pointed at by `display to indicate one of two
// "special" cases.
//
// If scale.mode is MODE_ERROR, sets the display to "ERR" to indicate
// that the weight is out of range or some other hardware error has
// occurred.
//
// If scale.mode is MODE_TARE, sets the display to "STOR" to indicate
// that the Tare button is being pressed and the current weight will be
// stored in the internal saved weight space.
//
// In both the above cases, only changes the bits pointed at by
// `display` and returns 0. Does not make any other changes to the
// machine state.
//
// If scale.mode is a different value that one of the above two cases,
// this function has been called in error and returns 1.
//
// CONSTRAINT: This function should not access or change any global
// variables. 
//
// CONSTRAINT: Limit the complexity of code as much as possible. Do
// not use conditionals nested deeper than 2 levels. Seek to make the
// code as short, and simple as possible. Code longer than 35 lines
// may be penalized for complexity.

int scale_display_weight(scale_t scale, int *display);
// Called when scale.mode is MODE_SHOW. If it is not, this function
// returns 1 immediately and makes no other changes.
//
// For scale.mode of MODE_SHOW, sets `display` bits to indicate the
// weight in scale.weight. Uses integer division to determine digits
// to be shown in `display` and whether a negative sign should be
// present. Sets bits of `display` according to the bits in
// scale.indicators to show ounces / pounds as the unit and indicate a
// non-zero tare. Returns 0 on completion.
//
// CONSTRAINT: This function should not access or change any global
// PORT variables. It may use a global array of bit patterns if deemed
// useful.
//
// CONSTRAINT: Limit the complexity of code as much as possible. Do
// not use conditionals nested deeper than 2 levels. Seek to make the
// code as short, and simple as possible. Code longer than 65 lines
// may be penalized for complexity.

int scale_update();
// Updates the state of scale using previously defined functions. Uses
// stack space for a scale_t struct which is set from the ports and
// then used to alter the display. If the MODE_TARE is indicated, then
// copies SCALE_SENSOR_PORT to SCALE_TARE_PORT. Returns 0 if the
// display is set properly and 1 if an error occurs while setting the
// display. 
//
// CONSTRAINT: Does not allocate any heap memory as malloc() is NOT
// available on the target microcontroller.  Uses stack and global
// memory only.
//
// CONSTRAINT: Limit the complexity of code as much as possible. Do
// not use conditionals nested deeper than 2 levels. Seek to make the
// code as short, and simple as possible. Code longer than 20 lines
// may be penalized for complexity.

</pre>
</div>
</div>
</div>

<div id="outline-container-org211aed3" class="outline-3">
<h3 id="org211aed3"><span class="section-number-3">3.6</span> Diagram of Display</h3>
<div class="outline-text-3" id="text-3-6">
<p>
The overall display is formed with several adjacent digits along with
an other indicator lights display.  The diagram below shows several
examples of these along with the vale for the 32-bit <code>DISPLAY_PORT</code>
that would create the display.
</p>

<div class="org-center">

<div id="org4310a3e" class="figure">
<p><img src="digital-scale-top-down.png" alt="digital-scale-top-down.png" style="max-width:100%;" />
</p>
<p><span class="figure-number">Figure 2: </span>Examples of how the bits of the <code>DISPLAY_PORT</code> control which parts of the display are shown.  Each digit follows the same pattern of bit to bar correspondence as the right-most with bits. That pattern appears in a later diagram.  The highest order bits (28-31) control indicator lights as shown. Note that several conflicting indicators could be shown at the same time but the code setting the display should not do this normally.</p>
</div>
</div>

<p>
Notice the following.
</p>
<ul class="org-ul">
<li><code>SCALE_DISPLAY_PORT</code> is accessed as a 32-bit integer</li>
<li>31 bits are used to control the full display</li>
<li>Bits 0-6 control the tenths place</li>
<li>Bits 7-13 control the ones place</li>
<li>Bits 14-20 control the tens place</li>
<li>Bits 21-27 control the hundreds place though this is only used for a
negative sign</li>
<li>Bit 28 turns on the OZ indicator</li>
<li>Bit 29 turns on the LB indicator</li>
<li>Bit 30 turns on the <code>-T</code> (non-zero Tare) indicator</li>
<li>Bit 31 is not used</li>
</ul>
</div>
</div>

<div id="outline-container-org61b5acf" class="outline-3">
<h3 id="org61b5acf"><span class="section-number-3">3.7</span> Digit Patterns</h3>
<div class="outline-text-3" id="text-3-7">
<p>
Each part of the LCD display is controlled with individual bits. The
Digits follow a regular pattern where each bit darkens certain <b>bars</b>
in the display allowing numbers and some letters to be shown. The
pattern is repented in the diagram below and should likely be encoded
somewhere in the program.
</p>

<div class="org-center">

<div id="org734b874" class="figure">
<p><img src="digital-digits-top-down.png" alt="digital-digits-top-down.png" style="max-width:100%;" />
</p>
<p><span class="figure-number">Figure 3: </span>Bit to digit display bar correspondence.  The 0th bit controls the top horizontal bar, the 1th bit controls the horizontal bar counter-clockwise from it, the 2th bit the middle bar, and so on working top to bottom, left to right. When a bit is 1 (set), the bar will be darkened while when the bit is 0 (clear) the bar will not be displayed (shown as empty).  The combinations of bits shown are the only ones that arise when showing digits for times.</p>
</div>
</div>

<p>
Notice the following.
</p>
<ul class="org-ul">
<li>Bits that are set (equal to 1) will turn on (darken) one <b>bar</b> of
the display digit</li>
<li>Bits that are clear (equal to 0) will turn off one bar of the digit</li>
<li>7 bits are required to control the display of one digit</li>
<li>The bits are arranged with the low order bit (bit 0) at the top and
progress top-to-bottom and left-to-right
<ul class="org-ul">
<li>Bit 0 top</li>
<li>Bit 1 upper left</li>
<li>Bit 2 middle</li>
<li>Bit 3 upper right</li>
<li>Bit 4 lower left</li>
<li>Bit 5 bottom</li>
<li>Bit 6 lower right</li>
</ul></li>
<li>The programmer can set bits to any pattern which will be displayed
but only patterns shown in the figure correspond to digits of
interest.</li>
</ul>

<p>
To create a mult-digit display, one can set bits, then <b>shift those
bits left</b> to place the digit further to the left in the display. All
digits follow the above pattern which allows for easy combination.
</p>
</div>
</div>

<div id="outline-container-org827a624" class="outline-3">
<h3 id="org827a624"><span class="section-number-3">3.8</span> Implementation Hints</h3>
<div class="outline-text-3" id="text-3-8">
</div>
<div id="outline-container-orgbd66cab" class="outline-4">
<h4 id="orgbd66cab">Bit Shifts VS Division</h4>
<div class="outline-text-4" id="text-orgbd66cab">
<p>
Review the correspondence between right shift operations and
division and note that any bits shifted off would be the remainder
of a division.
</p>
</div>
</div>

<div id="outline-container-orgb900f88" class="outline-4">
<h4 id="orgb900f88">Digit Bit Patterns</h4>
<div class="outline-text-4" id="text-orgb900f88">
<p>
While creating the bit display pattern in <code>scale_display_weight()</code>, a
good trick to use when create a series of bit patterns that correspond
to the various digits. For example, according to the diagrams above,
the bit pattern for <code>9</code> is <code>0b1101111</code>.  If a <code>9</code> should appear on the
clock somewhere, this bit pattern should be shifted and combined with
the existing bits in <code>display</code> so that a 9 will show.  
</p>

<p>
It may be worthwhile to create bit patterns for other items like
Letters or the Negative sign. This can be done in several ways but a
common one is via defining "symbols" or global variables.
</p>
<div class="org-src-container">
<pre class="src src-c">// "symbol" defining a bit pattern
#define SOME_PATTERN 0b1101001

// global variable defining a bit pattern
int OTHER_PATTERN = 0b0010110;

// global array of patterns
int my_patterns[2] = {
  0b0101010,
  0b1111110,
};
</pre>
</div>

<p>
Here is detailed explanation of one approach to the laying out a
multi-digit pattern.
</p>
<ul class="org-ul">
<li>Create an array of bit masks for each of the digits 0-9. The 0th
element of the array contains a bit pattern like <code>0b1111011</code> which
represents the bits that should be set for a 0 digit, the 1th
element of this array has a pattern for one, and so one. There
should be ten entries in this array in indices 0-9.</li>
<li>For a given number like 839, use modulo to determine the integer
value for the ones, tens, and hundreds digits in the number. Call
these variables something like <code>ones</code> and <code>tens</code> etc.. Each variable
should be in the range 0-9.</li>
<li>Start with a state variable of 0 (all 0 bits).</li>
<li>Use <code>ones</code> to index into your array of masks to determine the
bits that should be set for it. Combine the state variable with
<code>ones</code> bit pattern.</li>
<li>Combining bits here is a logical operation of setting all bits that
are one in the pattern to 1 in the state variable.</li>
<li>Use <code>tens</code> to index into your array of masks for the right pattern
for that digit. The bits corresponding to the tens place is shifted
to the left by 7 bits so shift the pattern to the left and combine it
with the state variable.</li>
<li>Repeat this process for the remaining digits required (shifted by 14
and 21 bits left for the other two digits).</li>
<li>Account in some way for negativity: the negative sign must be placed
if the value is less than 0</li>
<li>Keep in mind that the display has a few special cases: no leading 0
should be shown in the tens place if the quantity is small</li>
<li>Set the high bits (28-30) using shifts according to any indicators
that are present.</li>
<li>The state variable should now be populated.</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-orge3b386f" class="outline-3">
<h3 id="orge3b386f"><span class="section-number-3">3.9</span> Scale Simulator and Main</h3>
<div class="outline-text-3" id="text-3-9">
<p>
While we do not have actual hardware with the features mentioned, a
simulator for the system is in the provided files <code>scale_main.c</code>
and <code>scale_sim.c</code>.  You do not need to modify or understand code in
either file to complete the HW though it will certainly expand you C
skills to spend some time examining them. Several functions are
created along with the global variables that represent parts of the
hardware. 
</p>

<p>
You can build simulator executable via <code>make</code>.  The <code>main()</code> function
in accepts a command line argument which specifies the internal state
of the machine. It then calls the update function and shows the
resulting display.
</p>

<p>
Below are several sample runs of the simulator which show the results
of running on several example inputs.
</p>

<pre class="example" id="org624202a">

########## EXAMPLE  1 ##########
&gt;&gt; ./scale_main
usage: ./scale_main {sensor_val} {tare_val} {oz|lb} {tare_no|tare_yes}
  sensor_val: integer


########## EXAMPLE  2 ##########
&gt;&gt; ./scale_main 0 0 oz tare_no
SCALE_SENSOR_PORT: 0
SCALE_TARE_PORT:   0
SCALE_STAUS_PORT:  0000 0000
index:                4    0
result = scale_from_ports(&amp;scale);
result: 0
scale = {
  weight     = 0
  mode       = 1
  indicators = 00000 001
}
result = scale_update();
result: 0
SCALE_SENSOR_PORT: 0
SCALE_TARE_PORT:   0
SCALE_DISPLAY_PORT:
bits:  0 001 0000000 0000000 1111011 1111011
index:    28      21      14       7       0
Scale Display:
           ~~   ~~   
          |  | |  |  
                     
          |  | |  | OZ
           ~~ o ~~   


########## EXAMPLE  3 ##########
&gt;&gt; ./scale_main 5 0 oz tare_no
SCALE_SENSOR_PORT: 5
SCALE_TARE_PORT:   0
SCALE_STAUS_PORT:  0000 0000
index:                4    0
result = scale_from_ports(&amp;scale);
result: 0
scale = {
  weight     = 5
  mode       = 1
  indicators = 00000 001
}
result = scale_update();
result: 0
SCALE_SENSOR_PORT: 5
SCALE_TARE_PORT:   0
SCALE_DISPLAY_PORT:
bits:  0 001 0000000 0000000 1111011 1100111
index:    28      21      14       7       0
Scale Display:
           ~~   ~~   
          |  | |     
                ~~   
          |  |    | OZ
           ~~ o ~~   


########## EXAMPLE  4 ##########
&gt;&gt; ./scale_main 839 0 oz tare_no
SCALE_SENSOR_PORT: 839
SCALE_TARE_PORT:   0
SCALE_STAUS_PORT:  0000 0000
index:                4    0
result = scale_from_ports(&amp;scale);
result: 0
scale = {
  weight     = 839
  mode       = 1
  indicators = 00000 001
}
result = scale_update();
result: 0
SCALE_SENSOR_PORT: 839
SCALE_TARE_PORT:   0
SCALE_DISPLAY_PORT:
bits:  0 001 0000000 1111111 1101101 1101111
index:    28      21      14       7       0
Scale Display:
      ~~   ~~   ~~   
     |  |    | |  |  
      ~~   ~~   ~~   
     |  |    |    | OZ
      ~~   ~~ o ~~   


########## EXAMPLE  5 ##########
&gt;&gt; ./scale_main 839 125 oz tare_no
SCALE_SENSOR_PORT: 839
SCALE_TARE_PORT:   125
SCALE_STAUS_PORT:  0000 0000
index:                4    0
result = scale_from_ports(&amp;scale);
result: 0
scale = {
  weight     = 714
  mode       = 1
  indicators = 00000 101
}
result = scale_update();
result: 0
SCALE_SENSOR_PORT: 839
SCALE_TARE_PORT:   125
SCALE_DISPLAY_PORT:
bits:  0 101 0000000 1001001 1001000 1001110
index:    28      21      14       7       0
Scale Display:
      ~~             
        |    | |  | -T
                ~~   
        |    |    | OZ
              o      


########## EXAMPLE  6 ##########
&gt;&gt; ./scale_main 0 125 oz tare_no
SCALE_SENSOR_PORT: 0
SCALE_TARE_PORT:   125
SCALE_STAUS_PORT:  0000 0000
index:                4    0
result = scale_from_ports(&amp;scale);
result: 0
scale = {
  weight     = -125
  mode       = 1
  indicators = 00000 101
}
result = scale_update();
result: 0
SCALE_SENSOR_PORT: 0
SCALE_TARE_PORT:   125
SCALE_DISPLAY_PORT:
bits:  0 101 0000100 1001000 0111101 1100111
index:    28      21      14       7       0
Scale Display:
           ~~   ~~   
        |    | |    -T
 ~~        ~~   ~~   
        | |       | OZ
           ~~ o ~~   


########## EXAMPLE  7 ##########
&gt;&gt; ./scale_main 839 125 lb tare_no
SCALE_SENSOR_PORT: 839
SCALE_TARE_PORT:   125
SCALE_STAUS_PORT:  0000 0100
index:                4    0
result = scale_from_ports(&amp;scale);
result: 0
scale = {
  weight     = 45
  mode       = 1
  indicators = 00000 110
}
result = scale_update();
result: 0
SCALE_SENSOR_PORT: 839
SCALE_TARE_PORT:   125
SCALE_DISPLAY_PORT:
bits:  0 110 0000000 0000000 1001110 1100111
index:    28      21      14       7       0
Scale Display:
                ~~   
          |  | |    -T
           ~~   ~~   
             |    |  
              o ~~  LB


########## EXAMPLE  8 ##########
&gt;&gt; ./scale_main 839 125 lb tare_yes
SCALE_SENSOR_PORT: 839
SCALE_TARE_PORT:   125
SCALE_STAUS_PORT:  0010 0100
index:                4    0
result = scale_from_ports(&amp;scale);
result: 2
scale = {
  weight     = 0
  mode       = 2
  indicators = 00000 000
}
result = scale_update();
result: 0
SCALE_SENSOR_PORT: 839
SCALE_TARE_PORT:   839
SCALE_DISPLAY_PORT:
bits:  0 000 1100111 1001001 1111011 1011111
index:    28      21      14       7       0
Scale Display:
 ~~   ~~   ~~   ~~   
|       | |  | |  |  
 ~~             ~~   
   |    | |  | |  |  
 ~~        ~~ o      


########## EXAMPLE  9 ##########
&gt;&gt; ./scale_main -15 0 oz tare_no
SCALE_SENSOR_PORT: -15
SCALE_TARE_PORT:   0
SCALE_STAUS_PORT:  0000 0000
index:                4    0
result = scale_from_ports(&amp;scale);
result: 1
scale = {
  weight     = 0
  mode       = 4
  indicators = 00000 000
}
result = scale_update();
result: 0
SCALE_SENSOR_PORT: -15
SCALE_TARE_PORT:   0
SCALE_DISPLAY_PORT:
bits:  0 000 0110111 1011111 1011111 0000000
index:    28      21      14       7       0
Scale Display:
 ~~   ~~   ~~        
|    |  | |  |       
 ~~   ~~   ~~        
|    |  | |  |       
 ~~           o      


########## EXAMPLE 10 ##########
&gt;&gt; ./scale_main 0 -48 lb tare_no
SCALE_SENSOR_PORT: 0
SCALE_TARE_PORT:   -48
SCALE_STAUS_PORT:  0000 0100
index:                4    0
result = scale_from_ports(&amp;scale);
result: 1
scale = {
  weight     = 0
  mode       = 4
  indicators = 00000 000
}
result = scale_update();
result: 0
SCALE_SENSOR_PORT: 0
SCALE_TARE_PORT:   -48
SCALE_DISPLAY_PORT:
bits:  0 000 0110111 1011111 1011111 0000000
index:    28      21      14       7       0
Scale Display:
 ~~   ~~   ~~        
|    |  | |  |       
 ~~   ~~   ~~        
|    |  | |  |       
 ~~           o      


########## EXAMPLE 11 ##########
&gt;&gt; ./scale_main 0 -48 oz tare_yes
SCALE_SENSOR_PORT: 0
SCALE_TARE_PORT:   -48
SCALE_STAUS_PORT:  0010 0000
index:                4    0
result = scale_from_ports(&amp;scale);
result: 1
scale = {
  weight     = 0
  mode       = 4
  indicators = 00000 000
}
result = scale_update();
result: 0
SCALE_SENSOR_PORT: 0
SCALE_TARE_PORT:   -48
SCALE_DISPLAY_PORT:
bits:  0 000 0110111 1011111 1011111 0000000
index:    28      21      14       7       0
Scale Display:
 ~~   ~~   ~~        
|    |  | |  |       
 ~~   ~~   ~~        
|    |  | |  |       
 ~~           o      


</pre>
</div>
</div>

<div id="outline-container-org023d63b" class="outline-3 grading 30">
<h3 id="org023d63b"><span class="section-number-3">3.10</span> Problem 1 Grading Criteria&#xa0;&#xa0;&#xa0;<span class="tag"><span class="grading">grading</span>&#xa0;<span class="30">30</span></span></h3>
<div class="outline-text-3" id="text-3-10">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Weight</th>
<th scope="col" class="org-left">Criteria</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">AUTOMATED TESTS</td>
</tr>

<tr>
<td class="org-right">20</td>
<td class="org-left"><code>make test-prob1</code> which uses programs <code>test_scale_update</code> and <code>scale_main</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Provides 40 tests for functions in <code>scale_update.c</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">0.5 point per test passed</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">MANUAL INSPECTION of <code>scale_update.c</code></td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><a href="https://docs.google.com/document/d/1V6W1GBcL2cgOoiIeaz5V83U3BUbfK7wqYia71i0AeXQ/edit?usp=sharing">Code Style</a>: Functions adhere to <a href="https://docs.google.com/document/d/1V6W1GBcL2cgOoiIeaz5V83U3BUbfK7wqYia71i0AeXQ/edit?usp=sharing">CMSC 216 C Coding Style Guide</a> which dictates</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">reasonable indentation, commenting, consistency of curly usage, etc.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left"><code>scale_from_ports()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear effort to do error checking of out of bounds values.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear flow to how each field of <code>scale_t</code> is calculated.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Correctly setting fields of <code>scale_t</code> via pointer dereference or arrow operator.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Makes use of shift / logical operations to convert port value to seconds</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Adherence to constraints: no floats, no float math ops, no deeply nested conditionals, code length</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left"><code>scale_display_special()</code> / <code>scale_display_weight()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear error checking of for the appropriate MODE in both functions</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of bitwise operators to shift bits appropriately</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of bitwise operators to combine shifted digit bits</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear calculation digits to be displayed</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of bit masks stored in arrays with indices corresponding to digits to be displayed</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear derference/set of the integer pointed to by the <code>display</code> parameter</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Refrains from accessing / altering global PORTS</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Adherence to constraints: no floats, no math float ops, no deeply nested conditionals, code length</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><code>scale_update()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Does not re-define / re-declare these variables, only checks / alters their values</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of previous two functions</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Adjusts <code>SCALE_TARE_PORT</code> when <code>MODE_TARE</code> is detected</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">No use of <code>malloc()</code></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org7d40a1c" class="outline-2">
<h2 id="org7d40a1c"><span class="section-number-2">4</span> <b>Problem 2</b>: Debugging the Puzzlebox</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-orga6e53af" class="outline-3">
<h3 id="orga6e53af"><span class="section-number-3">4.1</span> Overview</h3>
<div class="outline-text-3" id="text-4-1">
<p>
The file <code>puzzlebox.c</code> contains source code that reads inputs from a
file named on the command line. If the inputs are correct, points are
awarded. If inputs are incorrect, error messages are printed.  
</p>

<p>
The <code>puzzlebox</code> is arranged into a series of <i>phases</i> each of which
has some points associated with it.
</p>
<ul class="org-ul">
<li>Not all phases must be completed to get full credit but the phases
must done in order.</li>
<li>Each phase reads inputs from the file provided on the command line
and performs calculations on them to see if they are "correct"
according to various criteria</li>
<li>The very first input is your <b>internet ID</b> like <code>kauf0095</code> (first
part of your UMN email address).  This input is used to add
randomness to the puzzle so that <b>your answers will be different
from most other students</b>. You must you use your own internet ID.</li>
</ul>

<p>
<b>The purpose of this problem is get familiar with using a debugger.</b>
This is a powerful tool that pauses programs, allows internal values
to be printed and code to be stepped through line by line.  It is
nearly essential to use as the code in <code>puzzlebox</code> is intentionally
convoluted in places. Being able to pause execution and print values
at various points make it <b>much easier</b> to solve the puzzles.
</p>
</div>
</div>

<div id="outline-container-org134e7ec" class="outline-3">
<h3 id="org134e7ec"><span class="section-number-3">4.2</span> <code>input.txt</code> Input File</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Name your input file <code>input.txt</code> and put your internet ID in it along
with some numbers like <code>1 2 3</code>. Then compile and run the <code>puzzlebox</code>
program on it.
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; make puzzlebox                             # compile puzzlebox
gcc -Wall -g -c puzzlebox.c
gcc -Wall -g -o puzzlebox puzzlebox.o

&gt;&gt; cat input.txt                              # show contents of input.txt
kauf0095 1 2 3

&gt;&gt; puzzlebox input.txt
========================================
PROBLEM 2: Puzzlebox
UserID 'KAUF0095' accepted: hash value = 1936486779
PHASE 1: A puzzle you say? Challenge accepted!

Ah ah ah, you didn't say the magic word...
Failure: Double debugger burger, order up!

RESULTS: 0 / 30 points
</pre>
</div>

<p>
This is automated with the <code>Makefile</code> target <code>make test-prob2</code>:
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; make test-prob2                       # compile/run puzzlebox with input.txt
gcc -Wall -g -c puzzlebox.c
gcc -Wall -g -o puzzlebox puzzlebox.o
puzzlebox input.txt
========================================
PROBLEM 2: Puzzlebox
UserID 'KAUF0095' accepted: hash value = 1936486779
PHASE 1: A puzzle you say? Challenge accepted!

Ah ah ah, you didn't say the magic word...
Failure: Double debugger burger, order up!

RESULTS: 0 / 30 points
</pre>
</div>

<p>
These initial forays are not positive (0 / 30 points) but the real
meat of the problem is in examining the source code and determining
inputs for <code>input.txt</code>.
</p>
</div>
</div>

<div id="outline-container-orgc41b35c" class="outline-3">
<h3 id="orgc41b35c"><span class="section-number-3">4.3</span> <code>gdb</code> The GNU Debugger</h3>
<div class="outline-text-3" id="text-4-3">
<p>
You will definitely need to use a debugger to solve the puzzlebox and
<code>gdb</code> is the quintessential debugger associated with our compiler
<code>gcc</code>.  It is installed by default on all lab machines and is an easy
install on must Linux machines.
</p>

<p>
For a quick overview of GDB, here are some resources
</p>
<ul class="org-ul">
<li><a href="https://kauffman77.github.io/tutorials/gdb.html">Quick Guide to gdb: The GNU Debugger</a>: Page describing how
to start the debugger, a sample session using <code>puzzlebox</code>, an
overview of the most common commands.</li>
<li><a href="https://www.youtube.com/watch?v%3DPorfLSr3DDI">CppCon 2015: Greg Law " Give me 15 minutes &amp; I'll change your view
of GDB"</a>: Video giving basic overview of hope to run <code>gdb</code> on simple
programs with an emphasis on differences between "normal" mode and
TUI mode</li>
<li><a href="http://www.yolinux.com/TUTORIALS/GDB-Commands.html">GNU GDB Debugger Command Cheat Sheet</a>: Extensive list of commands</li>
<li><a href="https://sourceware.org/gdb/current/onlinedocs/gdb/">Debugging with GDB</a>: Official manual for <code>gdb</code></li>
</ul>
</div>
</div>

<div id="outline-container-orgd4e5ba6" class="outline-3">
<h3 id="orgd4e5ba6"><span class="section-number-3">4.4</span> Typical Cycle</h3>
<div class="outline-text-3" id="text-4-4">
<p>
A typical cycle of working on <code>puzzlebox</code> will be the following.
</p>
<ul class="org-ul">
<li><p>
Start the debugger with puzzlebox
</p>
<div class="org-src-container">
<pre class="src src-sh">  &gt;&gt; gdb -tui ./puzzlebox
</pre>
</div></li>
<li><p>
Set the arguments array to <code>input.txt</code>
</p>
<pre class="example">
set args input.txt
</pre></li>
<li><p>
Set a breakpoint at a phase like <code>phase03</code>
</p>
<pre class="example">
break phase03
</pre></li>
<li><p>
Run the program
</p>
<pre class="example">
run
</pre></li>
<li><p>
Do some stepping / nexting
</p>
<pre class="example">
step
next
</pre></li>
<li><p>
Print some variables
</p>
<pre class="example">
print normal_val
print/x val_in_hex
print/t val_in_binary
</pre></li>
<li>Make some changes to <code>input.txt</code> in a different window</li>
<li><p>
Re-run the program to see if things have changed favorably
</p>
<pre class="example">
kill
run
</pre></li>
</ul>
</div>
</div>

<div id="outline-container-orgb0d8298" class="outline-3">
<h3 id="orgb0d8298"><span class="section-number-3">4.5</span> Kinds of Puzzles</h3>
<div class="outline-text-3" id="text-4-5">
<p>
The puzzles presented in the different phases make use of a variety of
C program techniques which we have or will discuss including.
</p>
<ul class="org-ul">
<li>Bit-wise operations and their use in place of arithmetic</li>
<li>String and character array manipulations</li>
<li>Interpreting bits as one of several kinds of things (integer, float,
character) through pointers and unions</li>
<li>More extensive C control structures like <code>goto</code> and labels</li>
</ul>
</div>
</div>

<div id="outline-container-org60437a2" class="outline-3 grading 30">
<h3 id="org60437a2"><span class="section-number-3">4.6</span> Tests for <code>puzzlebox.c</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="grading">grading</span>&#xa0;<span class="30">30</span></span></h3>
<div class="outline-text-3" id="text-4-6">
<p>
<code>puzzlebox.c</code> itself reports how many points one can earn at the end
of its execution.
</p>

<p>
Currently there are <b>40 points available but 30 points is considered
full credit.</b> 
</p>

<p>
If any additional points are earned, they will be counted as <b>Makeup
Credit for Projects</b> to make up for credit lost on past or future
projects.  Your total score on All Projects cannot exceed 100% so any
points beyond will simply be dropped.
</p>

<p>
<b>Run the following command to 'test' puzzlebox</b>:
</p>
<pre class="example">
make test-prob2
</pre>
</div>
</div>
</div>

<div id="outline-container-org6f77e7b" class="outline-2">
<h2 id="org6f77e7b"><span class="section-number-2">5</span> <b>Problem 3</b>: Hash Tables in C</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org04823e5" class="outline-3">
<h3 id="org04823e5"><span class="section-number-3">5.1</span> Overview</h3>
<div class="outline-text-3" id="text-5-1">
<p>
This problem implements a rudimentary hash table application in C
along with a program that uses it.  The architecture is similar to a
lab problem involving linked lists so reviewing that code can provide
some insight.
</p>

<p>
Basic Hash Tables are covered in most introductory data structure
classes such as CSCI 1913 and 1933. Should you need to review them,
the following resources may prove useful.
</p>
<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/Hash_table">Wikipedia Article on Hash Tables</a>: Provides general overview of the
data structure. Specifically focus on <a href="https://en.wikipedia.org/wiki/Hash_table#Separate_chaining_with_linked_lists">Separate Chaining with Linked
Lists</a> which is the style of hash table implemented in the
assignment.</li>
<li><a href="https://www.youtube.com/watch?v=shs0KM3wKv8">Youtube "Data Structures: Hash Tables" by HackerRank</a>: Short video
summarizing major concepts of hash tables in any programming
language. Explains briefly hash code functions and the Separate
Chaining architecture we will use.</li>
<li><a href="https://www.youtube.com/watch?v=c3RVW3KGIIE">Youtube "How HashMap works in Java" by Ranjith Ramachandran</a>: Short
video which includes a detailed walk-through of adding elements to a
separately chained hash table.  Somewhat Java-centric including use
of a different mapping of hash codes to array indices than we will
use. Also note that they Key/Value structure used there is for a Map
whereas we will use a Set where the Key/Val are identical and
referred to as an Element.</li>
</ul>

<p>
Our particular variant will be a <b>Hash Set</b> which is a collection of
elements (strings) which are each unique. The hash table is used to
quickly add new elements and check whether an element is contained in the
set. The hash table will use the <b>separate chaining</b> technique to
resolve hash code conflicts: each hash "bucket" has a singly linked
list of elements in that bucket.
</p>

<p>
Additionally, the hash set will maintain a record of the <b>order elements
are added</b> by overlaying a linked list on elements as they are
added. This allows for efficient traversal of the hash table elements for
printing and gives a queue-like feel to parts of the table.
</p>
</div>
</div>

<div id="outline-container-org6b61f01" class="outline-3">
<h3 id="org6b61f01"><span class="section-number-3">5.2</span> <code>hashset_main</code> Demonstration</h3>
<div class="outline-text-3" id="text-5-2">
<p>
The intent of this problem is to develop a small application which
behaves as the following demo indicates.
</p>

<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; make hashset_main                   # Compile hash table application
gcc -Wall -Wno-comment -Werror -g  -c hashset_main.c
gcc -Wall -Wno-comment -Werror -g  -c hashset_funcs.c
gcc -Wall -Wno-comment -Werror -g  -o hashset_main hashset_main.o hashset_funcs.o

&gt;&gt; ./hashset_main                      # start application, shows help message with commands
Hashset Application
Commands:
  hashcode &lt;elem&gt;  : prints out the numeric hash code for the given key (does not change the hash set)
  contains &lt;elem&gt;  : prints the value associated with the given element or NOT PRESENT
  add &lt;elem&gt;       : inserts the given element into the hash set, reports existing element
  print            : prints all elements in the hash set in the order they were addded
  structure        : prints detailed structure of the hash set
  clear            : reinitializes hash set to be empty with default size
  save &lt;file&gt;      : writes the contents of the hash set to the given file
  load &lt;file&gt;      : clears the current hash set and loads the one in the given file
  next_prime &lt;int&gt; : if &lt;int&gt; is prime, prints it, otherwise finds the next prime and prints it
  expand           : expands memory size of hash set to reduce its load factor
  quit             : exit the program

HS&gt; print                              # prints items in order, empty initially

HS&gt; structure                          # show hash table structure, empty intitially
elem_count: 0
table_size: 5
order_first: NULL
order_last : NULL
load_factor: 0.0000
[ 0] : 
[ 1] : 
[ 2] : 
[ 3] : 
[ 4] : 

HS&gt; add Rick                           # add items table
HS&gt; add Morty                             

HS&gt; print                              # show items in order added
  1 Rick
  2 Morty

HS&gt; structure                          # show internal structure of the hash table
elem_count: 2
table_size: 5
order_first: Rick
order_last : Morty
load_factor: 0.4000
[ 0] :                                 # some buckets are empty
[ 1] : 
[ 2] : 
[ 3] : {2546943 Rick &gt;&gt;Morty}          # nodes show hash code, string stored, next string
[ 4] : {74531189 Morty &gt;&gt;NULL}         # last item added, points to null

HS&gt; add Summer                         # add more items
HS&gt; add Jerry
HS&gt; add Beth
HS&gt; add Tinyrick

HS&gt; print                              # print items in order added
  1 Rick
  2 Morty
  3 Summer
  4 Jerry
  5 Beth
  6 Tinyrick

HS&gt; structure                          # show structure
elem_count: 6                          # NOTE: recently added items added to front of bucket lists
table_size: 5
order_first: Rick
order_last : Tinyrick
load_factor: 1.2000
[ 0] : 
[ 1] : {-1964728321 Tinyrick &gt;&gt;NULL} 
[ 2] : {2066967 Beth &gt;&gt;Tinyrick} 
[ 3] : {-1807340593 Summer &gt;&gt;Jerry} {2546943 Rick &gt;&gt;Morty} 
[ 4] : {71462654 Jerry &gt;&gt;Beth} {74531189 Morty &gt;&gt;Summer} 

HS&gt; contains Jerry                     # check if items contained / not in hashset
FOUND: Jerry
HS&gt; contains Rick
FOUND: Rick
HS&gt; contains Unity
NOT PRESENT
HS&gt; contains President
NOT PRESENT

HS&gt; add Jerry                          # items are unique, no changes made on detecting duplicates
Elem already present, no changes made
HS&gt; add Beth
Elem already present, no changes made

HS&gt; save rm.hashset                    # save the hash table file rm.hashset, can be loaded later
HS&gt; clear                              # clear the hash table
HS&gt; print                              # show cleared hash table is empty now
HS&gt; structure
elem_count: 0
table_size: 5
order_first: NULL
order_last : NULL
load_factor: 0.0000
[ 0] : 
[ 1] : 
[ 2] : 
[ 3] : 
[ 4] : 

HS&gt; add Birdperson                     # add new items to the empty hash table
HS&gt; add Squanchy
HS&gt; structure                          # show contents
elem_count: 2
table_size: 5
order_first: Birdperson
order_last : Squanchy
load_factor: 0.4000
[ 0] : 
[ 1] : 
[ 2] : {-724361712 Squanchy &gt;&gt;NULL} 
[ 3] : {2082041198 Birdperson &gt;&gt;Squanchy} 
[ 4] : 

HS&gt; load rm.hashset                    # clear current hash table and load from file
HS&gt; structure                          # show contents identical to when 'save' was used
elem_count: 6
table_size: 5
order_first: Rick
order_last : Tinyrick
load_factor: 1.2000
[ 0] : 
[ 1] : {-1964728321 Tinyrick &gt;&gt;NULL} 
[ 2] : {2066967 Beth &gt;&gt;Tinyrick} 
[ 3] : {-1807340593 Summer &gt;&gt;Jerry} {2546943 Rick &gt;&gt;Morty} 
[ 4] : {71462654 Jerry &gt;&gt;Beth} {74531189 Morty &gt;&gt;Summer} 

HS&gt; expand                             # expand the size of the hash table's internal array
HS&gt; print                              # no effect on items/ordering in table
  1 Rick
  2 Morty
  3 Summer
  4 Jerry
  5 Beth
  6 Tinyrick

HS&gt; structure                          # show internal sturcture: larger array now
elem_count: 6

table_size: 11                         # array size is next_prime(2*5+1) = 11
order_first: Rick
order_last : Tinyrick
load_factor: 0.5455
[ 0] : 
[ 1] : {2066967 Beth &gt;&gt;Tinyrick} 
[ 2] : 
[ 3] : {-1807340593 Summer &gt;&gt;Jerry} {2546943 Rick &gt;&gt;Morty} 
[ 4] : 
[ 5] : 
[ 6] : {-1964728321 Tinyrick &gt;&gt;NULL} 
[ 7] : {74531189 Morty &gt;&gt;Summer} 
[ 8] : 
[ 9] : 
[10] : {71462654 Jerry &gt;&gt;Beth} 

HS&gt; add Birdperson                     # add additional items
HS&gt; add Squanchy
HS&gt; add Picklerick

HS&gt; structure                          # show structure again
elem_count: 9
table_size: 11
order_first: Rick
order_last : Picklerick
load_factor: 0.8182
[ 0] : {761532761 Picklerick &gt;&gt;NULL} 
[ 1] : {2066967 Beth &gt;&gt;Tinyrick} 
[ 2] : 
[ 3] : {-1807340593 Summer &gt;&gt;Jerry} {2546943 Rick &gt;&gt;Morty} 
[ 4] : 
[ 5] : 
[ 6] : {2082041198 Birdperson &gt;&gt;Squanchy} {-1964728321 Tinyrick &gt;&gt;Birdperson} 
[ 7] : {74531189 Morty &gt;&gt;Summer} 
[ 8] : {-724361712 Squanchy &gt;&gt;Picklerick} 
[ 9] : 
[10] : {71462654 Jerry &gt;&gt;Beth} 

HS&gt; expand                             # expand again
HS&gt; structure                          # show internal structure
elem_count: 9
table_size: 23                         # size is next_prime(2*11 + 1) = 23
order_first: Rick
order_last : Picklerick
load_factor: 0.3913
[ 0] : 
[ 1] : {761532761 Picklerick &gt;&gt;NULL} 
[ 2] : 
[ 3] : {2066967 Beth &gt;&gt;Tinyrick} 
[ 4] : 
[ 5] : 
[ 6] : 
[ 7] : 
[ 8] : {2082041198 Birdperson &gt;&gt;Squanchy} 
[ 9] : 
[10] : 
[11] : {-724361712 Squanchy &gt;&gt;Picklerick} {-1964728321 Tinyrick &gt;&gt;Birdperson} {74531189 Morty &gt;&gt;Summer} 
[12] : 
[13] : 
[14] : 
[15] : {2546943 Rick &gt;&gt;Morty} 
[16] : 
[17] : 
[18] : {-1807340593 Summer &gt;&gt;Jerry} 
[19] : 
[20] : 
[21] : {71462654 Jerry &gt;&gt;Beth} 
[22] : 

HS&gt; quit                               # exit the application
&gt;&gt;                                     # back to normal shell
</pre>
</div>
</div>
</div>

<div id="outline-container-orga0bc501" class="outline-3">
<h3 id="orga0bc501"><span class="section-number-3">5.3</span> Diagram of Hash Set Data structures</h3>
<div class="outline-text-3" id="text-5-3">
<div class="org-center">

<div id="org8b295e3" class="figure">
<p><img src="hashset2.png" alt="hashset2.png" style="max-width:100%;" />
</p>
<p><span class="figure-number">Figure 4: </span>Shows the structure of a hash set and the various C data structures (<code>structs</code>) which are involved. Details are discussed in subsequent sections.</p>
</div>
</div>
</div>
</div>



<div id="outline-container-orgfe0bab1" class="outline-3">
<h3 id="orgfe0bab1"><span class="section-number-3">5.4</span> Hash Table Data Types</h3>
<div class="outline-text-3" id="text-5-4">
<p>
We will favor <b>separately chained</b> hash sets which have the
following features.
</p>
<ul class="org-ul">
<li>A hash set stores elements (strings) allowing fast lookup based on the
hash code of the element. When a programming environment provides a
"set" data structure, hash tables are frequently the backing data
structure.</li>
<li>The hash set has a 'table' which is a fixed size array. Each array
element is a pointer to a linked list node or <code>NULL</code>.</li>
<li>Elements in the hash table are stored in linked list nodes. Elements that
hash to the same table location are stored in the list at that
location</li>
<li>A <code>hashcode()</code> function is provided which generates an integer from
a string and is the first step to determining where key/value is
located.</li>
<li>The hash set also tracks the ordering that elements are added via
additional pointers. The hash set tracks the first and last elements
added allowing queue-like adds. Each node is part of a list for the
table index it is stored at AND part of the overall list of all
elements added in order.</li>
</ul>

<p>
Examine the header file <code>hashset.h</code> to see the two C structs which will
be used to represent hash tables.
</p>

<div class="org-src-container">
<pre class="src src-c">// Type for linked list nodes in hash set
typedef struct hashnode {
  struct hashnode *table_next;  // pointer to next node at table index of this node, NULL if last node
  struct hashnode *order_next;  // pointer to next node in insert order, NULL if last data added
  char data[128];               // string for the data stored in this node
} hsnode_t;

// Type of hash table
typedef struct {
  int data_count;               // number of data items (elements) in the table
  int table_size;               // how big is the table array
  hsnode_t **table;             // array of "buckets" which contain nodes
  hsnode_t *order_first;        // pointer to the first node that was added
  hsnode_t *order_last;         // pointer to last node that was added
} hashset_t;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf372bd2" class="outline-3">
<h3 id="orgf372bd2"><span class="section-number-3">5.5</span> Provided <code>hash_code()</code> Function</h3>
<div class="outline-text-3" id="text-5-5">
<p>
The code for <code>hash_code()</code> is provided below. All hash tables require
a means of converting elements into a non-unique number. For
consistency, we will use the below code which employs several
interesting C tricks that will be discussed as the course
progresses. Some of the advantages/disadvantages of the hash function
are mentioned in the comments.
</p>

<div class="org-src-container">
<pre class="src src-c">// PROVIDED: Compute a simple hash code for the given character
// string. Uses a "polyomial code" which uses all characters of the
// string to form the hash code. This is the same approach that many
// standard libraries like Java's String.hashcode() function
// use. ADVANTAGE: Gives good distribution for all strings with even
// single character variations having different hash
// codes. DISADVANTAGE: computing the hash code is linear in time on
// the length of the string.
int hashcode(char key[]){
  int hc = 0;
  for(int i=0; key[i]!='\0'; i++){
    hc = hc*31 + key[i];
  }
  return hc;
}

</pre>
</div>
</div>
</div>

<div id="outline-container-org09989f3" class="outline-3">
<h3 id="org09989f3"><span class="section-number-3">5.6</span> <code>hashset_funcs.c</code> Outline</h3>
<div class="outline-text-3" id="text-5-6">
<p>
Standard operations are supported by the hash set.
</p>
<ul class="org-ul">
<li>Adding an element</li>
<li>Determining if an element is contained or not in the set</li>
<li>Clearing the entire hash table</li>
<li>Printing all data in the hash table according to their add order</li>
<li>Printing the internal layout of the hash table</li>
<li>Expanding the memory used by the hash table to improve lookup
performance.</li>
</ul>

<p>
These are broken down into the following C functions which you will
need to implement in <code>hashset_funcs.c</code> except for the first
<code>hashcode()</code> function which is provided.
</p>

<div class="org-src-container">
<pre class="src src-c">// hashset_funcs.c: utility functions for operating on hash sets. Most
// functions are used in the hashset_main.c which provides an
// application to work with the functions.

#include "hashset.h"

// PROVIDED: Compute a simple hash code for the given character
// string. Uses a "polyomial code" which uses all characters of the
// string to form the hash code. This is the same approach that many
// standard libraries like Java's String.hashcode() function
// use. ADVANTAGE: Gives good distribution for all strings with even
// single character variations having different hash
// codes. DISADVANTAGE: computing the hash code is linear in time on
// the length of the string.
int hashcode(char key[]){
  int hc = 0;
  for(int i=0; key[i]!='\0'; i++){
    hc = hc*31 + key[i];
  }
  return hc;
}

void hashset_init(hashset_t *hs, int table_size);
// Initialize the hash set 'hs' to have given size and data_count
// 0. Ensures that the 'table' field is initialized to an array of
// size 'table_size' and is filled with NULLs. Also ensures that the
// first/last pointers are initialized to NULL

int hashset_contains(hashset_t *hs, char data[]);
// Returns 1 if the parameter `data` is in the hash set and 0
// otherwise. Uses hashcode() and field `table_size` to determine
// which index in table to search.  Iterates through the list at that
// table index using strcmp() to check for `data`. NOTE: The
// `hashcode()` function may return positive or negative
// values. Negative values are negated to make them positive. The
// "bucket" (index in hs-&gt;table) for `data` is determined by with
// 'hashcode(key) modulo table_size'.

int hashset_add(hashset_t *hs, char data[]);
// If the data is already present in the hash set, makes no changes
// to the hash set and returns 0. hashset_contains() may be used for
// this. Otherwise determines the bucket to add `data` at via the same
// process as in hashset_contains() and adds it to the FRONT of the
// list at that table index. Adjusts the `hs-&gt;order_last` pointer to
// append the new data to the ordered list of data. If this is the
// first data added, also adjsuts the `hs-&gt;first` pointer. Updates the
// `data_count` field and returns 1 to indicate a successful addition.
//
// NOTE: Adding data at the front of each bucket list allows much
// simplified logic that does not need any looping/iteration.

void hashset_free_fields(hashset_t *hs);
// De-allocates nodes/table for `hs`. Iterates through the ordered
// list of the hash set starting at the `order_first` field and
// de-allocates all nodes in the list. Also free's the `table`
// field. Sets all relevant fields to 0 or NULL as appropriate to
// indicate that the hash set has no more usable space. Does NOT
// attempt to de-allocate the `hs` itself as it may not be
// heap-allocated (e.g. in the stack or a global).

void hashset_show_structure(hashset_t *hs);
// Displays detailed structure of the hash set. Shows stats for the
// hash set as below including the load factor (data count divided
// by table_size) to 4 digits of accuracy.  Then shows each table
// array index ("bucket") on its own line with the linked list of
// data in the bucket on the same line. 
// 
// EXAMPLE:
// data_count: 4
// table_size: 5
// order_first: Rick
// order_last : Tinyrick
// load_factor: 0.8000
// [ 0] : {7738144525137111380 Tinyrick &gt;&gt;NULL} 
// [ 1] : 
// [ 2] : 
// [ 3] : {125779953153363 Summer &gt;&gt;Tinyrick} {1801677138 Rick &gt;&gt;Morty} 
// [ 4] : {521644699469 Morty &gt;&gt;Summer} 
//
// NOTES:
// - Uses format specifier "[%2d] : " to print the table indices
// - Nodes in buckets have the following format:
//   {1415930697 IceT &gt;&gt;Goldenfold}
//    |          |       |        
//    |          |       +-&gt; order_next-&gt;data OR NULL if last node
//    |          +-&gt;`data` string     
//    +-&gt; hashcode("IceT"), print using format "%ld" for 64-bit longs
// 

void hashset_write_data_ordered(hashset_t *hs, FILE *out);
// Outputs all data in the hash set according to the order they
// were added. Starts at the `order_first` field and iterates through
// the list defined there. Each data is printed on its own line
// preceded by its add position with 1 for the first data, 2 for the
// second, etc. Prints output to `FILE *out` which should be an open
// handle. NOTE: the output can be printed to the terminal screen by
// passing in the `stdout` file handle for `out`.

void hashset_save(hashset_t *hs, char *filename);
// Writes the given hash set to the given `filename` so that it can be
// loaded later.  Opens the file and writes its 'table_size' and
// 'data_count' to the file. Then uses the hashset_write_data_ordered()
// function to output all data in the hash set into the file.
// EXAMPLE FILE:
// 
// 5 6
//   1 Rick
//   2 Morty
//   3 Summer
//   4 Jerry
//   5 Beth
//   6 Tinyrick
// 
// First two numbers are the 'table_size' and 'data_count' field and
// remaining text is the output of hashset_write_data_ordered();
// e.g. insertion position and data.

int hashset_load(hashset_t *hs, char *filename);
// Loads a hash set file created with hashset_save(). If the file
// cannot be opened, prints the message
// 
// ERROR: could not open file 'somefile.hs'
//
// and returns 0 without changing anything. Otherwise clears out the
// current hash set `hs`, initializes a new one based on the size
// present in the file, and adds all data from the file into the new
// hash set. Ignores the indices at the start of each line and uses
// hashset_add() to insert data in the order they appear in the
// file. Returns 1 on successful loading (FIXED: previously indicated
// a different return value on success) . This function does no error
// checking of the contents of the file so if they are corrupted, it
// may cause an application to crash or loop infinitely.

int next_prime(int num);
// If 'num' is a prime number, returns 'num'. Otherwise, returns the
// first prime that is larger than 'num'. Uses a simple algorithm to
// calculate primeness: check if any number between 2 and (num/2)
// divide num. If none do, it is prime. If not, tries next odd number
// above num. Loops this approach until a prime number is located and
// returns this. Used to ensure that hash table_size stays prime which
// theoretically distributes data better among the array indices
// of the table.

void hashset_expand(hashset_t *hs);
// Allocates a new, larger area of memory for the `table` field and
// re-adds all current data to it. The size of the new table is
// next_prime(2*table_size+1) which keeps the size prime.  After
// allocating the new table, all table entries are initialized to NULL
// then the old table is iterated through and all data are added to
// the new table according to their hash code. The memory for the old
// table is de-allocated and the new table assigned to the hash set
// fields "table" and "table_size".  This function increases
// "table_size" while keeping "data_count" the same thereby reducing
// the load of the hash table. Ensures that the memory associated with
// the old table is free()'d. Makes NO special effort to preserve old
// nodes: re-adds everything into the new table and then frees the old
// one along with its nodes. Uses functions such as hashset_init(),
// hashset_add(), hashset_free_fields() to accomplish the transfer.

</pre>
</div>
</div>
</div>

<div id="outline-container-orge5aa9a0" class="outline-3">
<h3 id="orge5aa9a0"><span class="section-number-3">5.7</span> <code>hashset_main.c</code>: main function / application</h3>
<div class="outline-text-3" id="text-5-7">
<p>
In <code>hashset_main.c</code> implement an interactive program which allows users
to type commands to manipulate the hash set. 
</p>

<p>
The provided <code>Makefile</code> should compile the <code>hashset_main</code> program as follows.
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; make hashset_main                   # Compile hash table application
gcc -Wall -Wno-comment -Werror -g  -c hashset_main.c
gcc -Wall -Wno-comment -Werror -g  -c hashset_funcs.c
gcc -Wall -Wno-comment -Werror -g  -o hashset_main hashset_main.o hashset_funcs.o

&gt;&gt; ./hashset_main                      # start application, shows help message with commands
Hashset Application
Commands:
  hashcode &lt;data&gt;  : prints out the numeric hash code for the given key (does not change the hash set)
  contains &lt;data&gt;  : prints FOUND if data is in the set NOT PRESENT otherwise
  add &lt;data&gt;       : inserts the given data into the hash set, reports existing data
  print            : prints all data in the hash set in the order they were addded
  structure        : prints detailed structure of the hash set
  clear            : reinitializes hash set to be empty with default size
  save &lt;file&gt;      : writes the contents of the hash set to the given file
  load &lt;file&gt;      : clears the current hash set and loads the one in the given file
  next_prime &lt;int&gt; : if &lt;int&gt; is prime, prints it, otherwise finds the next prime and prints it
  expand           : expands memory size of hash set to reduce its load factor
  quit             : exit the program
HS&gt; 
</pre>
</div>

<p>
The following sections provide some implementation details.
</p>
</div>

<div id="outline-container-org8781355" class="outline-4">
<h4 id="org8781355">Read commands, Execute</h4>
<div class="outline-text-4" id="text-org8781355">
<p>
The basic flow of <code>hashset_main.c</code> follows the same pattern that code for
a lab exercise demonstrates.  A good way to get started on the main
application is to <b>copy over the lab solution</b> and begin modifying it.
</p>
<ul class="org-ul">
<li>Create a <code>hashset_t</code> variable, likely on the stack as a local variable in
<code>main()</code></li>
<li>Start a loop that terminates when the user exits or there is no more
input</li>
<li>Each time the user enters a string, read it and check for one of the
built-in commands</li>
<li>On identifying the command, potentially read another string if
needed (commands like <code>add</code> and <code>contains</code>)</li>
<li>Call an appropriate <code>hashset_XXX()</code> function to handle the command</li>
</ul>
</div>
</div>

<div id="outline-container-orged0a848" class="outline-4">
<h4 id="orged0a848">Supported Commands</h4>
<div class="outline-text-4" id="text-orged0a848">
<p>
To indicate to users of the program the supported commands, use the
following code to print out the initial option list.
</p>

<div class="org-src-container">
<pre class="src src-c">  printf("Hashset Application\n");
  printf("Commands:\n");
  printf("  hashcode &lt;data&gt;  : prints out the numeric hash code for the given key (does not change the hash set)\n");
  printf("  contains &lt;data&gt;  : prints FOUND if data is in the set NOT PRESENT otherwise\n");
  printf("  add &lt;data&gt;       : inserts the given data into the hash set, reports existing data\n");
  printf("  print            : prints all data in the hash set in the order they were addded\n");
  printf("  structure        : prints detailed structure of the hash set\n");
  printf("  clear            : reinitializes hash set to be empty with default size\n");
  printf("  save &lt;file&gt;      : writes the contents of the hash set to the given file\n");
  printf("  load &lt;file&gt;      : clears the current hash set and loads the one in the given file\n");
  printf("  next_prime &lt;int&gt; : if &lt;int&gt; is prime, prints it, otherwise finds the next prime and prints it\n");
  printf("  expand           : expands memory size of hash set to reduce its load factor\n");
  printf("  quit             : exit the program\n");
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd6f4d4d" class="outline-4">
<h4 id="orgd6f4d4d">Clearing Hash Table</h4>
<div class="outline-text-4" id="text-orgd6f4d4d">
<p>
When issuing the <code>clear</code> command, the contents of the current hash set
should be eliminated and the hash set reinitialized to the default
size. This is most easily done via.
</p>
<ol class="org-ol">
<li>Using the <code>hashset_free_fields()</code> function</li>
<li>Using <code>hashset_init()</code> with the <code>HASHSET_DEFAULT_TABLE_SIZE</code>
constant defined in <code>hashset.h</code>.</li>
</ol>
</div>
</div>

<div id="outline-container-org431feed" class="outline-4">
<h4 id="org431feed"><a id="org1734809"></a> Paths to Files for Saving and Loading</h4>
<div class="outline-text-4" id="text-org431feed">
<p>
Saving and loading data involves writing to files. The names
associated with the files must be specified as a <i>path</i> so that if
files are to be saved or loaded from subdirectories, include this
as part of the path.  For example, the <code>rm.hashset</code> file is
provided in the <code>data/</code> directory and once loading functionality is
code, it can be loaded as follows.
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; ./hashset_main
...
HS&gt; load data/rm.hashset       # load existing hashset save file
HS&gt; print
  1 Rick
  2 Morty
  3 Summer
  4 Jerry
  5 Beth
  6 Tinyrick

HS&gt; structure                  # show structure
elem_count: 6
table_size: 5
order_first: Rick
order_last : Tinyrick
load_factor: 1.2000
[ 0] : 
[ 1] : {-1964728321 Tinyrick &gt;&gt;NULL} 
[ 2] : {2066967 Beth &gt;&gt;Tinyrick} 
[ 3] : {-1807340593 Summer &gt;&gt;Jerry} {2546943 Rick &gt;&gt;Morty} 
[ 4] : {71462654 Jerry &gt;&gt;Beth} {74531189 Morty &gt;&gt;Summer} 

HS&gt; expand                     # expand
HS&gt; add Birdperson             # add new items
HS&gt; add Goldenfold

HS&gt; save cur.hashset           # save to file in current directory

HS&gt; clear                      # empty hash table
HS&gt; print                      # show emptiness

HS&gt; load cur.hashset           # reload
HS&gt; print                      # items restored
  1 Rick
  2 Morty
  3 Summer
  4 Jerry
  5 Beth
  6 Tinyrick
  7 Birdperson
  8 Goldenfold
HS&gt; save data/new.hashset      # create another save file in data/ dir
</pre>
</div>
</div>
</div>

<div id="outline-container-org38ae2cf" class="outline-4">
<h4 id="org38ae2cf">Failing to Load Files</h4>
<div class="outline-text-4" id="text-org38ae2cf">
<p>
If a file cannot be opened with the <code>load 'file.hm'</code> command, the
underlying <code>hashset_load()</code> should print an error of the form
</p>
<div class="org-src-container">
<pre class="src src-text">ERROR: could not open file 'somefile.hm'
</pre>
</div>
<p>
and the <code>hash_main.c</code> main loop should NOT change the hash set and
print the message
</p>
<div class="org-src-container">
<pre class="src src-text">load failed
</pre>
</div>
<p>
in response to the error. Below is a demonstration of this from the
automated tests.
</p>
<div class="org-src-container">
<pre class="src src-sh">...
HS&gt; print                      # current contents of set
  1 Rick
  2 Morty
  3 Summer
  4 Jerry
  5 Beth
  6 Tinyrick
  7 Birdperson
  8 Goldenfold

HS&gt; load notthere.hashset      # attempt to load file that doesn't exit
ERROR: could not open file 'notthere.hashset'
load failed

HS&gt; print                      # failed load does not modify current set
  1 Rick
  2 Morty
  3 Summer
  4 Jerry
  5 Beth
  6 Tinyrick
  7 Birdperson
  8 Goldenfold
HS&gt; 
</pre>
</div>
</div>
</div>

<div id="outline-container-org7723b53" class="outline-4">
<h4 id="org7723b53">Command Echoing: <code>-echo</code> option to <code>hashset_main</code></h4>
<div class="outline-text-4" id="text-org7723b53">
<p>
Some users may wish to "script" this the main program: allow it to
process input commands from a file rather than from the user typing.
This notion is discussed in a lab and should be reviewed if it is
unfamiliar.
</p>

<p>
An example of an input script is in <code>data/hashset_demo.script</code> which
looks like a lot of user commands:
</p>
<div class="org-src-container">
<pre class="src src-text">print
structure
add Rick
add Morty
print
structure
add Summer
add Jerry
add Beth
add Tinyrick
print
structure
contains Jerry
contains Rick
contains Unity
contains President
save rm.hashset
clear
print
structure
add Birdperson
add Squanchy
structure
load rm.hashset
structure
expand
print
structure
add Birdperson
add Squanchy
add Picklerick
structure
expand
structure
bye
</pre>
</div>

<p>
The file can be fed directly to the program without needing type it
using Unix pipes as per the following:
</p>
<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; cat data/hashset_demo.script | ./hashset_main -echo
</pre>
</div>
<p>
Notice the use of a command line argument for <code>hashset_main</code>: the
<code>-echo</code> option. This is a REQUIRED feature which prints commands typed
by users to the screen. To implement this, do the following.
</p>

<p>
Model the structure of command echoing after what is shown in related
Lab work.
</p>
<ul class="org-ul">
<li>Use a variable in <code>main()</code> to indicate whether command echoing is on
or off; set it to off by default</li>
<li><p>
Check when <code>main()</code> starts  whether command line argument 1 is set
to <code>-echo</code> in which case turn echoing on. A condition like the
following is useful.
</p>
<div class="org-src-container">
<pre class="src src-c">  if(argc &gt; 1 &amp;&amp; strcmp("-echo",argv[1])==0) {
</pre>
</div></li>
<li>Each command should check for echoing and print the command being
run along with any arguments to it. This technique is demonstrated
in related lab work.</li>
</ul>

<p>
It will take some work to get the exact placement of echoes correct
but will ultimately lead to nice results that involve LITTLE typing
like the example below.
</p>

<div class="org-src-container">
<pre class="src src-sh">&gt;&gt; cat hashset_demo.script | hashset_main -echo 
Hashset Application
Commands:
  hashcode &lt;data&gt;  : prints out the numeric hash code for the given key (does not change the hash set)
  contains &lt;data&gt;  : prints FOUND if data is in the set NOT PRESENT otherwise
  add &lt;data&gt;       : inserts the given data into the hash set, reports existing data
  print            : prints all data in the hash set in the order they were addded
  structure        : prints detailed structure of the hash set
  clear            : reinitializes hash set to be empty with default size
  save &lt;file&gt;      : writes the contents of the hash set to the given file
  load &lt;file&gt;      : clears the current hash set and loads the one in the given file
  next_prime &lt;int&gt; : if &lt;int&gt; is prime, prints it, otherwise finds the next prime and prints it
  expand           : expands memory size of hash set to reduce its load factor
  quit             : exit the program
HS&gt; print

HS&gt; structure
data_count: 0
table_size: 5
order_first: NULL
order_last : NULL
load_factor: 0.0000
[ 0] : 
[ 1] : 
[ 2] : 
[ 3] : 
[ 4] : 

HS&gt; add Rick
HS&gt; add Morty
HS&gt; print
  1 Rick
  2 Morty
...
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgcd113ec" class="outline-3 grading 40">
<h3 id="orgcd113ec"><span class="section-number-3">5.8</span> Grading Criteria for Problem 3&#xa0;&#xa0;&#xa0;<span class="tag"><span class="grading">grading</span>&#xa0;<span class="40">40</span></span></h3>
<div class="outline-text-3" id="text-5-8">
<p>
The following criteria will be checked in this problem.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Weight</th>
<th scope="col" class="org-left">Criteria</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">AUTOMATED TESTS via <code>make test-prob3</code></td>
</tr>

<tr>
<td class="org-right">20</td>
<td class="org-left"><code>test_hashset.org</code> tests</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">20 tests for <code>hashset_main</code> executable, exercises functions in <code>hashset_funcs.c</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">All tests run under Valgrind</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">1 point per test passed</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Code compiles without warnings (<code>make clean</code> followed by <code>make test-prob3</code> gives no errors/warnings)</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">NOTE: run individual tests via <code>make test-prob3 testnum=4</code></td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">MANUAL INSPECTION</td>
</tr>

<tr>
<td class="org-right">15</td>
<td class="org-left"><code>hashset_funcs.c</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear commenting indicating intent during functions "calculate table index" or "iterate through list"</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Relatively short functions: nothing needs to be too long (50 lines tops)</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clearly written iteration loops to traverse linked lists in hash table functions</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of <code>strcmp()</code> to check data during <code>hashset_contains()</code> operation</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of <code>hashset_contains()</code> during <code>hashset_add()</code> to check for duplicates</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Concise and commented code for <code>hashset_add()</code> which calculates table index and inserts new node at the front the list via <code>table_next</code> pointers</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Maintains the <code>order_first/order_last</code> fields during add operation</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left"><code>hashset_free_fields()</code> frees all list nodes and the table array, assigns 0/NULL to all fields</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Uses the ordered list of data to easily free all nodes during <code>hashset_free_fields()</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left"><code>hashset_save()</code> makes use of <code>hashset_write()</code> with an open file handle to avoid redundant code</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left"><code>hashset_load()</code> checks that files open successfully before using <code>hashset_free_fields()</code> to de-allocate memory</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">File closed after finished during saving and loading</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left"><code>next_prime()</code> is clearly written and easy to follow; follows the algorithm described in the function documentation</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left"><code>hashset_expand()</code> uses other functions in such as <code>next_prime()</code>, <code>hashset_add()</code> and <code>hashset_free_fields()</code> to avoid repeating code.</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left"><code>hashset_main.c</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Comments indicating what high-level command is being implemented in each part of <code>main</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear structure of main loop, reading commands, selecting actions</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Use of string functions to identify which command to execute</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear efforts to honor <code>-echo</code> option and echo commands</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear effort to free all memory prior to exit by clearing hashset on exit</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org9dc4fb5" class="outline-2">
<h2 id="org9dc4fb5"><span class="section-number-2">6</span> Project Submission</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org8cf78ac" class="outline-3">
<h3 id="org8cf78ac"><span class="section-number-3">6.1</span> <a id="orgf01a543"></a> Submit to Gradescope</h3>
<div class="outline-text-3" id="text-6-1">
<p>
Refer to the Project 1 instructions and adapt them for details of how
to submit to Gradescope. In summary they are
</p>

<ol class="org-ol">
<li>Type <code>make zip</code> in the project directory to create <code>p2-complete.zip</code></li>
<li>Log into <a href="https://www.gradescope.com/">Gradescope</a>, select Project 2, and upload <code>p2-complete.zip</code></li>
</ol>
</div>
</div>

<div id="outline-container-orgcb3c3fe" class="outline-3">
<h3 id="orgcb3c3fe"><span class="section-number-3">6.2</span> Late Policies</h3>
<div class="outline-text-3" id="text-6-2">
<p>
You may wish to review the policy on late project submission which
will cost 1 Engagement Point per day late. <b>No projects will be
accepted more than 48 hours after the deadline.</b>
</p>


<p>
<a href="https://www.cs.umd.edu/~profk/216/syllabus.html#late-submission">https://www.cs.umd.edu/~profk/216/syllabus.html#late-submission</a>
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr/> <i> <a href="https://www.umd.edu/web-accessibility" title="UMD Web Accessibility">Web Accessibility</a> <br/> Author: Chris Kauffman (<a href="mailto:profk@umd.edu">profk@umd.edu</a>) <br/> Date: 2025-03-04 Tue 21:22 <br/> </i>
</div>
</body>
</html>
