<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-12-11 Sun 17:15 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CSCI 2021 Project 5: Binary ELF File Parsing</title>
<meta name="author" content="Chris Kauffman" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<meta name="viewport" content="width=device-width, maximum-scale=1, minimum-scale=1" />
<style type="text/css">
@media screen {
:root {
--heading-bg-color:#e8c62e;
--heading-fg-color:#7a0019;
}
html {
font-family: serif;
text-align: justify;
}
pre.src, pre.example {
overflow-x: scroll;
}
/* Merge subtitle area with title area */
.subtitle {
text-align: center;
margin-top: -2em;
padding-top: 1em;
padding-bottom: 0.1em;
}
.title, .subtitle {
color: var(--heading-fg-color);
background-color: var(--heading-bg-color);
}
/* Section borders, left section header style */
div.outline-2, #table-of-contents {
background-color: rgb(250,250,250);
border: 0.75em solid var(--heading-bg-color);
border-top: 0em;
padding: 0em .5em .5em .5em; /* top right bottom left */
margin: 1em 0em 1em 0em; /* top right bottom left */
}
div.outline-2 > h2, #table-of-contents > h2 {
background-color: var(--heading-bg-color);
color: var(--heading-fg-color);
font-variant: small-caps;
padding: 0em 0em 0em .5em; /* top right bottom left */
margin: 0em -.5em 0em -.75em; /* top right bottom left */
text-align: left;
}
blockquote {
font-style: italic;
}
td, th {
padding-top: 2px;
padding-bottom: 2px;
}
body {
background-color: #EEE;
}
pre {
}
#content, #preamble, #postamble {
margin-left:300px;
max-width: 100%;
}
.tag {
background-color: inherit; font-family: inherit;
padding: inherit; font-size: 80%; font-weight: inherit;
text-transform: uppercase;
}

.figure p { text-align: inherit; }
figure-number { font-style: italic; }
#table-of-contents {
text-align: left;
position: fixed;
left: 0;
margin: 0 auto;
padding: 0;
width: 300px;
top: 0;
height: 100%;
border: 0;
display: block;
}
#text-table-of-contents {
overflow-y: scroll;
height: 100%;
}
#text-table-of-contents ul {
padding-left: 1em;
margin-left: 0.5em;
}
#table-of-contents > h2 {
padding: 0.1em;
margin: 0;
}
/* adjustments for small screen, toc at top only */
@media (max-width: 800px) { /* landscape for iphone */
html {
-webkit-text-size-adjust: none;  /* prevent scaling of text on mobile */
}
body {
background-color: #EEE;
width:100%;
margin:0 auto;
}
#content, #preamble, #postamble {
margin-left:0;
}
#table-of-contents {
position: static;
left: inherit;
width:inherit;
height: auto;
border-top: 0em;
padding: 0em .5em .5em .5em; /* top right bottom left */
margin: 1em 0em 1em 0em; /* top right bottom left */
border: 0.75em solid #006633;
}
div.outline-2, #table-of-contents {
background-color: rgb(250,250,250);
border: 0.75em solid var(--heading-bg-color);
border-top: 0em;
padding: 0em .5em .5em .5em; /* top right bottom left */
margin: 1em 0em 1em 0em; /* top right bottom left */
}
div.outline-2 > h2, #table-of-contents > h2 {
background-color: var(--heading-bg-color);
color: var(--heading-fg-color);
font-variant: small-caps;
padding: 0em 0em 0em .5em; /* top right bottom left */
margin: 0em -.5em 0em -.75em; /* top right bottom left */
text-align: left;
}
#text-table-of-contents {
overflow-y: visible;
height: inherit;
}
#text-table-of-contents ul {
padding-left: 1em;
margin-left: 0.5em;
}
}
.linenr { font-size: xx-small; }
}

@media print {
html {
font-family: serif;
font-size: 10pt;
text-align: justify;
.linenr { font-size: xx-small; }
}
}
</style>
</head>
<body>
<div id="preamble" class="status">
<i>Last Updated: 2022-12-11 Sun 17:15</i>
</div>
<div id="content" class="content">
<h1 class="title">CSCI 2021 Project 5: Binary ELF File Parsing</h1>
<ul class="org-ul">
<li><b>Due: 11:59pm Wed 14-Dec-2022</b></li>
<li><i>Approximately 3.0-4.0% of total grade</i></li>
<li>Submit to <a href="https://www.gradescope.com/"><b>Gradescope</b></a> (submission now open)</li>
<li>Projects are <b>individual work</b>: no collaboration with other students
is allowed. Seek help from course staff if you get stuck for too long.</li>
</ul>

<div id="outline-container-org8619643" class="outline-4">
<h4 id="org8619643">CODE DISTRIBUTION: <a href="p5-code.zip">p5-code.zip</a></h4>
</div>
<div id="outline-container-org92a6d1e" class="outline-4">
<h4 id="org92a6d1e">VIDEO WALKTHROUGH: <a href="https://canvas.umn.edu/courses/333075/pages/p5-walkthrough">https://canvas.umn.edu/courses/333075/pages/p5-walkthrough</a></h4>
</div>


<div id="outline-container-org2d61819" class="outline-4">
<h4 id="org2d61819">CHANGELOG:</h4>
<div class="outline-text-4" id="text-org2d61819">
<dl class="org-dl">
<dt>Sun Dec 11 05:14:57 PM CST 2022</dt><dd>Submission is now open on
Gradescope.</dd>
<dt>Fri Dec  9 10:14:25 PM CST 2022</dt><dd>Added second half of walkthrough
video. Amended spec and grading criteria: the CALL mode is required
functionality that is described in the walkthrough; no EPs are
associated with its completion.</dd>
</dl>
</div>
</div>

<div id="outline-container-org42d1fdf" class="outline-4">
<h4 id="org42d1fdf"></h4>
<div class="outline-text-4" id="text-org42d1fdf">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org77fb401">1. Overview</a></li>
<li><a href="#org74645c6">2. Download Code and Setup</a></li>
<li><a href="#org7dbf727">3. <b>findfunc</b>: Finding functions in ELF Files</a>
<ul>
<li><a href="#org76f869a">3.1. ELF File References</a></li>
<li><a href="#orgcadd2ec">3.2. Overall Approach</a></li>
<li><a href="#org2208781">3.3. Setting up the Memory Map</a></li>
<li><a href="#orgc091a24">3.4. ELF Header and Section Header Array</a></li>
<li><a href="#org7b26e86">3.5. String Tables, Names, Section Headers</a></li>
<li><a href="#orgb28c2e5">3.6. The <code>.text</code> Section and its Address</a></li>
<li><a href="#orgd3273ad">3.7. Symbol Table and <code>.strtab</code></a></li>
<li><a href="#org25dc651">3.8. Checking that a Symbol is a Function</a></li>
<li><a href="#orga46e2aa">3.9. Printing the Opcodes of the Function</a></li>
<li><a href="#orgd06f3a3">3.10. Behavior in Error Cases</a></li>
<li><a href="#org7a24087">3.11. <code>findfunc</code> Template</a></li>
<li><a href="#orgfcce057">3.12. Calling Functions</a></li>
<li><a href="#orgcc8ea29">3.13. Grading Criteria for <code>findfunc</code></a></li>
</ul>
</li>
<li><a href="#org2b1ba44">4. Project Submission</a>
<ul>
<li><a href="#orgb7f4930">4.1. Submit to Gradescope</a></li>
<li><a href="#org85e3437">4.2. Late Policies</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>


<div id="outline-container-org77fb401" class="outline-2">
<h2 id="org77fb401"><span class="section-number-2">1</span> Overview</h2>
<div class="outline-text-2" id="text-1">
<p>
This project features a single problem pertaining to the most recent
lecture topics, virtual memory and the ELF file format.
</p>

<p>
<code>findfunc</code> uses <code>mmap()</code> to parse a binary ELF file to locate the
binary opcodes associated with a function in the <code>.text</code>
section. Along the way, information about the ELF file is printed such
as the sections it contains and the contents of its symbol table.
Tools that work with object files like the linker associated with the
GCC and the program loader must perform similar though more involved
tasks involving ELF files. <code>mmap()</code> is very useful for handling binary
files and is demonstrated in a recent lab.
</p>

<p>
After locating the binary opcodes for a specified function, <code>findfunc</code>
allows a user to do several operations with the function.
</p>
<ul class="org-ul">
<li>Print out the opcodes in hex format</li>
<li>Call the function according to a type specification and arguments
given on the command line.</li>
</ul>
</div>
</div>

<div id="outline-container-org74645c6" class="outline-2">
<h2 id="org74645c6"><span class="section-number-2">2</span> <a id="org03ad4cc"></a> Download Code and Setup</h2>
<div class="outline-text-2" id="text-2">
<p>
Download the code pack linked at the top of the page. Unzip this which
will create a project folder. Create new files in this
folder. Ultimately you will re-zip this folder to submit it.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">File</th>
<th scope="col" class="org-left">State</th>
<th scope="col" class="org-left">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>Makefile</code></td>
<td class="org-left">Provided</td>
<td class="org-left">Build file to compile all programs</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><code>findfunc.c</code></td>
<td class="org-left">COMPLETE</td>
<td class="org-left">Template to complete</td>
</tr>

<tr>
<td class="org-left"><code>test-input/somefuncs.o</code></td>
<td class="org-left">Data</td>
<td class="org-left">ELF object file for input to <code>findfunc</code></td>
</tr>

<tr>
<td class="org-left"><code>test-input/mymain.o</code></td>
<td class="org-left">Data</td>
<td class="org-left">Several other ELF and non-ELF files provided</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><code>test-results/</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Directory created by running the test script, it can be deleted safely</td>
</tr>

<tr>
<td class="org-left"><code>testy</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Test running script</td>
</tr>

<tr>
<td class="org-left"><code>test_findfunc.org</code></td>
<td class="org-left">Testing</td>
<td class="org-left">Tests associated with findfunc <i>Not yet released</i></td>
</tr>
</tbody>
</table>
</div>
</div>


<div id="outline-container-org7dbf727" class="outline-2">
<h2 id="org7dbf727"><span class="section-number-2">3</span> <b>findfunc</b>: Finding functions in ELF Files</h2>
<div class="outline-text-2" id="text-3">
<p>
The <a href="https://en.wikipedia.org/wiki/Executable_and_Linkable_Format">Executable and Linkable (ELF) File Format</a> is the Unix standard for
binary files with runnable code in them.  By default, any executable
or <code>.o</code> file produced by Unix compilers such as GCC produce ELF
files as evidenced by the <code>file</code> command.
</p>

<div class="org-src-container">
<pre class="src src-sh">&gt; gcc -c code.c

&gt; file code.o
code.o: ELF 64-bit LSB relocatable, x86-64, version 1 (SYSV), not stripped

&gt; gcc program.c

&gt; file a.out
a.out: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0
</pre>
</div>

<p>
This problem explores the file format of ELF in order to print out the
binary bytes associated with functions in the file.  ELF files contain
a Symbol Table that listed all publicly visible entities in the
file. These symbols are for Functions and Global variables in a
program.  Information on Symbols are stored in the <code>.symtab</code> ELF
section short for "Symbol Table". The standard utility <code>readelf</code> shows
human readable versions of ELF files and the <code>-s</code> option specifically
prints out the symbol table section. Below is a session which shows
the source code for provided program <code>globals</code> then uses <code>readelf</code> to
show the symbol table associated with its compiled version.
</p>
<div class="org-src-container">
<pre class="src src-text">&gt; cd test-input/
&gt; file somefuncs.o
somefuncs.o: ELF 64-bit LSB relocatable, x86-64, version 1 (SYSV), with debug_info, not stripped
&gt; cat somefuncs.c
int return_five(){
  return 5;
}

int global_int = 2;

int my_pow(int base, int exp){
  int pow=1;
  for(int i=0; i&lt;exp; i++){
    pow *= base;
  }
  return pow;
}

char an_array[] = "abcde";

void triple(int *xp){
  *xp = *xp * 3;
  return;
}

int meaning_of_life(){
  int l = 21;
  l *= 2;
  return l;
}

&gt; readelf -s somefuncs.o
Symbol table '.symtab' contains 9 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS somefuncs.c
     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    1 .text
     3: 0000000000000000    11 FUNC    GLOBAL DEFAULT    1 return_five
     4: 0000000000000000     4 OBJECT  GLOBAL DEFAULT    2 global_int
     5: 000000000000000b    53 FUNC    GLOBAL DEFAULT    1 my_pow
     6: 0000000000000004     6 OBJECT  GLOBAL DEFAULT    2 an_array
     7: 0000000000000040    29 FUNC    GLOBAL DEFAULT    1 triple
     8: 000000000000005d    19 FUNC    GLOBAL DEFAULT    1 meaning_of_life

&gt; 
</pre>
</div>

<p>
A number entries in the symbol table are omitted for clarity: only
those associated with data in the program are shown.
</p>

<p>
Note the following about the symbol table.
</p>
<ul class="org-ul">
<li>Functions are identified with Type <code>FUNC</code> and have the following
attributes:
<ul class="org-ul">
<li><code>Size</code> corresponds to how many bytes the function's binary Opcodes occupy</li>
<li><code>Type</code> indicates the type of the symbol. Aside from <code>FUNC</code> there
are also <code>OBJECT</code> symbols which correspond to global variables and
some others.</li>
<li><code>Value</code> is the starting address of the function within the text
section</li>
</ul></li>
<li>Global Variables are identified with Type <code>OBJECT</code>
<ul class="org-ul">
<li><code>Size</code> corresponds to how many bytes the global variable occupies.</li>
<li>String arrays have <code>Size</code> equal to their length, <code>int</code> globals
have <code>Size=4</code> and <code>double</code> globals have <code>Size=8</code></li>
<li><code>Ndx</code> is the ELF file section in which the global variable's value
is stored. In this case, all global variables are in Section 23
which is likely the <code>.data</code> section where initialized global data
is stored.</li>
<li><code>Value</code> is the (approximate) virtual address of the global variable when a
program is loaded into the memory; it relates to the (approximate)
virtual address of where the ELF <code>.data</code> section gets loaded when
a program starts running</li>
</ul></li>
</ul>

<p>
The goal of the problem is to construct a program called <code>findfunc</code>
which allows one to print out the binary bytes associated with a named
function.  Finding this data is a crucial step for linking, loading,
and disassembling code such as what is done via the <code>objdump</code>
utility.  A demonstration of <code>findfunc</code> is below which illustrates
several aspects of the <code>findfunc</code>.
</p>
<ol class="org-ol">
<li>It detects whether the file is a proper ELF file and bails out if
not.</li>
<li>It locates the <code>.text</code> and <code>.symtab</code> sections of the ELF file and
shows information on them.</li>
<li>It searches the symbol table for the function named on the command
line.</li>
<li>It detects if the symbol is actually a function or something else
and errors out if not a function.</li>
<li>If the function is found, it will print out all opcodes associated
with the function.</li>
</ol>


<div class="org-src-container">
<pre class="src src-sh">&gt; make findfunc                                          # build findfunc
gcc -Wall -Werror -g -Og -o findfunc findfunc.c

&gt; ./findfunc                                             # show usage for findfunc
usage: ./findfunc &lt;file&gt; &lt;funcname&gt; &lt;mode&gt; [arg ...] 

# PRINT mode will print bytes of the function
&gt; ./findfunc test-input/somefuncs.o return_five print    # call findfunc on object file, find function 'return_five'
file_bytes at: 0x600000000000                            # address where somefuncs.o get's mmap()'d
Section Headers Found:                                   # ELF header information
- 904 bytes from start of file
- 64 bytes per entry
- 12 sections
- 11 is the secion containing header names
Section Header Names in Section 11
- 800 bytes from start of file
- 103 total bytes
- section name string table is

Scanning Section Headers for Relevant Sections          # iterating through section headers to find 
[ 0]:                                                   # relevenat sections like .text and .symtab
[ 1]: .text
[ 2]: .data
[ 3]: .bss
[ 4]: .comment
[ 5]: .note.GNU-stack
[ 6]: .note.gnu.property
[ 7]: .eh_frame
[ 8]: .rela.eh_frame
[ 9]: .symtab
[10]: .strtab
[11]: .shstrtab

.symtab located                                         # information on relevant sections
- 408 bytes offset from start of file
- 216 bytes total size
- 24 bytes per entry
- 9 number of entries
.strtab located
- 624 bytes from start of file
- 75 total bytes in section
.text located
- 64 bytes offset from start of file
- 0x0 preferred address for .text

Scanning Symbol Table for symbol 'return_five'         # iterate through symbol table to find function
[ 0]: 
[ 1]: somefuncs.c
[ 2]: 
[ 3]: return_five
[ 4]: global_int
[ 5]: my_pow
[ 6]: an_array
[ 7]: triple
[ 8]: meaning_of_life

Found 'return_five' in symbol table
- 11 size
- 1 section index
- 18 info
Calculating location of 'return_five' in .text section   # find opcodes from function
- 0x0 preferred address of function (st_value)
- 0x0 preferred address of .text section
- 0 offset in .text of start of function
- 0x600000000040 virtual address of .text section
- 0x600000000040 virtual address of function

MODE: print                                         # on command line, request is to print op codes
11 bytes of function 'return_five'
0000: 55 48 89 e5 b8 05 00 00                       # iterate through function printing hex bytes
0008: 00 5d c3 


# CALL mode will call the function in the binary
&gt; ./findfunc test-input/somefuncs.o return_five call 'int (*)(void)' 
file_bytes at: 0x600000000000
Section Headers Found:
- 904 bytes from start of file                     # same information printed about locating function
...
- 0x600000000040 virtual address of .text section
- 0x600000000040 virtual address of function

MODE: call                                         # function type specified on command line
func_type: int (*)(void)                           # no arguments, returns an int
running function (no arguments)                    # function is called
returned: 5                                        # return value is shown
</pre>
</div>
</div>

<div id="outline-container-org76f869a" class="outline-3">
<h3 id="org76f869a"><span class="section-number-3">3.1</span> ELF File References</h3>
<div class="outline-text-3" id="text-3-1">
<p>
It is recommended to do some reading on the structure of the ELF
format as it will assist in coming to grips with this problem. As you
encounter parts of the below walk-through of how to find and print the
symbol table, refer to the following resources.
</p>
<ul class="org-ul">
<li>Diagrams shown below provide some information about the basics of
what is provided in each portion of the file and how some of the
records relate to each other.</li>
<li><a href="http://man7.org/linux/man-pages/man5/elf.5.html">Manual Pages</a>: The manual page on ELF (found online or by typing <code>man
  elf</code> in any terminal) gives <i>excellent</i> coverage of the structs and
values in the file format. Essentially the entire format is covered
here though there may be a few ambiguities.</li>
<li><a href="https://en.wikipedia.org/wiki/Executable_and_Linkable_Format">Wikipedia</a>: A good overview of the file format and has some
extensive tables on the structs/values that comprise it.</li>
<li><a href="https://docs.oracle.com/cd/E23824_01/html/819-0690/chapter6-43405.html#scrolltoc">Oracle Docs</a>: A somewhat more detailed and hyper-linked version of
the manual pages.</li>
</ul>

<p>
Note that we will use the <b>64-bit ELF format only</b> which means most of
the C types for variables should mention <code>ELF64_xxx</code> in them though
use of 32-bit integers may still apply via <code>uint32_t</code>.
</p>
</div>
</div>

<div id="outline-container-orgcadd2ec" class="outline-3">
<h3 id="orgcadd2ec"><span class="section-number-3">3.2</span> Overall Approach</h3>
<div class="outline-text-3" id="text-3-2">
<p>
ELF files are divided into sections. Our main interest is to identify
the <code>.symtab</code> (Symbol Table) and <code>.text</code> (Executable Code)
sections. This is done in several steps.
</p>
<ol class="org-ol">
<li>Parse the File Header to identify the positions of the Section
Header Array and Section Header String Table</li>
<li>Search the Section Header Array and associated string table to find
the sections named <code>.symtab</code> which is the symbol table, <code>.strtab</code>
which contains the string names of the symbol table, and <code>.text</code>
which contains the binary assembly code. Note the position in the
file of these three sections.</li>
<li>Iterate through the Symbol Table section which is an array of
structs. Use the fields present there along with the associated
string names in <code>.strtab</code> to check each symbol for the symbol of
interest.</li>
<li>Once the symbol is found in <code>.symtab</code>, its value from <code>.symtab</code> is
used to compute the offset within the <code>.text</code> section. This is
where the function symbol's opcodes are stored.</li>
<li>Once the function opcodes are located, they can be printed or the
function can be called. This behavior is dictated by command line
arguments.</li>
</ol>

<p>
Since this is a binary file with a considerable amount of jumping and
casting to structs, it makes sense to use <code>mmap()</code> to map the entire
file into virtual memory. <b>It is a requirement to use mmap() for this
problem</b>. Refer to lecture notes, textbook, and lab materials for
details on how to set up a memory map and clean it up once
finished. In particular <b>Lab 14 uses mmap() to parse binary files</b> in
a way that is directly relevant to the present program.  
</p>

<p>
This general approach is outlined in the provided <code>loadfunc.c</code>
template. The reaming sections discuss tricks and techniques to use
while filling in this template.
</p>
</div>
</div>

<div id="outline-container-org2208781" class="outline-3">
<h3 id="org2208781"><span class="section-number-3">3.3</span> Setting up the Memory Map</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Make use of the <code>mmap()</code> function create a memory map for the file
specified on the command line.  Keep in mind that you may need to
<b>execute the code in this file so find out the correct options to use
with mmap() to make its contents Readbale AND Executable</b>.
</p>
</div>
</div>

<div id="outline-container-orgc091a24" class="outline-3">
<h3 id="orgc091a24"><span class="section-number-3">3.4</span> ELF Header and Section Header Array</h3>
<div class="outline-text-3" id="text-3-4">
<p>
The initial bytes in an ELF file always have a fixed structure which
is the <code>ELF64_Ehdr</code> type.  Of primary interest are the following
</p>
<ol class="org-ol">
<li>Identification bytes and types in the field <code>e_ident[]</code>. These
initial bytes identify the file as ELF format or not.  If they
match the expected values, proceed. If incorrect, consult the later
section on <a href="#orge2a47cb">Error Conditions</a> on what error message to print.</li>
<li>The Section Header Array byte position in the field <code>e_shoff</code>.  The
Section Header Array is like a table of contents for a book giving
positions of most other sections in the file. It usually occurs near
the end of the file.</li>
<li>The index of the Section Header String Table in field
<code>e_shstrndx</code>. This integer gives an index into the Section Header
Array where a string table can be found containing the names of
headers.</li>
</ol>

<p>
The following diagram shows the layout of these first few important
parts of an ELF file. 
</p>

<div class="org-center">

<div id="org9361f57" class="figure">
<p><img src="elf-format-text1.png" alt="elf-format-text1.png" style="max-width:100%;" />
</p>
<p><span class="figure-number">Figure 1: </span>ELF File Header with Section Header Array and Section Header String Table.</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org7b26e86" class="outline-3">
<h3 id="org7b26e86"><span class="section-number-3">3.5</span> String Tables, Names, Section Headers</h3>
<div class="outline-text-3" id="text-3-5">
<p>
To keep the sizes of structures fixed while still allowing variable
length names for things, all the names that are stored in ELF files
are in <b>string tables</b>.  You can see one of these laid in the middle
purple section of the diagram above starting at byte offset 1000. It
is simply a sequence of multiple null-terminated strings laid out
adjacent to one another in the file.
</p>

<p>
When a name is required, a field will give an offset into a specific
string table.  For example, each entry of the Section Header Array has
an <code>sh_name</code> field which is an offset into the <code>.shstrtab</code> (the <code>sh</code>
is for "section header").. The offset indicates how far from the start
of the string table to find the require name.
</p>
<ul class="org-ul">
<li>The <code>.shstrtab</code> section begins at byte 1000 so all name positions
are <code>1000 + sh_name</code></li>
<li>The 0th <code>.text</code> section has <code>sh_name = 0</code>; the string <code>.text\0</code>
appears at position 1000.</li>
<li>The 1th <code>.symtab</code> section has <code>sh_name = 6</code>; the string <code>.symtab\0</code>
appears at byte position 1006.</li>
<li>The 4th <code>.data</code> section has <code>sh_name = 32</code>; the string <code>.bss\0</code>
appears at byte position 1032.</li>
</ul>

<p>
The Section Header Array is an array of <code>Elf64_Shdr</code> structs.  By
iterating over this array, fishing out the names from <code>.shstrtab</code>, and
examining names using <code>strcmp()</code>, the positions for the two desired
sections, <code>.symtab</code> and <code>.strtab</code> can be obtained via the associated
<code>sh_offset</code> field.
</p>

<p>
Note that one will need to also determine length of the Section Header
Array from the ELF File Header field <code>e_shnum</code>. 
</p>

<p>
Also, on finding the Symbol Table section, <b>note its size in bytes</b>
from the <code>sh_size</code> field. This will allow you to determine the number
of symbol table entries.
</p>
</div>
</div>

<div id="outline-container-orgb28c2e5" class="outline-3">
<h3 id="orgb28c2e5"><span class="section-number-3">3.6</span> <a id="orgcd1190a"></a> The <code>.text</code> Section and its Address</h3>
<div class="outline-text-3" id="text-3-6">
<p>
In addition to identifying the <code>.symtab</code> and <code>.strtab</code> sections in the
section header, identify and track the location of the <code>.text</code> section
as this is where the opcodes for a function are stored.  The <code>.text</code>
section is copied directly into memory when a program is loaded. The
section header struct field <code>sh_addr</code> is the requested location for
some sections to be loaded.  Often it is <code>0x0</code> for the <code>.text</code> section
but not always.  Record the value for <code>sh_addr</code> in your program as it
is used to calculate the location of variable values from the symbol
table.
</p>

<p>
Once the location of the <code>.text</code> section is located, print out some
data about it in the following format.
</p>
<div class="org-src-container">
<pre class="src src-text">.text section
- 1 section index
- 64 bytes offset from start of file
- 0x2000 preferred virtual address for .text
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd3273ad" class="outline-3">
<h3 id="orgd3273ad"><span class="section-number-3">3.7</span> Symbol Table and <code>.strtab</code></h3>
<div class="outline-text-3" id="text-3-7">
<p>
Similar to the Section Header Array, the Symbol Table is comprised of
an array of <code>Elf64_Sym</code> structs.  Each of these structs has a
<code>st_name</code> field giving an offset into the <code>.symtab</code> section where a
symbol's name resides. The following diagram shows this relationship.
</p>

<div class="org-center">

<div id="orgf42c5f0" class="figure">
<p><img src="elf-format-text2.png" alt="elf-format-text2.png" style="max-width:100%;" />
</p>
<p><span class="figure-number">Figure 2: </span>ELF Symbol Table, associated String Table, and locations of function symbols in <code>.text</code> section. The entry location of symbol <code>my_pow</code> is bolded along with the location of its name "my<sub>pow</sub>" and location of its opcodes in the <code>.text</code> section.</p>
</div>
</div>

<p>
Data on the symbol table is printed out in a format given in the
template.
</p>

<p>
<code>findfunc</code> will work with the opcodes of a function described in the
symbol table. To that end, one must iterate through the array of
Symbol Table <code>Elf64_Sym</code> structs searching desired symbol. In the
above diagram, <code>my_pow</code> is of interest and is found midway through the
table at index 15.  On finding the requested symbol, print out data
about it in the format shown in the template which roughly corresponds
to fields of the <code>Elf64_Sym</code> struct.
</p>

<ul class="org-ul">
<li>The <code>st_size</code> in this case corresponds to the number of bytes of
opcodes associated with the function in the <code>.text</code> section.</li>
<li>The "value" in the <code>st_value</code> field is the preferred load
address for the function though loaders/operating systems often
select other addresses for everything in the <code>.text</code> section.</li>
<li>The section index <code>st_shndx</code> field gives the ELF section in which this
symbol is stored. In this case, it is section 1 which is the index
of the <code>.text</code> section where opcodes are stored.</li>
<li>The location of <code>my_pow</code>'s opcodes in the <code>.text</code> section is computed
by calculating its address as an offset from the address of the
<code>.text</code> section:
<ul class="org-ul">
<li><code>.text</code> will load at <code>0x2000</code> in the output above</li>
<li><code>my_pow</code> is at address <code>0x200b</code></li>
<li>The opcodes of <code>my_pow</code> is therefore offset <code>0x200b - 0x2000 = 0xb =
    11</code> from the start of the <code>.data</code> section</li>
</ul></li>
<li>Add 11 to the offset of <code>.text</code> from the beginning of the file
(found in earlier when <a href="#orgcd1190a">locating the <code>.text</code> section</a>) to get the
address of opcodes for <code>my_pow</code></li>
</ul>

<p>
If the function symbol that is requested is not found in the symbol
table, refer to the <a href="#orge2a47cb">Error Conditions</a> section for the appropriate error
message to print.
</p>
</div>
</div>

<div id="outline-container-org25dc651" class="outline-3">
<h3 id="org25dc651"><span class="section-number-3">3.8</span> Checking that a Symbol is a Function</h3>
<div class="outline-text-3" id="text-3-8">
<p>
Symbol table entries have a field called <code>st_info</code> which indicates
some properties of the associated symbol such as whether it is an
<code>OBJECT</code> (global variable) or a <code>FUNC</code> function.  The field is binary
data and such info must be extracted. A macro is provided to extract
the type.
</p>
<pre class="example">
ELF64_ST_TYPE(somesym-&gt;st_info)
</pre>

<p>
will extract type information. If this is equal to <code>STT_FUNC</code> symbol
is a function. If not, then <code>loadfunc</code> should report an error as
indicated in the template.
</p>
</div>
</div>

<div id="outline-container-orga46e2aa" class="outline-3">
<h3 id="orga46e2aa"><span class="section-number-3">3.9</span> <a id="orgbcef039"></a> Printing the Opcodes of the Function</h3>
<div class="outline-text-3" id="text-3-9">
<p>
Treat the address for the function opcodes above as though it were a
<code>char *</code> array though many values will not be in the ASCII
range. These are arbitrary bytes that are best printed in hexadecimal
and we will favor printing them in columns of 8. The final required
output of <code>findfunc</code> looks like the following.
</p>
<div class="org-src-container">
<pre class="src src-text">Bytes of function 'my_pow'
   0: 55 48 89 e5 89 7d ec 89 
   8: 75 e8 c7 45 f8 01 00 00 
  10: 00 c7 45 fc 00 00 00 00 
  18: eb 0e 8b 45 f8 0f af 45 
  20: ec 89 45 f8 83 45 fc 01 
  28: 8b 45 fc 3b 45 e8 7c ea 
  30: 8b 45 f8 5d c3 
</pre>
</div>
<ul class="org-ul">
<li>The left column is printed in hexadecimal, 4 characters wide, right
adjusted. Use a format specifier of <code>%4x</code> for this. <i>Note: an early
version of the spec incorrectly</i> <i>stated to use decimal %d printing;
this has been fixed to match the example provided.</i></li>
<li>Each byte of the opcodes is printed in hexadecimal format with
leading 0s in a space of 2 characters. Use a format specifier of
<code>%02hhx</code> for this.</li>
</ul>
</div>
</div>

<div id="outline-container-orgd06f3a3" class="outline-3">
<h3 id="orgd06f3a3"><span class="section-number-3">3.10</span> <a id="orge2a47cb"></a> Behavior in Error Cases</h3>
<div class="outline-text-3" id="text-3-10">
<p>
The template provides a number situations in which errors should be
reported along with associated error messages. These are roughly:
</p>
<ul class="org-ul">
<li>The file is not an ELF file as it has the wrong "magic bytes" at the
beginning.</li>
<li>There is no Symbol Table present in the file, associated with a
"stripped" binary file. It may also be that there is no text or
string table section either also leading to an error.</li>
<li>The function symbol indicated on the command line is not found</li>
<li>The function symbol is not actually a symbol, it is something else.</li>
</ul>

<p>
Error messages associated with each of these are provided in the
template and when they should be printed in terms of program control
flow.
</p>
</div>
</div>

<div id="outline-container-org7a24087" class="outline-3">
<h3 id="org7a24087"><span class="section-number-3">3.11</span> <code>findfunc</code> Template</h3>
<div class="outline-text-3" id="text-3-11">
<p>
A basic template for <code>findfunc.c</code> is provided in the code pack which
outlines the structure of the code along with some printing formats to
make the output match examples. Follow this outline closely to make
sure that your code complies with tests when the become available.
</p>
</div>
</div>

<div id="outline-container-orgfcce057" class="outline-3">
<h3 id="orgfcce057"><span class="section-number-3">3.12</span> Calling Functions</h3>
<div class="outline-text-3" id="text-3-12">
<p>
One interesting aspect of dealing with functions in Binaries is that
in some cases they can be run after being located.  To arrange for
this, several things need to be true.
</p>
<ol class="org-ol">
<li>The memory into which the function is loaded must be marked with
Executable permission.</li>
<li>The types of the functions must be known (e.g. takes no arguments,
returns an integer).</li>
<li>The functions must either use no global variables/other functions
or be patched with addresses for these things.</li>
</ol>

<p>
It is not hard to arrange for the (1) and (2) above while (3) is much
trickier.  
</p>

<p>
By passing <code>call</code> on the command line, <code>findfunc</code> <b>executes the
function</b> that is identified. Three examples from the <code>somfuncs.o</code>
sample file are given here.
</p>

<div class="org-src-container">
<pre class="src src-sh"># runs return_five: takes no arguments and returns an int
&gt;&gt;  ./findfunc test-input/somefuncs.o return_five call 'int (*)(void)'
file_bytes at: 0x600000000000
Section Headers Found:
- 904 bytes from start of file
- 12 sections total
- 0x600000000388 section header virtual address
Section Header Names in Section 11
- 800 bytes from start of file
- 103 total bytes
- 0x600000000320 .shstrtab virtual address

Scanning Section Headers for Relevant Sections
[ 0]: 
[ 1]: .text
[ 2]: .data
[ 3]: .bss
[ 4]: .comment
[ 5]: .note.GNU-stack
[ 6]: .note.gnu.property
[ 7]: .eh_frame
[ 8]: .rela.eh_frame
[ 9]: .symtab
[10]: .strtab
[11]: .shstrtab

.symtab located
- 408 bytes from start of file
- 216 bytes total size
- 24 bytes per entry
- 9 number of entries
- 0x600000000198 .symtab virtual addres
.strtab located
- 624 bytes from start of file
- 75 total bytes in section
- 0x600000000270 .strtab virtual addres
.text located
- 64 bytes offset from start of file
- 0x0 preferred address for .text
- 0x600000000040 .text virtual addres

Scanning Symbol Table for symbol 'return_five'
[ 0]: 
[ 1]: somefuncs.c
[ 2]: 
[ 3]: return_five
[ 4]: global_int
[ 5]: my_pow
[ 6]: an_array
[ 7]: triple
[ 8]: meaning_of_life

Found 'return_five' in symbol table
- 11 size
- 1 section index
- 18 info
Calculating location of 'return_five' in .text section
- 0x0 preferred address of function (st_value)
- 0x0 preferred address of .text section
- 0 offset in .text of start of function
- 0x600000000040 virtual address of .text section
- 0x600000000040 virtual address of function

MODE: call
func_type: int (*)(void)
running function (no arguments)
returned: 5

# run my_pow: takes 2 integers, returns an integer
&gt;&gt; ./findfunc test-input/somefuncs.o my_pow call 'int (*)(int,int)' 3 5
file_bytes at: 0x600000000000
Section Headers Found:
- 904 bytes from start of file
...
Found 'my_pow' in symbol table
- 53 size
- 1 section index
- 18 info
Calculating location of 'my_pow' in .text section
- 0xb preferred address of function (st_value)
- 0x0 preferred address of .text section
- 11 offset in .text of start of function
- 0x600000000040 virtual address of .text section
- 0x60000000004b virtual address of function

MODE: call
func_type: int (*)(int,int)
running function with arguments (3,5)
returned: 243

# run triple: takes an integer pointer and returns nothing
&gt;&gt; ./findfunc test-input/somefuncs.o triple call 'void (*)(int*)' 6
file_bytes at: 0x600000000000
Section Headers Found:
- 904 bytes from start of file
...
Found 'triple' in symbol table
- 29 size
- 1 section index
- 18 info
Calculating location of 'triple' in .text section
- 0x40 preferred address of function (st_value)
- 0x0 preferred address of .text section
- 64 offset in .text of start of function
- 0x600000000040 virtual address of .text section
- 0x600000000080 virtual address of function

MODE: call
func_type: void (*)(int*)
running function, arg points to 6
arg is now: 18
</pre>
</div>

<p>
Below are some notes on how to complete this portion of the project.
</p>
</div>

<div id="outline-container-orgf1b4c90" class="outline-4">
<h4 id="orgf1b4c90">Functions Must Be Executable</h4>
<div class="outline-text-4" id="text-orgf1b4c90">
<p>
In order to execute instructions, they must have the "execute" (<code>x</code>)
permission associated with the memory page on which they are loaded.
This means requires that when you <code>mmap()</code> the file with the function
opcodes in them, you must pass an option to make the mapped memory
executable. Do some research such as through the manual page (<code>man
mmap</code>) or on the internet to find such an option to pass to <code>mmap()</code>.
</p>
</div>
</div>

<div id="outline-container-org99d5572" class="outline-4">
<h4 id="org99d5572">Types of functions Supported</h4>
<div class="outline-text-4" id="text-org99d5572">
<p>
There are 3 types of functions that are supported. These are indicated
on the command line via an option along some additional arguments to
the <code>findfunc</code>.
</p>
<ol class="org-ol">
<li><code>int (*)(void)</code>: the funciton found takes no arguments and returns an
integer. Call the function and print out its return value produce
following output with X substituted for the return value.</li>

<li><code>int (*)(int,int)</code>: the function found takes two integers
and returns an integer. In this case 2 additional integer
arguments are provided on the command line. Call the function
with the 2 arguments and print its return value. Produce the
following output with X,Y as the arguments provided on the
command line and Z the return value of the function.</li>

<li><code>void (*)(int*)</code>: the function takes a pointer to an integer and
returns nothing but changes the integer pointed to. In this case 1
additional integer argument is provided on the command line. An
integer is set to this argument and its address is passed to the
function. Print the following outpu with X substituted for the
initial value for the argument and Y its value after calling the
function.</li>
</ol>
</div>
</div>


<div id="outline-container-orge0cb97b" class="outline-4">
<h4 id="orge0cb97b">Casting to Functions</h4>
<div class="outline-text-4" id="text-orge0cb97b">
<p>
Printing out the opcodes as bytes is relatively easy: one calculates a
pointer to its location and iterates over the bytes as an array.  In
contrast, if that location is to treated as a Function instead, then
some tricky casting is required.  
</p>

<p>
The command line parameters that indicate the types supported
correspond to the casting that is required to make this work. In the
template, the first case is provided and can serve as a reference for
the other types.
</p>
</div>
</div>
</div>

<div id="outline-container-orgcc8ea29" class="outline-3 grading">
<h3 id="orgcc8ea29"><span class="section-number-3">3.13</span> Grading Criteria for <code>findfunc</code>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="grading">grading</span></span></h3>
<div class="outline-text-3" id="text-3-13">
<p>
Both binary and shell tests can be run with <code>make test</code>
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Weight</th>
<th scope="col" class="org-left">Criteria</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left"><b>Automated Tests</b></td>
</tr>

<tr>
<td class="org-right">20</td>
<td class="org-left">Passing automated tests run via <code>make test</code>, tests in <code>test_findfunc.org</code></td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left"><b>Manual Inspection</b></td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left">Sets a pointer to the ELF File Header properly</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Checks identifying bytes for sequence <code>{0x7f,'E','L','F'}</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Properly extracts the Section Header Array offset, length, string table index</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">5</td>
<td class="org-left">Sets up pointers to Section Header Array and associate Section Header String Table</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Loops over Section Header Array for sections named <code>.symtab / .strtab / .text</code></td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Properly uses SH String Table to look at names of each section while searching</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Extracts offsets and sizes of <code>.symtab / .strtab / .text</code> sections, location of the address for <code>.text</code></td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">5</td>
<td class="org-left">Iterates over the symbol table to locate the named function symbol</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Clear cases for finding the requested symbol or failure to find symbol in the table</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Calculation done to find the position of a symbol value in the <code>.text</code> section</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">5</td>
<td class="org-left">Completes the PRINT mode</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Properly iterates over opcodes associated with a function</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Printing done using specified formats</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">5</td>
<td class="org-left">Completes the function the CALL mode</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Castes each type o functions properly</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Processes command line arguments and passes them correctly to function calls</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">5</td>
<td class="org-left">Clean, readable code</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Good indentation</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-left">Good selection of variable names</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">50</td>
<td class="org-left">Problem Total</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org2b1ba44" class="outline-2">
<h2 id="org2b1ba44"><span class="section-number-2">4</span> Project Submission</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-orgb7f4930" class="outline-3">
<h3 id="orgb7f4930"><span class="section-number-3">4.1</span> <a id="org076d2a7"></a> Submit to Gradescope</h3>
<div class="outline-text-3" id="text-4-1">
<ol class="org-ol">
<li><p>
In a terminal, change to your project code directory and type
<b>make zip</b> which will create a zip file of your code. A session
should look like this:
</p>
<div class="org-src-container">
<pre class="src src-sh">   &gt; cd Desktop/2021/p5-code      # location of project code

   &gt; ls 
   Makefile    findfunc.c    test-input/
   ...

   &gt; make zip                     # create a zip file using Makefile target
   rm -f p5-code.zip
   cd .. &amp;&amp; zip "p5-code/p5-code.zip" -r "p5-code"
     adding: p5-code/ (stored 0%)
     adding: p5-code/findfunc.c (deflated 72%)
     adding: p5-code/Makefile (deflated 59%)
     ...
   Zip created in p5-code.zip

   &gt; ls p5-code.zip
   p5-code.zip
</pre>
</div></li>
<li>Log into <a href="https://www.gradescope.com/">Gradescope</a> and locate and click Project 5' which will
open up submission</li>
<li>Click on the 'Drag and Drop' text which will open a file selection
dialog; locate and choose your <code>p5-code.zip</code> file</li>
<li>This will show the contents of the Zip file and should include your
C source files along with testing files and directories.</li>
<li>Click 'Upload' which will show progress uploading files.  It may
take a few seconds before this dialog closes to indicate that the
upload is successful. Note: there is a limit of 256 files per
upload; normal submissions are not likely to have problems with
this but you may want to make sure that nothing has gone wrong such
as infinite loops creating many files or incredibly large files.</li>
<li>Once files have successfully uploaded, the Autograder will begin
running the command line tests and recording results.  These are
the same tests that are run via <code>make test</code>.</li>
<li>When the tests have completed, results will be displayed
summarizing scores along with output for each batch of tests.</li>
<li>Refer to the <a href="https://www-users.cs.umn.edu/~kauffman/2021/p1.html">Submission instructions for P1</a> for details and
pictures.</li>
</ol>
</div>
</div>

<div id="outline-container-org85e3437" class="outline-3">
<h3 id="org85e3437"><span class="section-number-3">4.2</span> Late Policies</h3>
<div class="outline-text-3" id="text-4-2">
<p>
You may wish to review the policy on late project submission which
will cost you late tokens to submit late or credit if you run out of
tokens. <b>No projects will be accepted more than 48 hours after the
deadline.</b>
</p>

<p>
<a href="https://www-users.cs.umn.edu/~kauffman/2021/syllabus.html">https://www-users.cs.umn.edu/~kauffman/2021/syllabus.html</a>
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr/> <i> Author: Chris Kauffman (<a href="mailto:kauffman@umn.edu">kauffman@umn.edu</a>) <br/> Date: 2022-12-11 Sun 17:15 <br/> </i>
</div>
</body>
</html>
